import{_ as Se,y as ke,k as Ye,d as Ze,z as Ge,E as g,A as We,a as Xe,B as Ke,b as Qe,e as et,C as tt,D as at,F as st,i as lt,j as ot,G as Ce,H as Ee,I as De,J as ne,K as nt,L as it,M as rt,N as Me}from"./index-Bir-YaCC.js";import{L as ie,v as X}from"./el-loading-Ejxd-_8H.js";import{E as ut,a as dt}from"./el-tab-pane-BNmlJghT.js";import{E as ct}from"./el-progress-C1cQjd7U.js";import{q as Ue,s as q,N as u,r as z,z as mt,C as _t,A as pt,a1 as N,S as n,ah as v,Q as r,X as S,u as x,ba as ft,bp as gt,bq as re,br as B,P as ue,U as de,bs as ce,aH as me,a2 as _e,bt as vt,b7 as ht}from"./vue-vendor-BgjGt3mC.js";import wt from"./Edit-IMalSOLN.js";import{J as $e}from"./jszip-C7-yN4-L.js";import{E as yt}from"./index-DoDbvCKE.js";import"./axios-xsH4HHeE.js";import"./lodash-BmZg10rb.js";import"./remark-CBsncvHK.js";import"./quill-BeGMbSWh.js";const xt={install(V){ie._context=V._context,X._context=V._context,V.directive("loading",X),V.config.globalProperties.$loading=ie},directive:X,service:ie},bt={class:"detail-wrapper"},It=["src"],zt={__name:"Detail",props:{imageUrl:{type:String,required:!0},imageId:{type:[String,Number],required:!0}},setup(V){return(F,O)=>(q(),Ue("div",bt,[u("img",{src:V.imageUrl,alt:"Image Detail",class:"image-detail"},null,8,It)]))}},kt=Se(zt,[["__scopeId","data-v-2e2bcbb2"]]),Ct={"element-loading-text":"处理中...",class:"upload-container pt-[20px] h-full w-full items-start flex-1 display-flex flex-col"},Et={class:"flex justify-between items-center w-full mb-5 px-[20px]"},Dt={class:"text-[20px] font-medium text-[#333] flex items-center"},Mt={class:"mr-3 flex items-center justify-center w-[36px] h-[36px] rounded-[10px] bg-gradient-to-r from-[#9096FF] to-[#85C8FF] text-white"},$t={class:"statistics"},St={class:"mr-5 text-[14px] text-[#666]"},Ut={class:"text-[#4080ff]"},Vt={class:"mr-5 text-[14px] text-[#666]"},Rt={class:"text-[#4080ff]"},Lt={class:"mr-5 text-[14px] text-[#666]"},Nt={class:"text-[#4080ff]"},Ot={class:"mr-5 text-[14px] text-[#666]"},At={class:"text-[#4080ff]"},Bt={class:"text-[14px] text-[#666]"},Ft={class:"text-[#4080ff]"},Pt={class:"controls w-full flex-row flex-1 gap-[10px]"},Tt={class:"action-buttons px-[15px] py-[10px]"},jt={class:"upload-wall-container"},qt={class:"upload-wall"},Ht={class:"upload-list-item"},Jt={class:"image-stack"},Yt=["src","alt"],Zt=["onClick"],Gt=["onClick"],Wt={class:"upload-list-item-name"},Xt={class:"controls w-full flex-row flex-1 gap-[10px]"},Kt={class:"action-buttons px-[15px] py-[10px]"},Qt={class:"upload-wall-container"},ea={class:"upload-wall"},ta={class:"upload-list-item"},aa={class:"image-stack"},sa=["src","alt"],la=["onClick"],oa=["onClick"],na={class:"upload-list-item-name"},ia={class:"controls w-full flex-row flex-1 gap-[10px]"},ra={class:"action-buttons px-[15px] py-[10px]"},ua={class:"upload-wall-container"},da={class:"upload-wall"},ca={class:"upload-list-item"},ma={class:"image-stack"},_a=["src","alt"],pa=["onClick"],fa=["onClick"],ga={class:"upload-list-item-name"},va=Object.assign({name:"BatchCutoutIndex"},{__name:"index",setup(V){const F="/api/",O=z({position:"original"}),pe=t=>new Promise((e,a)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>e(s),s.onerror=a,s.src=t}),fe=(t,{padding:e=0}={})=>{if(!t)throw new Error("maskImage 参数是必需的");e=Math.max(0,Number(e)||0);const a=document.createElement("canvas"),s=a.getContext("2d");a.width=t.width,a.height=t.height,s.drawImage(t,0,0);const o=s.getImageData(0,0,a.width,a.height).data,d={bottom:()=>{for(let m=a.height-1;m>=0;m--)for(let w=0;w<a.width;w++){const M=(m*a.width+w)*4;if(o[M+3]<240)return m}return 0},top:()=>{for(let m=0;m<a.height;m++)for(let w=0;w<a.width;w++){const M=(m*a.width+w)*4;if(o[M+3]<240)return m}return a.height-1},left:()=>{for(let m=0;m<a.width;m++)for(let w=0;w<a.height;w++){const M=(w*a.width+m)*4;if(o[M+3]<240)return m}return 0},right:()=>{for(let m=a.width-1;m>=0;m--)for(let w=0;w<a.height;w++){const M=(w*a.width+m)*4;if(o[M+3]<240)return m}return a.width-1}},i={top:d.top(),bottom:d.bottom(),left:d.left(),right:d.right()};if(!(i.top<=i.bottom&&i.left<=i.right&&i.top>=0&&i.bottom<a.height&&i.left>=0&&i.right<a.width))return console.warn("未找到有效的主体区域，返回完整图片尺寸"),{x:0,y:0,width:a.width,height:a.height};const h=Math.max(0,i.left-e),b=Math.max(0,i.top-e),D=Math.min(a.width-h,i.right-i.left+1+e*2),k=Math.min(a.height-b,i.bottom-i.top+1+e*2);return{x:h,y:b,width:D,height:k}},H=z(!1),J=z(!1),ge=z(""),Y=z(""),I=z(!1),_=z([]),f=z([]),P=z(null),ve=z(null),A=t=>{ge.value=t.url,Y.value=t.id||"",t.id?t.status==="success"&&(J.value=!0):H.value=!0},he=()=>{var t;H.value=!1,J.value=!1,(t=ve.value)==null||t.closeEditor()},K=async(t,e)=>{if(t.size>10*1024*1024){g.error("文件大小不能超过10M");const s=e.findIndex(l=>l.uid===t.uid);s!==-1&&e.splice(s,1);return}const a=t.name.length>20?t.name.slice(0,20)+"...":t.name;if(t.original_name=t.name,t.name=a,t.truncated_name=a,f.value=e,t)try{if(t.id){const s=f.value.find(l=>l.id===t.id);s&&(_.value=_.value.filter(l=>l.uid!==t.uid),_.value.push({...s,uid:t.uid}))}else{const l={url:await rt(t),selectedImageId:"",name:a,original_name:t.original_name,truncated_name:a,uid:t.uid,status:"ready"};_.value.some(o=>o.uid===t.uid)||(_.value=[..._.value,l])}}catch(s){console.error("文件处理失败:",s),g.error("文件处理失败，请重试")}},Ve=t=>{Y.value=t},Q=(t,e)=>{},ee=async()=>{try{if(f.value.length===0){g.warning("没有可下载的图片");return}const t=new $e,e=f.value.filter(l=>l.id),a=f.value.filter(l=>!l.id),s=xt.service({lock:!0,text:"正在准备下载...",background:"rgba(0, 0, 0, 0.7)"});try{if(e.length>0){const i=e.map(m=>m.id),p={};e.forEach(m=>{p[m.id]=m.name.includes(".")?m.name.substring(0,m.name.lastIndexOf(".")):m.name});const h=encodeURIComponent(JSON.stringify(p)),b=Je(O.value.position),D=await fetch(`${F}/api/image/batch/download?${i.map(m=>`ids=${m}`).join("&")}&padding=${b}&namesMap=${h}`);if(!D.ok)throw new Error("下载处理后的图片失败");const k=await D.blob(),R=await $e.loadAsync(k);for(const[m,w]of Object.entries(R.files))if(!w.dir){const M=await w.async("blob"),c=e.find(ze=>(ze.original_name||ze.name).toLowerCase()===m.toLowerCase()),L=c?c.original_name||c.name:m;t.file(L,M)}}for(const i of a){const p=i.url,h=i.original_name||i.name;let b;if(p.startsWith("data:")){const D=p.split(",")[1];b=await fetch(`data:image/png;base64,${D}`).then(k=>k.blob())}else b=await fetch(p).then(D=>D.blob());t.file(h,b)}const l=await t.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),o=URL.createObjectURL(l),d=document.createElement("a");d.href=o,d.download=`images_${ne(new Date)}.zip`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(o),g.success("文件打包下载成功")}finally{s.close()}}catch(t){console.error("下载失败:",t),g.error("下载失败，请重试")}},te=async()=>{try{await nt(),_.value=[],f.value=[],y.value.clear(),localStorage.removeItem("uploadIdMap"),P.value&&P.value.clearFiles(),g.success("清空成功"),xe()}catch(t){console.error("清空失败:",t),g.error("清空失败，请重试")}},T=z(null),y=z(new Map),C=z(new Map),j=()=>{localStorage.setItem("uploadIdMap",JSON.stringify(Array.from(y.value.entries())))},we=()=>{const t=localStorage.getItem("uploadIdMap");t&&(y.value=new Map(JSON.parse(t)))},ye=t=>{if(!t||t.length===0){y.value.clear(),j();return}const e=new Set(t.map(s=>s.id)),a=[];for(const[s,l]of y.value.entries())e.has(l)||a.push(s);a.length>0&&(a.forEach(s=>{y.value.delete(s)}),j())},xe=async()=>{try{const{code:t,data:{list:e}}=await ke();if(t===0){if(we(),ye(e),y.value.size===0){Z(),I.value=!1;return}e.forEach(s=>{s.id&&C.value.set(s.id,{id:s.id,origin_url:`${F}${s.file_url}`,name:s.file_name||"未命名",status:s.status,update_time:s.update_time,create_time:s.create_time,size_x:s.size_x,size_y:s.size_y,original_name:s.file_name,truncated_name:s.file_name.length>20?s.file_name.slice(0,20)+"...":s.file_name})});const a=Array.from(y.value.values()).every(s=>C.value.has(s)&&C.value.get(s).status==="success");a&&(be(),se(),Z(),I.value=!1)}}catch(t){console.error("获取图片列表失败:",t),g.error(t.message||"获取图片列表失败，请重试")}},Re=()=>{const t=Array.from(C.value.values());_.value=t.map(e=>({id:e.id,origin_url:e.origin_url,name:e.name,status:e.status,update_time:e.update_time,create_time:e.create_time,original_name:e.original_name,size_x:e.size_x,size_y:e.size_y,truncated_name:e.truncated_name})),f.value=_.value.map(e=>{let a=null;const s=Array.from(y.value.entries()).filter(([,o])=>o===e.id).map(([o])=>o);for(const o of s)if(!f.value.some(d=>d.uid===o)){a=o;break}const l=a||null;return{name:e.name,origin_url:e.origin_url,status:e.status,id:e.id,uid:l,original_name:e.original_name,truncated_name:e.truncated_name,update_time:e.update_time,create_time:e.create_time,size_x:e.size_x,size_y:e.size_y}})},Le=()=>{_.value=_.value.map(t=>{const e=y.value.get(t.uid),a=e?C.value.get(e):null;return a?{...t,id:e,uid:t.uid,origin_url:a.origin_url,name:a.name,status:a.status,update_time:a.update_time,create_time:a.create_time,original_name:a.original_name,size_x:a.size_x,size_y:a.size_y,truncated_name:a.truncated_name}:t}),f.value=f.value.map(t=>{const e=y.value.get(t.uid),a=e?C.value.get(e):null;return a?{...t,id:a.id,uid:t.uid,origin_url:a.origin_url,name:a.name,status:a.status,update_time:a.update_time,create_time:a.create_time,original_name:a.original_name,size_x:a.size_x,size_y:a.size_y,truncated_name:a.truncated_name}:{...t,status:"error"}})},be=()=>{_.value.length===0&&C.value.size>0?Re():Le(),$.value.current=_.value.length},ae=()=>{T.value||(T.value=setInterval(async()=>{await xe()},2e3),I.value=!0)},Z=()=>{T.value&&(clearInterval(T.value),T.value=null)},E=z({sizeOption:"original",width:100,height:100,position:"original"}),$=z({current:0,daily:0,weekly:0,monthly:0,total:0}),Ne=async()=>{try{const t=await We();if(t.code===0)$.value=t.data;else throw new Error(t.message||"获取统计数据失败")}catch(t){console.error("获取统计数失败:",t),g.error(t.message||"获取统计数据失败，请重试")}},Oe=async()=>{I.value=!0;try{const t=_.value;if(t.length===0){g.warning("没有图片需要处理"),I.value=!1;return}if(t.length>=100){g.error("一次最多只能处理100张图片"),I.value=!1;return}const e=t.map(async l=>{try{if(l.id){const{width:o,height:d}=E.value;return await Me({image_ids:[l.id],width:o,height:d}),l.id}else{const o=new FormData,d=Ce(l.url,l.original_name||l.name);if(!d)return console.error(`文件 ${l.original_name||l.name} 格式错误，跳过处理`),null;o.append("files",d);const i=await Ee(o);if(i.code!==0)return console.error(`图片 ${l.original_name||l.name} 上传失败:`,i),g.error(i.message||"上传失败，请重试"),null;if(!i.data||!Array.isArray(i.data.list)||i.data.list.length===0)return console.error(`图片 ${l.original_name||l.name} 上传返回数据异常:`,i),g.error("上传返回数据异常，请重试"),null;const p=i.data.list[0];if(y.value.set(l.uid,p.id),j(),E.value.sizeOption!=="original"){const{width:h,height:b}=E.value;await Me({image_ids:[p.id],width:h,height:b})}return await De({image_ids:[p.id]}),p.id}}catch(o){return console.error(`图片 ${l.original_name||l.name} 处理失败:`,o),null}});(await Promise.all(e)).filter(l=>l!==null).length>0?ae():(g.error("所有图片处理失败"),I.value=!1)}catch(t){console.error("批量处理失败:",t),g.error(t.message||"批量处理失败，请重试"),I.value=!1}},Ae=async()=>{I.value=!0;try{const t=_.value;if(t.length===0){g.warning("没有图片需要处理"),I.value=!1;return}if(t.length>=100){g.error("一次最多只能处理100张图片"),I.value=!1;return}const e=t.map(async l=>{try{if(!l.id){const o=new FormData,d=Ce(l.url,l.original_name||l.name);if(!d)return console.error(`文件 ${l.original_name||l.name} 格式错误，跳过处理`),null;o.append("files",d);const i=await Ee(o);if(i.code===0&&i.data.list[0]){const p=i.data.list[0];return y.value.set(l.uid,p.id),j(),await De({image_ids:[p.id]}),p.id}}}catch(o){return console.error(`图片 ${l.original_name||l.name} 处理失败:`,o),null}});(await Promise.all(e)).filter(l=>l!==null).length>0?ae():(g.error("所有图片处理失败"),I.value=!1)}catch(t){console.error("批量处理失败:",t),g.error(t.message||"批量处理失败，请重试"),I.value=!1}},se=async()=>{try{const t=_.value.filter(o=>o.id&&o.status==="success"),e=_.value.filter(o=>o.id&&o.status!=="success"),a=await Promise.all(t.map(async o=>{try{const{data:d}=await Ge(o.id);return{...o,mask_url:`${F}${d.mask.file_url}`,origin_url:`${F}${d.origin.file_url}`,size_x:d.origin.size_x,size_y:d.origin.size_y}}catch(d){return console.error(`获取图片 ${o.id} 的详情失败:`,d),o}})),s=e.map(o=>({...o,url:o.url,origin_url:o.origin_url})),l=[...a,...s];_.value=_.value.map(o=>l.find(i=>i.id===o.id)||o),f.value=f.value.map(o=>{const d=y.value.get(o.uid),i=_.value.find(p=>p.id===d);return{...o,mask_url:i?i.mask_url:null,origin_url:i?i.origin_url:o.origin_url}}),await je(f.value),_.value=_.value.map(o=>{const d=f.value.find(i=>y.value.get(i.uid)===o.id);return{...o,processed_url:(d==null?void 0:d.processed_url)||null}})}catch(t){console.error("加载蒙版图片失败:",t),g.error("加载蒙版图片失败，请重试")}},Be=(t,e)=>{const{canvas:a,ctx:s}=Ie(t.width,t.height);return s.drawImage(t,0,0),s.globalCompositeOperation="normal",s.drawImage(e,0,0),a},Fe=(t,e)=>{t.drawImage(e,0,0,148,148)},Pe=(t,e,a,s)=>{let l,o,d,i;switch(s){case"center":{l=fe(a,{padding:0}),o=Math.min(148/l.width,148/l.height),d=(148-l.width*o)/2,i=(148-l.height*o)/2;break}case"center-padding":{l=fe(a,{padding:25}),o=Math.min(148/l.width,148/l.height),d=(148-l.width*o)/2,i=(148-l.height*o)/2;break}}t.save(),t.translate(d,i),t.scale(o,o),t.drawImage(e,l.x,l.y,l.width,l.height,0,0,l.width,l.height),t.restore()},Te=async t=>{if(!(!t.mask_url||t.status!=="success"))try{const[e,a]=await Promise.all([pe(t.origin_url),pe(t.mask_url)]),{canvas:s,ctx:l}=Ie(148,148),o=Be(e,a);O.value.position==="original"?Fe(l,o):Pe(l,o,a,O.value.position),t.processed_url=s.toDataURL("image/png")}catch(e){console.error("处理图片失败:",e),g.error(`处理图片 ${t.name} 失败`)}};async function je(t){await Promise.all(t.map(Te)),f.value=[...f.value]}const Ie=(t,e)=>{const a=document.createElement("canvas"),s=a.getContext("2d");return a.width=t,a.height=e,{canvas:a,ctx:s}},G=async t=>{try{let e=t.id;if(e){const{code:a}=await it(e);if(a!==0)throw new Error("删除失败");C.value.delete(e);for(const[s,l]of y.value.entries())l===e&&y.value.delete(s);j()}_.value=_.value.filter(a=>a.uid!==t.uid),f.value=f.value.filter(a=>a.uid!==t.uid),$.value.current=_.value.length}catch(e){console.error("删除文件失败:",e),g.error("删除文件失败，请重试")}},W=t=>{const e=t.original_name||t.name;return yt.confirm(`确定移除 ${e}？`)},le={mounted(t,e){const{itemSize:a=190,buffer:s=5}=e.value||{},l=t.parentElement;let o=0,d=0,i=0;const p=()=>{const h=l.scrollTop,b=l.clientHeight;o=Math.floor(h/a),d=Math.ceil((h+b)/a),o=Math.max(0,o-s),d=d+s,t.querySelectorAll(".el-upload-list__item").forEach((k,R)=>{R>=o&&R<=d?k.style.display="":k.style.display="none"})};l.addEventListener("scroll",()=>{Math.abs(l.scrollTop-i)>a/2&&(requestAnimationFrame(p),i=l.scrollTop)}),p()}},oe=async t=>{try{await W(t),G(t)}catch{}},U=z({selectedRules:[]}),qe=()=>{if(U.value.selectedRules.length===0)return"";const t=[];return U.value.selectedRules.forEach(a=>{switch(a){case"original":t.push("example");break;case"sequence":t.push("001");break;case"timestamp":t.push(ne(new Date));break;case"size":t.push("800_800");break}}),t.join("_")+".png"},He=async()=>{if(U.value.selectedRules.length===0){g.warning("请至少选择一个命名规则");return}try{let t=1;const e=Date.now(),a=_.value.map((s,l)=>{const o=[];U.value.selectedRules.forEach(p=>{var h;switch(p){case"original":o.push(((h=s.original_name)==null?void 0:h.split(".")[0])||"untitled");break;case"sequence":o.push(String(t).padStart(3,"0"));break;case"timestamp":{const b=new Date(e+l*1e3);o.push(ne(b));break}case"size":o.push(`${s.size_x||0}_${s.size_y||0}`);break}}),t++;const d=o.join("_")+".png",i=d.length>20?d.slice(0,20)+"...":d;return{...s,name:i,truncated_name:i}});_.value=a,f.value=f.value.map(s=>{const l=a.find(o=>o.uid===s.uid);return l?{...s,name:l.name,truncated_name:l.truncated_name}:s}),g.success("批量重命名成功")}catch(t){console.error("批量重命名失败:",t),g.error("批量重命名失败，请重试")}},Je=t=>{switch(t){case"center":return 0;case"center-padding":return 25;default:return-1}};return mt(async()=>{const{code:t,data:{list:e}}=await ke();if(t===0){if(we(),ye(e),y.value.size===0){Z();return}if(I.value=!0,e.forEach(s=>{s.id&&C.value.set(s.id,{id:s.id,original_url:s.file_url,name:s.file_name||"未命名",original_name:s.file_name||"未命名",truncated_name:s.file_name.length>20?s.file_name.slice(0,20)+"...":s.file_name,status:s.status,file_url:s.file_url,update_time:s.update_time,create_time:s.create_time,size_x:s.size_x,size_y:s.size_y})}),Array.from(y.value.values()).every(s=>C.value.has(s)&&C.value.get(s).status==="success"))be(),se(),I.value=!1;else{const s=Array.from(C.value.values());f.value=s.map(l=>{let o=null;const d=Array.from(y.value.entries()).filter(([,i])=>i===l.id).map(([i])=>i);for(const i of d)if(!f.value.some(p=>p.uid===i)){o=i;break}return o?{name:l.name,url:l.url,status:l.status,id:l.id,uid:o,original_name:l.original_name,truncated_name:l.truncated_name,size_x:l.size_x,size_y:l.size_y,update_time:l.update_time,create_time:l.create_time}:null}),se(),ae()}await Ne()}}),_t(()=>{Z()}),pt(_,t=>{$.value.current=t.length}),(t,e)=>{const a=Ye,s=Xe,l=ct,o=Ke,d=dt,i=at,p=tt,h=et,b=st,D=Qe,k=ot,R=lt,m=ut,w=Ze,M=X;return N((q(),Ue("div",Ct,[u("div",Et,[u("h2",Dt,[u("span",Mt,[n(a,{class:"text-[18px]"},{default:r(()=>[n(x(ft))]),_:1})]),e[10]||(e[10]=v(" 图片处理 "))]),u("div",$t,[u("span",St,[e[11]||(e[11]=v("当前数量: ")),u("b",Ut,S($.value.current),1)]),u("span",Vt,[e[12]||(e[12]=v("今日数量: ")),u("b",Rt,S($.value.daily),1)]),u("span",Lt,[e[13]||(e[13]=v("本周数量: ")),u("b",Nt,S($.value.weekly),1)]),u("span",Ot,[e[14]||(e[14]=v("本月数量: ")),u("b",At,S($.value.monthly),1)]),u("span",Bt,[e[15]||(e[15]=v("总计: ")),u("b",Ft,S($.value.total),1)])])]),n(m,{class:"tabs-container"},{default:r(()=>[n(d,{label:"批量抠图"},{default:r(()=>[u("section",Pt,[u("div",Tt,[n(s,{onClick:Ae,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(gt))]),_:1}),e[16]||(e[16]=v(" 一键抠图 "))]),_:1,__:[16]}),n(s,{onClick:ee,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(re))]),_:1}),e[17]||(e[17]=v(" 打包下载 "))]),_:1,__:[17]}),n(s,{onClick:te,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(B))]),_:1}),e[18]||(e[18]=v(" 清空列表 "))]),_:1,__:[18]})]),u("div",jt,[n(o,null,{default:r(()=>[u("div",qt,[N((q(),ue(l,{ref_key:"uploadRef",ref:P,"auto-upload":!1,"list-type":"picture-card","on-change":K,"on-preview":A,"on-remove":G,"before-remove":W,"on-exceed":Q,"file-list":f.value,drag:"",multiple:""},{default:r(()=>[n(a,null,{default:r(()=>[n(x(me))]),_:1}),e[19]||(e[19]=u("div",{class:"el-upload__text"},[v("拖动文件或者"),u("em",null,"点击上传")],-1))]),file:r(({file:c})=>[u("div",Ht,[u("div",Jt,[u("img",{src:c.processed_url||c.origin_url||c.url,class:"upload-list-item-image original-image",loading:"lazy",alt:c.name},null,8,Yt)]),u("div",{class:"upload-list-item-actions",onClick:e[0]||(e[0]=de(()=>{},["stop"]))},[u("span",{class:"upload-list-item-preview",onClick:L=>A(c)},[n(a,null,{default:r(()=>[n(x(ce))]),_:1})],8,Zt),u("span",{class:"upload-list-item-delete",onClick:L=>oe(c)},[n(a,null,{default:r(()=>[n(x(B))]),_:1})],8,Gt)]),u("span",Wt,S(c.name),1)])]),_:1},8,["file-list"])),[[le,{itemSize:190,buffer:5}]])])]),_:1})])])]),_:1}),n(d,{label:"修改尺寸"},{default:r(()=>[n(D,{model:E.value,"label-width":"120px"},{default:r(()=>[n(h,{label:"主体位置"},{default:r(()=>[n(p,{modelValue:O.value.position,"onUpdate:modelValue":e[1]||(e[1]=c=>O.value.position=c)},{default:r(()=>[n(i,{value:"original"},{default:r(()=>e[20]||(e[20]=[v("原图位置")])),_:1,__:[20]}),n(i,{value:"center"},{default:r(()=>e[21]||(e[21]=[v("主体居中无边界")])),_:1,__:[21]}),n(i,{value:"center-padding"},{default:r(()=>e[22]||(e[22]=[v("主体居中距边界25px")])),_:1,__:[22]})]),_:1},8,["modelValue"])]),_:1}),n(h,{label:"尺寸选择"},{default:r(()=>[n(p,{modelValue:E.value.sizeOption,"onUpdate:modelValue":e[2]||(e[2]=c=>E.value.sizeOption=c)},{default:r(()=>[n(i,{value:"original"},{default:r(()=>e[23]||(e[23]=[v("原图尺寸")])),_:1,__:[23]}),n(i,{value:"custom"},{default:r(()=>e[24]||(e[24]=[v("自定义尺寸")])),_:1,__:[24]})]),_:1},8,["modelValue"])]),_:1}),N(n(h,{label:"宽度"},{default:r(()=>[n(b,{modelValue:E.value.width,"onUpdate:modelValue":e[3]||(e[3]=c=>E.value.width=c),min:1,max:1e4},null,8,["modelValue"])]),_:1},512),[[_e,E.value.sizeOption==="custom"]]),N(n(h,{label:"高度"},{default:r(()=>[n(b,{modelValue:E.value.height,"onUpdate:modelValue":e[4]||(e[4]=c=>E.value.height=c),min:1,max:1e4},null,8,["modelValue"])]),_:1},512),[[_e,E.value.sizeOption==="custom"]])]),_:1},8,["model"]),u("section",Xt,[u("div",Kt,[n(s,{onClick:Oe,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(vt))]),_:1}),e[25]||(e[25]=v(" 调整尺寸 "))]),_:1,__:[25]}),n(s,{onClick:ee,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(re))]),_:1}),e[26]||(e[26]=v(" 打包下载 "))]),_:1,__:[26]}),n(s,{onClick:te,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(B))]),_:1}),e[27]||(e[27]=v(" 清空列表 "))]),_:1,__:[27]})]),u("div",Qt,[n(o,null,{default:r(()=>[u("div",ea,[N((q(),ue(l,{ref_key:"uploadRef",ref:P,"auto-upload":!1,"list-type":"picture-card","on-change":K,"on-preview":A,"on-remove":G,"before-remove":W,"on-exceed":Q,"file-list":f.value,drag:"",multiple:""},{default:r(()=>[n(a,null,{default:r(()=>[n(x(me))]),_:1}),e[28]||(e[28]=u("div",{class:"el-upload__text"},[v("拖动文件或者"),u("em",null,"点击上传")],-1))]),file:r(({file:c})=>[u("div",ta,[u("div",aa,[u("img",{src:c.processed_url||c.origin_url||c.url,class:"upload-list-item-image original-image",loading:"lazy",alt:c.name},null,8,sa)]),u("div",{class:"upload-list-item-actions",onClick:e[5]||(e[5]=de(()=>{},["stop"]))},[u("span",{class:"upload-list-item-preview",onClick:L=>A(c)},[n(a,null,{default:r(()=>[n(x(ce))]),_:1})],8,la),u("span",{class:"upload-list-item-delete",onClick:L=>oe(c)},[n(a,null,{default:r(()=>[n(x(B))]),_:1})],8,oa)]),u("span",na,S(c.name),1)])]),_:1},8,["file-list"])),[[le,{itemSize:190,buffer:5}]])])]),_:1})])])]),_:1}),n(d,{label:"批量命名"},{default:r(()=>[n(D,{model:U.value,"label-width":"120px"},{default:r(()=>[n(h,{label:"命名规则"},{default:r(()=>[n(R,{modelValue:U.value.selectedRules,"onUpdate:modelValue":e[6]||(e[6]=c=>U.value.selectedRules=c),multiple:"","collapse-tags":"",max:3,placeholder:"请选择命名规则（最多选择3个）",style:{width:"100%"}},{default:r(()=>[n(k,{label:"原名称",value:"original"}),n(k,{label:"数字序列",value:"sequence"}),n(k,{label:"时间戳",value:"timestamp"}),n(k,{label:"图片尺寸",value:"size"})]),_:1},8,["modelValue"])]),_:1}),n(h,null,{default:r(()=>[N(u("div",{class:"preview-name"}," 预览："+S(qe()),513),[[_e,U.value.selectedRules.length>0]])]),_:1})]),_:1},8,["model"]),u("section",ia,[u("div",ra,[n(s,{onClick:He,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(ht))]),_:1}),e[29]||(e[29]=v(" 批量命名 "))]),_:1,__:[29]}),n(s,{onClick:ee,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(re))]),_:1}),e[30]||(e[30]=v(" 打包下载 "))]),_:1,__:[30]}),n(s,{onClick:te,class:"primary-button"},{default:r(()=>[n(a,{class:"mr-2"},{default:r(()=>[n(x(B))]),_:1}),e[31]||(e[31]=v(" 清空列表 "))]),_:1,__:[31]})]),u("div",ua,[n(o,null,{default:r(()=>[u("div",da,[N((q(),ue(l,{ref_key:"uploadRef",ref:P,"auto-upload":!1,"list-type":"picture-card","on-change":K,"on-preview":A,"on-remove":G,"before-remove":W,"on-exceed":Q,"file-list":f.value,drag:"",multiple:""},{default:r(()=>[n(a,null,{default:r(()=>[n(x(me))]),_:1}),e[32]||(e[32]=u("div",{class:"el-upload__text"},[v("拖动文件或者"),u("em",null,"点击上传")],-1))]),file:r(({file:c})=>[u("div",ca,[u("div",ma,[u("img",{src:c.processed_url||c.origin_url||c.url,class:"upload-list-item-image original-image",loading:"lazy",alt:c.name},null,8,_a)]),u("div",{class:"upload-list-item-actions",onClick:e[7]||(e[7]=de(()=>{},["stop"]))},[u("span",{class:"upload-list-item-preview",onClick:L=>A(c)},[n(a,null,{default:r(()=>[n(x(ce))]),_:1})],8,pa),u("span",{class:"upload-list-item-delete",onClick:L=>oe(c)},[n(a,null,{default:r(()=>[n(x(B))]),_:1})],8,fa)]),u("span",ga,S(c.name),1)])]),_:1},8,["file-list"])),[[le,{itemSize:190,buffer:5}]])])]),_:1})])])]),_:1})]),_:1}),n(w,{modelValue:H.value,"onUpdate:modelValue":e[8]||(e[8]=c=>H.value=c),title:"图片详情",width:"60%"},{default:r(()=>[n(kt,{imageUrl:ge.value,imageId:Y.value,onClose:he},null,8,["imageUrl","imageId"])]),_:1},8,["modelValue"]),n(w,{modelValue:J.value,"onUpdate:modelValue":e[9]||(e[9]=c=>J.value=c),title:"图片编辑",width:"60%"},{default:r(()=>[n(wt,{ref_key:"editRef",ref:ve,imageId:Y.value,imageList:_.value,onClose:he,onChangeImage:Ve},null,8,["imageId","imageList"])]),_:1},8,["modelValue"])])),[[M,I.value]])}}}),$a=Se(va,[["__scopeId","data-v-584d7d81"]]);export{$a as default};
//# sourceMappingURL=index-B6Z-31vd.js.map
