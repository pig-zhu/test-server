import{_ as ne,h as ce,c as pe,a as O,u as _e,b as oe,e as se,f as Z,d as fe,k as ee,l as me,m as ge,p as ye,n as ve,o as be,q as he,s as te,t as ke,E as H,v as we,w as xe,x as Ce,P as Se}from"./index-D7mwCrnB.js";import{E as De}from"./el-row-DC3WJ2P2.js";import{v as Ve}from"./el-loading-B11eFGmQ.js";import{E as Ee}from"./el-pagination-C-0ZFUJb.js";import{r as w,q as $,s as n,a1 as $e,N as r,P as u,Q as e,L as b,M as A,aM as J,S as a,aK as Be,ah as h,X as v,t as ae,a4 as re,c as W,A as Pe,am as ie,u as _,bf as Le,O as Ie,F as ze,at as Te,z as Fe}from"./vue-vendor-BgjGt3mC.js";import{E as Me}from"./el-drawer-hvleCpc-.js";import{E as Re}from"./el-card-zedNbdDm.js";import{b as je}from"./remark-CBsncvHK.js";import"./jszip-C7-yN4-L.js";import{E as Ne}from"./index-BZMJx0qS.js";import"./axios-xsH4HHeE.js";import"./lodash-BmZg10rb.js";import"./quill-BeGMbSWh.js";const Ye={class:"basic-table"},Ue={key:0},He={key:1},Ke={key:0},qe={key:1},Ae={name:"CommonBasicTable"},Oe=Object.assign(Ae,{props:{tableData:{type:Array,required:!0,default:()=>[]},headerList:{type:Array,required:!0,default:()=>[]},pageSize:{type:Number,default:()=>10},total:{type:Number,default:()=>0},currentPage:{type:Number,default:()=>1},isBorder:{type:Boolean,default:()=>!1},isLoading:{type:Boolean,default:()=>!1},isIndex:{type:Boolean,default:()=>!1},isSelect:{type:Boolean,default:()=>!1},isRadio:{type:Boolean,default:()=>!1},rowKey:{type:String,default:""},isMore10000:{type:Boolean,default:()=>!1}},emits:["opt-click","page-change"],setup(k,{expose:F,emit:L}){const g=k,c=L,M=(d,I)=>{let m=!0;if(d===void 0)m=!1;else{m=!0;for(const f in d)(I[f]===void 0||I[f]!==d[f])&&(m=!1)}return m},B=(d,I)=>{c("opt-click",d,I)},P=d=>{c("page-change",d)},D=d=>d[g.rowKey]||d.id||d.md5,z=d=>{c("select-change",d)},x=d=>{c("current-change",d)},C=w(null);return F({basicTable:C}),(d,I)=>{const m=ce,f=O,Y=Be("router-link"),j=pe,T=Ee,N=Ve;return n(),$("div",Ye,[$e((n(),u(j,{ref_key:"basicTable",ref:C,"element-loading-text":"Loading...","element-loading-background":"rgba(255, 255, 255, 0.8)",data:k.tableData,border:k.isBorder,"header-cell-style":{background:"#F8F9FA",color:"#242933",fontsize:"14px",height:"48px"},"cell-style":{fontsize:"14px",height:"48px"},"row-key":D,"highlight-current-row":k.isRadio,onSelectionChange:z,onCurrentChange:x},{default:e(()=>[k.isSelect?(n(),u(m,{key:0,type:"selection","reserve-selection":!0,width:"55"})):b("",!0),k.isIndex?(n(),u(m,{key:1,label:"序号",type:"index",width:"80"})):b("",!0),(n(!0),$(A,null,J(k.headerList,l=>(n(),$(A,null,[l.prop==="opt"?(n(),u(m,{key:l.prop+"opt",prop:l.prop,label:l.label,"min-width":l.width,fixed:l.fixed},{default:e(s=>[l.isSlot?b("",!0):(n(),$("div",Ue,[(n(!0),$(A,null,J(l.btns,o=>(n(),u(f,{key:o.name,type:o.type,plain:"",size:"small",disabled:M(o.disable,s.row),onClick:t=>B(o.name,s.row)},{default:e(()=>[h(v(o.label),1)]),_:2},1032,["type","disabled","onClick"]))),128))])),l.isSlot?(n(),$("div",He,[ae(d.$slots,"btn",{rowData:s.row,index:s.$index},void 0,!0)])):b("",!0)]),_:2},1032,["prop","label","min-width","fixed"])):l.prop==="jump"?(n(),u(m,{key:l.prop+"jump",prop:l.prop,label:l.label,"min-width":l.width,fixed:l.fixed},{default:e(s=>[(n(!0),$(A,null,J(l.links,o=>(n(),u(Y,{key:o.name,to:o.path+"/"+s.row.id,class:"r-link"},{default:e(()=>[h(v(o.label),1)]),_:2},1032,["to"]))),128))]),_:2},1032,["prop","label","min-width","fixed"])):l.prop==="formatter"?(n(),u(m,{key:l.prop+"formatter",prop:l.prop,label:l.label,"min-width":l.width,fixed:l.fixed},{default:e(s=>[ae(d.$slots,"formatter",{label:l.label,rowData:s.row,index:s.$index},void 0,!0)]),_:2},1032,["prop","label","min-width","fixed"])):(n(),u(m,{key:l.prop,prop:l.prop,label:l.label,"min-width":l.width,fixed:l.fixed,"show-overflow-tooltip":""},{default:e(s=>[l.map?(n(),$("span",Ke,v(d.setMapText(l.map,s.row[l.prop])),1)):(n(),$("span",qe,v(s.row[l.prop]),1))]),_:2},1032,["prop","label","min-width","fixed"]))],64))),256))]),_:3},8,["data","border","highlight-current-row"])),[[N,k.isLoading]]),r("div",null,[a(T,{background:"","page-size":k.pageSize,layout:"total,prev, pager, next",total:k.total,"current-page":k.currentPage,onCurrentChange:P},null,8,["page-size","total","current-page"])])])}}}),Ge=ne(Oe,[["__scopeId","data-v-8fe1befe"]]),Qe={key:3},Xe={class:"ml-10"},Je={class:"flex justify-between"},We={class:"flex items-center gap-[4px]"},Ze=["id"],et={class:"dialog-footer"},tt={class:"dialog-footer"},at="灵感详情",lt="灵感信息",le="灵感内容",nt={__name:"Detail",props:{detailId:{type:String,required:!0}},emits:["deleteItem"],setup(k,{expose:F,emit:L}){const g=_e(),c=w(!1),M=L,B=k,P=o=>o&&o.length>0?o.join("、"):"",D=w(!1),z=w(null),x=re({industry_id:null,form:{product_name:"",benefits:"",benefits_unfixed:"",target_audience:"",script_scene:"",script_style:"",script_mode:"",structure_begin:[],structure_end:[],structure_middle:[],structure_transition:[],number_of_character:"",character_profile:""}}),C=w(""),d=()=>{D.value=!0},I=()=>{D.value=!1,C.value=""},m=W(()=>o=>o.includes(x.form.industry_id)),f=W(()=>o=>{var y;let t=null;return x.form.industry_id?t=x.form.industry_id:((y=x.form.structure_begin)==null?void 0:y.length)>0?t=2:t=1,g.fieldShouldDisplay(o,t)}),Y=()=>{const t=z.value.outerHTML;ge(t,"text/html")},j=async()=>{const o={id:B.detailId};await M("deleteItem",o),c.value=!1},T=w(!1),N=async()=>{T.value=!0,await ye(B.detailId,{content:C.value}),T.value=!1,D.value=!1},l=async o=>{const{data:{parent_snapshot:t,content:y}}=await ve(o);x.form=t,C.value=y};Pe(()=>B.detailId,(o,t)=>{o!==null&&ze(()=>{l(o)})},{deep:!0,immediate:!0});const{form:s}=ie(x);return F({drawerVisible:c}),(o,t)=>{const y=se,G=oe,K=Re,i=O,p=Z,V=me,S=ee,q=fe,Q=Me;return n(),u(Q,{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=E=>c.value=E),title:at},{default:e(()=>[a(K,null,{header:e(()=>[r("div",{class:"card-header"},[r("span",null,v(lt))])]),default:e(()=>[a(G,{"label-suffix":":",model:_(s)},{default:e(()=>[f.value("product_name")?(n(),u(y,{key:0,label:"产品名称"},{default:e(()=>[h(v(_(s).product_name),1)]),_:1})):b("",!0),f.value("benefits")?(n(),u(y,{key:1,label:"利益点"},{default:e(()=>[h(v(_(s).benefits),1)]),_:1})):b("",!0),f.value("target_audience")?(n(),u(y,{key:2,label:"角色设定"},{default:e(()=>[h(v(_(s).target_audience),1)]),_:1})):b("",!0),m.value([2])?(n(),$("div",Qe,[t[5]||(t[5]=r("div",{class:"md-20 text-[15px] font-medium"},"脚本结构：",-1)),r("div",Xe,[f.value("structure_begin")?(n(),u(y,{key:0,label:"开头吸睛"},{default:e(()=>[r("span",null,v(P(_(s).structure_begin)),1)]),_:1})):b("",!0),f.value("structure_transition")?(n(),u(y,{key:1,label:"激发兴趣"},{default:e(()=>[r("span",null,v(P(_(s).structure_transition)),1)]),_:1})):b("",!0),f.value("structure_middle")?(n(),u(y,{key:2,label:"产品优势"},{default:e(()=>[r("span",null,v(P(_(s).structure_middle)),1)]),_:1})):b("",!0),f.value("structure_end")?(n(),u(y,{key:3,label:"行动号召"},{default:e(()=>[r("span",null,v(P(_(s).structure_end)),1)]),_:1})):b("",!0)])])):b("",!0),f.value("number_of_character")?(n(),u(y,{key:4,label:"口播类型"},{default:e(()=>[r("span",null,v(_(s).number_of_character||""),1)]),_:1})):b("",!0),f.value("character_profile")?(n(),u(y,{key:5,label:"演员角色"},{default:e(()=>[r("span",null,v(_(s).character_profile||""),1)]),_:1})):b("",!0),f.value("script_scene")?(n(),u(y,{key:6,label:"剧本场景"},{default:e(()=>[r("span",null,v(_(s).script_scene||""),1)]),_:1})):b("",!0),f.value("script_style")?(n(),u(y,{key:7,label:"剧本类型"},{default:e(()=>[r("span",null,v(_(s).script_style||""),1)]),_:1})):b("",!0),f.value("script_mode")?(n(),u(y,{key:8,label:"模式选择"},{default:e(()=>[r("span",null,v(_(s).script_mode||""),1)]),_:1})):b("",!0)]),_:1},8,["model"])]),_:1}),a(K,null,{header:e(()=>[r("div",{class:"card-header"},[r("span",null,v(le))])]),default:e(()=>[r("div",{class:"overflow-y-auto flex-grow custom-scroll inspiration",ref_key:"inspirationRef",ref:z},[a(_(Le),{remarkPlugins:[_(je)],class:"result flex flex-col flex-1 h-full w-full",source:C.value},null,8,["remarkPlugins","source"])],512)]),_:1}),a(K,{title:le},{default:e(()=>[a(i,{type:"text",onClick:d},{default:e(()=>t[6]||(t[6]=[h("编辑")])),_:1,__:[6]}),a(i,{type:"text",onClick:Y},{default:e(()=>t[7]||(t[7]=[h("复制")])),_:1,__:[7]}),a(i,{type:"text",onClick:j},{default:e(()=>t[8]||(t[8]=[h("删除")])),_:1,__:[8]})]),_:1}),a(q,{modelValue:D.value,"onUpdate:modelValue":t[3]||(t[3]=E=>D.value=E),title:"编辑",width:"50%","before-close":o.handleClose,"align-center":""},{footer:e(()=>[r("span",tt,[a(i,{onClick:t[2]||(t[2]=E=>D.value=!1)},{default:e(()=>t[12]||(t[12]=[h("取消")])),_:1,__:[12]}),a(i,{type:"primary",onClick:N,color:"#6a50fd",loading:T.value},{default:e(()=>t[13]||(t[13]=[h("保存")])),_:1,__:[13]},8,["loading"])])]),default:e(()=>[a(p,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=E=>C.value=E),type:"textarea",placeholder:"请输入内容",rows:25,resize:"none"},null,8,["modelValue"]),a(q,{modelValue:o.innerVisible,"onUpdate:modelValue":t[1]||(t[1]=E=>o.innerVisible=E),width:"500","append-to-body":"","align-center":""},{header:e(({titleId:E,titleClass:X})=>[r("div",Je,[r("div",We,[r("div",null,[a(S,{class:"text-[red]"},{default:e(()=>[a(V)]),_:1})]),r("h4",{id:E,class:Ie(X)},"提示",10,Ze)])])]),footer:e(()=>[r("div",et,[a(i,{type:"primary",onClick:N,color:"#6a50fd",loading:T.value},{default:e(()=>t[9]||(t[9]=[h(" 保存内容 ")])),_:1,__:[9]},8,["loading"]),a(i,{onClick:I},{default:e(()=>t[10]||(t[10]=[h("退出编辑")])),_:1,__:[10]})])]),default:e(()=>[t[11]||(t[11]=r("span",null,"内容尚未保存， 需要保存编辑内容吗？",-1))]),_:1,__:[11]},8,["modelValue"])]),_:1},8,["modelValue","before-close"])]),_:1},8,["modelValue"])}}},ot={name:"CommonSearchBar"},st=Object.assign(ot,{props:{placeholder:{type:String,default:()=>"请输入搜素内容"}},emits:["search"],setup(k,{emit:F}){const L=F,g=w(""),c=()=>{L("search",g.value)};return(M,B)=>{const P=be,D=ee,z=O,x=Z;return n(),u(x,{modelValue:g.value,"onUpdate:modelValue":B[0]||(B[0]=C=>g.value=C),class:"input-with-search",placeholder:k.placeholder,clearable:"",onClear:c,onKeyup:Te(c,["enter"])},{append:e(()=>[a(z,{size:"small",onClick:c},{default:e(()=>[a(D,null,{default:e(()=>[a(P)]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])}}}),rt=ne(st,[["__scopeId","data-v-a127337b"]]),it={class:"flex flex-col h-full w-[100%] mt-[100px]"},dt={key:0,class:"flex items-center"},ut={class:"mr-[2px]"},ct={class:"flex items-center"},St={__name:"index",setup(k){const F=[{label:"灵感名称",prop:"formatter",width:200},{label:"创作者",prop:"open_id",width:100},{label:"创建时间",prop:"create_time",width:150},{label:"更新时间",prop:"update_time",width:150},{label:"操作",prop:"opt",width:200,isSlot:!0,fixed:"right"}];W(()=>[]);const L=w(null),g=re({headerList:F,tableData:[],keyword:"",currentPage:1,totalCount:0,pagesize:10,isLoaing:!1,isSelect:!0}),c=w({}),M=w([]),B=w(null);w(null),w("");const P=i=>{c.value={...i}},D=async()=>{const i=l.value.find(V=>V.id===c.value.id),p={favorite_id:c.value.id,name:c.value.name};try{const{code:V}=await Se(p);V===0?(H({message:"修改成功",type:"success"}),i.name=c.value.name,x(),m()):H({message:"修改失败",type:"error"})}catch{}},z=()=>{L.value=null},x=()=>{L.value=!1},C=i=>{g.currentPage=i,m()},d=i=>{g.keyword=i,g.currentPage=1,m()},I=i=>{M.value=i.map(p=>p.id)},m=async()=>{g.isLoaing=!0;const i={page:g.currentPage,keyword:g.keyword,pagesize:g.pagesize};try{const{data:{list:p,count:V}}=await he(i);g.tableData=p.map(S=>(S.create_time=te(S.create_time).format("YYYY-MM-DD HH:mm:ss"),S.update_time=te(S.update_time).format("YYYY-MM-DD HH:mm:ss"),S)),t.value=V,g.isLoaing=!1}catch{g.isLoaing=!1}},f=i=>{Ne.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{(await ke({favorite_id:i.id})).code===0&&(m(),H({type:"success",message:"删除成功!"}))}).catch(()=>{H({type:"info",message:"已取消删除"})})},Y=async()=>{try{await Ce({id_list:M.value}),await m(),H({type:"success",message:"删除成功!"})}catch{}},j=w(null),T=i=>{B.value.drawerVisible=!0,j.value=i.id};Fe(()=>{m()});const{headerList:N,tableData:l,currentPage:s,pagesize:o,totalCount:t,isLoaing:y,isSelect:G,keyword:K}=ie(g);return(i,p)=>{const V=De,S=O,q=xe,Q=ee,E=Z,X=se,de=oe,ue=we;return n(),$("div",it,[a(V,{class:"flex items-center mb-[20px]"},{default:e(()=>[a(V,{span:6},{default:e(()=>[a(rt,{placeholder:"请输入搜索关键词",onSearch:d})]),_:1}),a(V,{span:6},{default:e(()=>[a(S,{onClick:Y,type:"primary"},{default:e(()=>p[1]||(p[1]=[h("批量删除")])),_:1,__:[1]})]),_:1})]),_:1}),a(Ge,{total:_(t),"current-page":_(s),"is-loading":_(y),"is-select":_(G),headerList:_(N),pageSize:_(o),onSelectChange:I,onPageChange:C,"table-data":_(l)},{formatter:e(R=>[R.label==="灵感名称"?(n(),$("div",dt,[r("span",ut,v(R.rowData.name),1),a(ue,{visible:L.value,onHide:z,placement:"right",width:400,trigger:"click"},{reference:e(()=>[a(Q,{onClick:U=>P(R.rowData),class:"cursor-pointer"},{default:e(()=>[a(q)]),_:2},1032,["onClick"])]),default:e(()=>[a(de,{model:c.value},{default:e(()=>[a(X,{label:"脚本名称"},{default:e(()=>[a(E,{modelValue:c.value.name,"onUpdate:modelValue":p[0]||(p[0]=U=>c.value.name=U),maxlength:"32"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a(S,{onClick:U=>x(R.index)},{default:e(()=>p[2]||(p[2]=[h("取消")])),_:2,__:[2]},1032,["onClick"]),a(S,{type:"primary",onClick:D},{default:e(()=>p[3]||(p[3]=[h("确定")])),_:1,__:[3]})]),_:2},1032,["visible"])])):b("",!0)]),btn:e(R=>[r("div",ct,[a(S,{type:"text",plain:"",onClick:U=>T(R.rowData)},{default:e(()=>p[4]||(p[4]=[h("查看")])),_:2,__:[4]},1032,["onClick"]),a(S,{type:"text",plain:"",onClick:U=>f(R.rowData)},{default:e(()=>p[5]||(p[5]=[h("删除")])),_:2,__:[5]},1032,["onClick"])])]),_:1},8,["total","current-page","is-loading","is-select","headerList","pageSize","table-data"]),a(nt,{onDeleteItem:f,detailId:j.value,ref_key:"detailRef",ref:B},null,8,["detailId"])])}}};export{St as default};
//# sourceMappingURL=index-B1bIth-v.js.map
