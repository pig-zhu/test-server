{"version":3,"file":"index-CNClUnAV.js","sources":["../../src/assets/pause.png","../../src/assets/play.png","../../src/pages/SpeechSynthesis/components/PersonalEditDialog/index.vue","../../src/store/batchNovelsStore.js","../../src/pages/SpeechSynthesis/components/ToNovelDialog/index.vue","../../src/pages/SpeechSynthesis/components/ShowSRTFileDialog/index.vue","../../src/assets/music-icon.png","../../src/assets/drop-down.png","../../src/pages/SpeechSynthesis/SpeechReproduction/index.vue","../../src/pages/SpeechSynthesis/index.vue"],"sourcesContent":["export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABTUlEQVR4nO3dMU4cQRBA0ZoVkReOQOBTOeSOBFwMYSGwvE44wIzohW/pvbg0KvWfvAYAAAAAAFhtW/m9y+VympnbneO/Z+ZPrOjh/bdt6RMuD3IzM+87x88z8xaLcmT/u5l53bZt6f6nlR+bmR8HZl8Ozn+FI/s8X2P/1UH4JEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQmNVB/s7Mw465x5m5/5iv+bVjn6eZ+XmN/VffoJqdd5zOH0e1ig7tv/oo2M2VHuQu+vfv9b/vDwAAAADA95mZfxj0IQpDdzeNAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAEdklEQVR4nO2dv2tTURTHv0mattbWOFirRXBQkaIotI6CLhZ0cVMnF0dxcNF/QXBR3BWrIDjpoIMI4qB/gKu4Kv2h0B+2mv6IXPxeeIQ2zWvOvbn3vvOBkDQp572888453/szUBRFURRFURRFURRFURRFURRFSZyS66/XaDSa3yoD2EjxspZKnV/OHpEzaf9YA5m/lwGseTx+FPhyiDlOL4D5zHs1Pi9EeN2cUfZ0DBMZv5veN84ZBbCHj8IDTzWkH8DKNv82RMetMZVFiUQN8REh7bDIiNlgtIRyXt7xWdTbwUZSYetLqHfiPOuOiZbBAM7HG6HUkFZU6JQ/AOrerswOSKmGtGKdEdNfBDUWU/E0TjmQukyOIWVthpXJdaayIChKytqMxUyrPymZHJrszUtyMjmVOytb9KOWybHWkFZYmey9Nzm27ndfrPM4UaaxEFPWZQAfAbzv0I5JY/tjk8khOuQwgPMAvgjY+krHrNEp/QI2nRJaDfkJYJivr/JC3uK4yVGB0+mjU5ZcDCOn2A4x+d8Owk8A+AzgHIAnQvb/MmIGQ01joUXIDIARnpd1zCifxwHcA3BC6NRG2MrfYMR0TFFa6t8ZOe8AnARwR8juNKNlmdEShOKMpWE4zX4rcws+ZF/WA3ahdMp60/hLV4mtpd6gY0wKvA3goqDtIGRyrF0ntvH3CcAzQbtWJte7JZNT6Mt6TqdICpSVbk26SMEhpthfBzBFpxgV9hjALwHb3mVyDLJ3p1wC8EbwqwwzlW0pk4s8QLUd5sq8BXAawBXWmpkObc4yWpZcyuRUHWKjaxLABwBnKZelbDuTySmnrCz7+HpW0KbhCIA5O/aSal+WC+b4MGqsCuCp0DG+ZUYrRa5laBHyg31X0hGSxThklTVgVdBurVQqdTwYFlqEVDwcwzohyMVCRUlZljLbKxCOwCEpBxctZZUcDEwdZFFfSLGou0hZ1qYZT3khbLtmnSFlMMVZJ5YKU2Cvg1VZJbZBxKcapdgwzOaNu5S7UowwKgYZFeLCILUIsWvgrzlKT3A9zyuVCKlSPR1jv5WkM/rojCUfk+5i7zqxdcKFetrNDNL2koei9/ZO0Qk3OJ9LiuOMiB5GhNf1JzFGyBCfXaSPjupE0SJkks4wM01uCtuuuGhT7ISYVNYpAHspZceFbNpW9kAos+RDd4hNXWby9X1h20EuVwg1Zdn6YcaxHwF4JWi76lPG5iW0CMluDHCBM0qksDK2J+RFPKFFyCEAZwC8BvBSyGZXZWxeUlxjmMVrndA1hlsTzf4ozaTmkOBkbF5SckgSmwek4JAqI8LJukHfxOwQuwFN0DI2LzH29o4xPZVjkLF5iS1Ckt+LMRaHRCtj8xK6Q6KXsXkJ2SGF3Co2RIckJWPzEpJDbET0FnmDfh+y19zlu1p8PtaUnqLd+10CHw6pMxInNvmsxq0zFvRnK/7j8xd27EL86UydSErGSnS/+/7JI7tIMqj9dqWQcIiiKIqiKIqiKIqiKIqiKIqiKErSAPgHIY4WoV4w4XIAAAAASUVORK5CYII=\"","<template>\r\n  <el-dialog\r\n    v-model=\"dialogVisible\"\r\n    title=\"编辑音色\"\r\n    width=\"1000px\"\r\n    :before-close=\"handleClose\"\r\n  >\r\n    <el-form\r\n      ref=\"otherForm\"\r\n      :model=\"otherFormData\"\r\n      :rules=\"formRules\"\r\n      label-width=\"100px\"\r\n      v-loading=\"loading\"\r\n    >\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"10\">   \r\n        <el-form-item label=\"音色头像\" prop=\"tonePhoto\">\r\n          <el-upload\r\n            class=\"avatar-uploader\"\r\n            action=\"/api/file/upload\"\r\n            ref=\"avatarUploadRef\"\r\n            :show-file-list=\"false\"\r\n            :http-request=\"handleAvatarUpload\"\r\n            :on-success=\"handleAvatarSuccess\"\r\n            :on-remove=\"handleAvatarRemove\"\r\n            accept=\"image/*\"\r\n          >\r\n            <img v-if=\"otherFormData.avatar\" :src=\"otherFormData.avatar\" class=\"avatar_class\" />\r\n            <el-icon v-else class=\"avatar-uploader-icon\"><Plus /></el-icon>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-col>\r\n      <el-col :span=\"12\"> \r\n        <el-form-item label=\"使用量:\" prop=\"generateCount\">\r\n          {{ otherFormData.generate_count ? otherFormData.generate_count : '--'}}\r\n        </el-form-item>  \r\n        <el-form-item label=\"公开状态\" prop=\"is_public\">\r\n          <el-select v-model=\"otherFormData.is_public\" placeholder=\"请选择\" style=\"width: 240px\">\r\n            <el-option label=\"非公开\" :value=\"false\">\r\n            </el-option>\r\n            <el-option label=\"公开\" :value=\"true\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>  \r\n      </el-col>\r\n    </el-row>\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"10\"> \r\n        <el-form-item label=\"音色名称\" prop=\"name\">\r\n          <el-input\r\n            v-model=\"otherFormData.name\"\r\n            placeholder=\"请输入\"\r\n            maxlength=\"4\"\r\n            show-word-limit\r\n            clearable\r\n          />\r\n        </el-form-item>       \r\n      </el-col>\r\n      <el-col :span=\"12\"> \r\n        <el-form-item label=\"行业\" prop=\"industry\">\r\n          <el-select v-model=\"otherFormData.industry\" placeholder=\"请选择\" style=\"width: 240px\">\r\n            <el-option\r\n              v-for=\"industry in props.categories.industries\"\r\n              :key=\"industry\"\r\n              :label=\"industry\"\r\n              :value=\"industry\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>       \r\n      </el-col>\r\n    </el-row>\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"10\"> \r\n        <el-form-item label=\"音色性别\" prop=\"gender\">\r\n          <el-select v-model=\"otherFormData.gender\" placeholder=\"请选择\" style=\"width: 240px\">\r\n            <el-option label=\"男性\" value=\"male\">\r\n            </el-option>\r\n            <el-option label=\"女性\" value=\"female\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>       \r\n      </el-col>\r\n      <el-col :span=\"12\"> \r\n        <el-form-item label=\"情绪\" prop=\"emotion\">\r\n          <el-select v-model=\"otherFormData.emotion\" placeholder=\"请选择\" style=\"width: 240px\">\r\n            <el-option\r\n              v-for=\"emotions in props.categories.emotions\"\r\n              :key=\"emotions\"\r\n              :label=\"emotions\"\r\n              :value=\"emotions\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>       \r\n      </el-col>\r\n    </el-row>\r\n    <!-- <el-row :gutter=\"20\">\r\n      <el-col :span=\"10\"> \r\n        <el-form-item label=\"试听音频\" prop=\"audition_file_name\">\r\n          <el-upload\r\n            class=\"upload-sovits-model\"\r\n            action=\"/api/file/upload\"\r\n            :before-upload=\"handleBeforeListenUpload\"\r\n            :file-list=\"listenAudioList\"\r\n            :http-request=\"handlListenAudioUpload\"\r\n            :on-remove=\"handleListenAudioRemove\"\r\n            list-type=\"text\"\r\n            accept=\".mp3,.wav\"\r\n            :limit=\"1\"\r\n            :on-exceed=\"handleListenAudioExceed\"\r\n          >\r\n            <el-button type=\"text\">上传音频</el-button>\r\n            <span class=\"remind_style\">\r\n              （ 支持mp3/wav格式，文件小于2mb ）\r\n            </span>\r\n          </el-upload>\r\n\r\n        </el-form-item>       \r\n      </el-col>\r\n    </el-row> -->\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"12\"> \r\n        <el-form-item label=\"参考音频\" prop=\"reference_voice_name\">\r\n          <el-upload\r\n            class=\"upload-sovits-model\"\r\n            action=\"/api/file/upload\"\r\n            :file-list=\"referAudioList\"\r\n            :before-upload=\"handleBeforeReferUpload\"\r\n            :http-request=\"handlReferAudioUpload\"\r\n            :on-remove=\"handleReferAudioRemove\"\r\n            list-type=\"text\"\r\n            accept=\".mp3,.wav\"\r\n            :limit=\"1\"\r\n            :on-exceed=\"handleReferAudioExceed\"\r\n          >\r\n            <el-button type=\"text\">上传音频</el-button>\r\n            <span class=\"remind_style\">\r\n              （ 支持mp3/wav格式，文件小于1mb，时长3-10s）\r\n            </span>\r\n          </el-upload>\r\n        </el-form-item>       \r\n      </el-col>\r\n    </el-row>\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"22\"> \r\n        <el-form-item label=\"参考文本\" prop=\"reference_voice_text\">\r\n          <el-input\r\n            v-model=\"otherFormData.reference_voice_text\"\r\n            :rows=\"3\"\r\n            type=\"textarea\"\r\n            placeholder=\"请输入\"\r\n            maxlength=\"100\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>       \r\n      </el-col>\r\n    </el-row>\r\n    </el-form>\r\n    <template #footer>\r\n      <div class=\"dialog-footer\">\r\n        <el-button type=\"danger\" @click=\"handleDelete()\" :disabled=\"loading\">删除音色</el-button>\r\n        <el-button @click=\"handleClose()\" :disabled=\"loading\">取消设置</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSubmit()\" :disabled=\"loading\">确认设置</el-button>\r\n      </div>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { ref, reactive, watch, nextTick, onMounted, toRefs, computed  } from 'vue'\r\nimport type { UploadProps, UploadUserFile } from 'element-plus'\r\nimport { Plus } from '@element-plus/icons-vue'\r\nimport { ElMessageBox, ElMessage } from 'element-plus'\r\nconst dialogVisible = ref(false)\r\nimport {\r\n  postUploadFile,\r\n  postUpdateModel,\r\n  PostDeleteModel,\r\n} from '@/service/speech'\r\nconst otherForm = ref()\r\nconst loading = ref(false)\r\nconst emit = defineEmits(['submitForm','createNewTag','closeDialog'])\r\nconst props = defineProps({\r\n  propdata: {\r\n    type: Object,\r\n    required: true,\r\n  },\r\n  categories:{\r\n    type: Object,\r\n    required: true,\r\n  }\r\n})\r\nconst referAudioList = computed(() => {\r\n  return otherFormData.value.reference_voice_name\r\n    ? [\r\n        {\r\n          uid: otherFormData.value.reference_voice_id,\r\n          name: otherFormData.value.reference_voice_name,\r\n          status: 'done',\r\n          url: otherFormData.value.reference_voice_url\r\n        }\r\n      ]\r\n    : []\r\n})\r\nconst listenAudioList = computed(() => {\r\n  return otherFormData.value.audition_file_name\r\n    ? [\r\n        {\r\n          uid: otherFormData.value.audition_file_id,\r\n          name: otherFormData.value.audition_file_name,\r\n          status: 'done',\r\n          url: otherFormData.value.audition_file_url\r\n        }\r\n      ]\r\n    : []\r\n})\r\nconst handleBeforeListenUpload = async(file) => {\r\n  const validTypes = ['audio/wav','audio/mpeg']\r\n  // 检查文件类型\r\n    if (!validTypes.includes(file.type)) {\r\n    ElMessage.error('只能上传 mp3/wav格式的文件！')\r\n    return false\r\n  }\r\n  //检查文件大小\r\n  const maxSize = 1024 * 1024 * 2\r\n  if (file.size > maxSize) {\r\n    ElMessage.error('文件大小不能超过 2mb')\r\n    return false\r\n  }\r\n  return true;\r\n}\r\nconst handleBeforeReferUpload = async(file) => {\r\n  const validTypes = ['audio/wav','audio/mpeg']\r\n  // 检查文件类型\r\n    if (!validTypes.includes(file.type)) {\r\n    ElMessage.error('只能上传 mp3/wav格式的文件！')\r\n    return false\r\n  }\r\n  //检查文件大小\r\n  const maxSize = 1024 * 1024 \r\n  if (file.size > maxSize) {\r\n    ElMessage.error('文件大小不能超过 1mb')\r\n    return false\r\n  }\r\n  // 检查文件时间长度\r\n  try {\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const audioContext = new AudioContext();\r\n    const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);\r\n    const duration = audioBuffer.duration;\r\n    const maxDuration = 10;\r\n    const minDuration = 3;\r\n    if (duration > maxDuration) {\r\n      ElMessage.error(`音频持续时间不能超过 ${maxDuration} 秒`);\r\n      return false;\r\n    }else if(duration < minDuration){\r\n      ElMessage.error(`音频持续时间不能小于 ${minDuration} 秒`);\r\n      return false;\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('音频时长检测出错，请检查文件是否损坏');\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\nconst handlReferAudioUpload = async (options) => {\r\n  const { file, onSuccess, onError } = options\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  try {\r\n    const response = await postUploadFile(form)\r\n    if (response.code === 0) {\r\n      otherFormData.value.reference_voice_name = file.name \r\n      otherFormData.value.reference_voice_id = response.data.file_id\r\n      ElMessage.success('参考音频上传成功!')\r\n      otherForm.value.validateField(['reference_voice_name'])\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    onError(error)\r\n    ElMessage.error('参考音频上传失败!')\r\n  }\r\n}\r\nconst handlListenAudioUpload = async (options) => {\r\n  const { file, onSuccess, onError } = options\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  try {\r\n    const response = await postUploadFile(form)\r\n    if (response.code === 0) {\r\n      otherFormData.value.audition_file_name = file.name\r\n      otherFormData.value.audition_file_id = response.data.file_id\r\n      ElMessage.success('试听音频上传成功!')\r\n      otherForm.value.validateField(['audition_file_name'])\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    onError(error)\r\n    ElMessage.error('试听音频上传失败!')\r\n  }\r\n}\r\nconst handleListenAudioExceed = async (files, fileList) => {\r\n  const newFile = files[0];\r\n  try {\r\n    const check =  await handleBeforeListenUpload(newFile);\r\n    if(check){\r\n      await handlListenAudioUpload({\r\n        file: newFile,\r\n        onSuccess: (response) => {\r\n          listenAudioList.value = [newFile]\r\n          otherFormData.value.audition_file_id = response.data.file_id\r\n        },\r\n        onError: (error) => {\r\n          ElMessage.error('上传失败')\r\n        },\r\n      })\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('处理文件时出错');\r\n  }\r\n}\r\nconst handleReferAudioExceed = async(files, fileList) => {\r\n  const newFile = files[0];\r\n  try {\r\n    // 先执行预处理\r\n    const check = await handleBeforeReferUpload(newFile);\r\n    if(check){\r\n      await handlReferAudioUpload({\r\n        file: newFile,\r\n        onSuccess: (response) => {\r\n          referAudioList.value = [newFile]\r\n          otherFormData.value.reference_voice_id = response.data.file_id\r\n        },\r\n        onError: (error) => {\r\n          ElMessage.error('上传失败');\r\n        },\r\n      })\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('处理文件时出错');\r\n  }\r\n}\r\n// 关闭弹窗\r\nconst handleClose = () => {\r\n  dialogVisible.value = false\r\n  // 刷新\r\n  refreshList()\r\n  emit('closeDialog')\r\n\r\n}\r\n// 删除按钮\r\nconst handleDelete = async() => {\r\n  ElMessageBox.confirm(\r\n    `<div style=\"font-size: 18px; margin: 20px 40px 0;\">确定要删除该音色?</div>\r\n      <div style=\"padding: 20px 40px;\">该操作会删除所有文件</div>`,\r\n  {\r\n    dangerouslyUseHTMLString: true,\r\n    confirmButtonText: '确定删除',\r\n    cancelButtonText: '取消',\r\n    // type: 'warning',\r\n    confirmButtonClass: 'red-button-class', // 应用自定义按钮类\r\n  })\r\n  .then(async () => {\r\n    try {\r\n      loading.value = true\r\n      const response = await PostDeleteModel({ soundId: otherFormData.value.id })\r\n      if (response.code === 0) {\r\n        ElMessage.success('删除成功!')\r\n        emit('closeDialog')\r\n        loading.value = false\r\n        dialogVisible.value = false\r\n        // 刷新\r\n        refreshList()\r\n      } else {\r\n        loading.value = false\r\n        throw new Error(response.message)\r\n      }\r\n    } catch (error) {\r\n      ElMessage.error('删除失败!')\r\n      loading.value = false\r\n    }\r\n    // 删除接口\r\n  })\r\n  .catch(() => {\r\n    // 取消\r\n  })\r\n}\r\nonMounted(() => {\r\n  dialogVisible.value = true\r\n})\r\nconst init = async (item,visible,tabType) => {\r\n\r\n}\r\nconst handleAvatarUpload = async (options) => {\r\n  const { file, onSuccess, onError } = options\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  // 检查文件类型\r\n  const validTypes = ['image/jpeg', 'image/png', 'image/gif']\r\n  if (!validTypes.includes(file.type)) {\r\n    ElMessage.error('只能上传 JPG, JPEG, PNG 或 GIF 格式的图片')\r\n    options.onError(new Error('Invalid file type'))\r\n    return\r\n  }\r\n  // 检查文件大小（500KB = 512000 bytes）\r\n  const maxSize = 500 * 1024\r\n  if (file.size > maxSize) {\r\n    ElMessage.error('图片大小不能超过 500KB')\r\n    options.onError(new Error('File size exceeds limit'))\r\n    return\r\n  }\r\n  try {\r\n    const response = await postUploadFile(form)\r\n    if (response.code === 0) {\r\n      // otherFormData.value.reference_voice_name = file.name\r\n      otherFormData.value.avatar_id = response.data.file_id\r\n      onSuccess(response.data, file)\r\n      ElMessage.success('头像图片上传成功!')\r\n\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    onError(error)\r\n    ElMessage.error('头像图片上传失败!')\r\n  }\r\n}\r\n\r\nconst handleAvatarSuccess = (response, file) => {\r\n  otherFormData.value.avatar = URL.createObjectURL(file.raw)\r\n}\r\nconst handleAvatarRemove: UploadProps['onRemove'] = (uploadFile, uploadFiles) => {\r\n}\r\nconst handleListenAudioRemove: UploadProps['onRemove'] = (uploadFile, uploadFiles) => {\r\n  otherFormData.value.audition_file_name = ''\r\n  otherFormData.value.audition_file_id = ''\r\n  otherFormData.value.audition_file_url = ''\r\n  otherForm.value.validateField(['audition_file_name'])\r\n}\r\nconst handleReferAudioRemove: UploadProps['onRemove'] = (uploadFile, uploadFiles) => {\r\n  otherFormData.value.reference_voice_name = ''\r\n  otherFormData.value.reference_voice_id = ''\r\n  otherFormData.value.reference_voice_url = ''\r\n  otherForm.value.validateField(['reference_voice_name'])\r\n}\r\n\r\n// 刷新数据\r\nconst refreshList = () => {\r\n  if (otherForm.value) {\r\n    otherForm.value.resetFields()\r\n  }\r\n}\r\nconst otherFormData = computed(() => reactive({ ...props.propdata }))\r\n\r\nconst formRules = {\r\n  name: [{ required: true, message: '请输入音色名称', trigger: 'change' }],\r\n  is_public: [{ required: true, message: '请选择公开状态', trigger: 'change' }],\r\n  gender: [{ required: true, message: '请选择音色性别', trigger: 'change' }],\r\n  industry: [{ required: true, message: '请选择行业', trigger: 'change' }],\r\n  emotion: [{ required: true, message: '请选择音色情绪', trigger: 'change' }],\r\n  audition_file_name: [{ required: true, message: '请上传试听音频', trigger: 'change' }],\r\n  reference_voice_name: [{ required: true, message: '请上传参考音频', trigger: 'change' }],\r\n  reference_voice_text: [{ required: true, message: '请输入参考文本', trigger: 'change' }],\r\n}\r\n\r\n//提交\r\nconst handleSubmit = async () => {\r\n  otherForm.value.validate( async(valid, fields) => {\r\n    if (valid) {\r\n      // 调接口\r\n      const params = {\r\n        industry: otherFormData.value.industry,\r\n        emotion: otherFormData.value.emotion,\r\n        gender: otherFormData.value.gender,\r\n        name: otherFormData.value.name,\r\n        is_public: otherFormData.value.is_public,\r\n        reference_voice_text: otherFormData.value.reference_voice_text,\r\n        avatar_id: otherFormData.value.avatar_id,\r\n        audition_file_id: otherFormData.value.audition_file_id,\r\n        gpt_model_id: otherFormData.value.gpt_model_id,\r\n        sovits_model_id: otherFormData.value.sovits_model_id,\r\n        reference_voice_id: otherFormData.value.reference_voice_id,\r\n        sound_model_id: otherFormData.value.id,\r\n      }\r\n      try {\r\n        loading.value = true\r\n        const response = await postUpdateModel(params)\r\n        if (response.code === 0) {\r\n          ElMessage.success('编辑成功!')\r\n          emit('closeDialog')\r\n          loading.value = false\r\n          dialogVisible.value = false\r\n          // 刷新\r\n          refreshList()\r\n        } else {\r\n          loading.value = false\r\n          throw new Error(response.message)\r\n        }\r\n      } catch (error) {\r\n        ElMessage.error('编辑失败!')\r\n        loading.value = false\r\n\r\n      }\r\n    }\r\n  })\r\n}\r\ndefineExpose({\r\n  init\r\n})\r\n</script>\r\n\r\n<style>\r\n.red-button-class {\r\n  background-color: #db2828 !important;\r\n  border-color: #db2828 !important;\r\n  color: white !important;\r\n}\r\n</style>\r\n<style scoped>\r\n.avatar-uploader .avatar_class {\r\n  width: 150px;\r\n  height: 150px;\r\n  display: block;\r\n  border-radius: 3px; \r\n}\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed var(--el-border-color);\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n  transition: var(--el-transition-duration-fast);\r\n}\r\n\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: var(--el-color-primary);\r\n}\r\n.remind_style{\r\n  font-size: 10px;\r\n  /* padding: 0 10px; */\r\n}\r\n\r\n/* 自定义图标位置 */\r\n.move-icon {\r\n  margin-left: 20px;\r\n}\r\n.el-icon.avatar-uploader-icon {\r\n  font-size: 20px;\r\n  color: #8c939d;\r\n  width: 90px;\r\n  height: 90px;\r\n  text-align: center;\r\n  border: 2px solid #d9dbde; \r\n  border-radius: 3px; \r\n}\r\n</style>","import { defineStore } from 'pinia'\r\n\r\nimport { treeTagsList} from '@/service/novel'\r\nexport const useBatchNovelStoreStore = defineStore('BatchNovelStoreStore', {\r\n  state: () => ({\r\n    tagListData: []\r\n  }),\r\n  actions: {\r\n    async treeTagsList(params) {\r\n      try {\r\n        // 已经在ResourceList.vue的TypeToCategory函数中完成了贴图到贴片的映射\r\n        // 所以这里不再需要额外的映射逻辑\r\n        \r\n        // console.log('Store发送标签请求参数:', params);\r\n        \r\n        const res = await treeTagsList(params);\r\n        if (res.code === 0) {\r\n          this.tagListData = transformData(res.data.list);\r\n          // console.log('标签获取成功，数量:', this.tagListData.length);\r\n          return res;\r\n        } else {\r\n          // console.error('标签接口返回错误:', res.message);\r\n          throw new Error(res.message || '获取标签失败');\r\n        }\r\n      } catch (error) {\r\n        console.error('标签请求异常:', error);\r\n        throw error;\r\n      }\r\n    }\r\n  },\r\n})\r\nfunction transformData(nodes, level = 1, parentId = null) {\r\n  const result = []\r\n  nodes.forEach(node => {\r\n    const transformedNode = {\r\n      value: String(node.id),       // 将 id 转换为字符串\r\n      label: node.name,             // 标签名称\r\n      type: level,                  // 层级\r\n      parent_id: parentId,          // 父级 ID\r\n      is_public: node.is_public      //共享/个人   \r\n    }\r\n    result.push(transformedNode)\r\n    if (node.children && node.children.length > 0) {\r\n      const childrenResult = transformData(node.children, level + 1, node.id)\r\n      result.push(...childrenResult)\r\n    }\r\n  })\r\n  return result\r\n}\r\n","<template>\r\n  <el-dialog\r\n    v-model=\"dialogVisible\"\r\n    width=\"600px\"\r\n    :before-close=\"handleClose\"\r\n  >\r\n  <template #header>\r\n    <div class=\"el-dialog__header\">\r\n      <span class=\"el-dialog__title\">导入小说库</span>\r\n      <hr class=\"dialog-header-divider\">\r\n    </div>\r\n  </template>\r\n  <div class=\"dialog-content\">\r\n    <el-form\r\n      ref=\"otherForm\"\r\n      :model=\"otherFormData\"\r\n      :rules=\"formRules\"\r\n      label-width=\"100px\"\r\n      v-loading=\"loading\"\r\n      label-position=\"top\"\r\n    >\r\n      <el-form-item label=\"小说名称\" prop=\"novel_name\" >\r\n        <el-input\r\n          v-model=\"otherFormData.novel_name\"\r\n          placeholder=\"请输入小说名称\"\r\n          maxlength=\"100\"\r\n          show-word-limit\r\n          style=\"height: 40px; line-height: 40px; border-radius: 20px;\"\r\n        />\r\n      </el-form-item>  \r\n      <el-form-item label=\"选择标签\" prop=\"tags\">\r\n        <el-select \r\n          v-model=\"otherFormData.tags\" \r\n          placeholder=\"选择标签\" \r\n          multiple\r\n          filterable\r\n          allow-create\r\n          clearable \r\n          @change=\"handleTagChange\"\r\n        >\r\n          <el-option\r\n            v-for=\"item in tagsList\"\r\n            :key=\"item.value\"\r\n            :label=\"item.label\"\r\n            :value=\"item.value\"\r\n          >\r\n            <span :style=\"getPaddingStyle(item.type)\"  style=\"float: left;\">\r\n              {{ item.label }}\r\n            </span>\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>  \r\n      <el-form-item label=\"是否公开\" prop=\"is_public\">\r\n        <el-switch\r\n          v-model=\"otherFormData.is_public\"\r\n          size=\"large\"\r\n          active-text=\"公开\"\r\n        />\r\n      </el-form-item>  \r\n      <el-form-item label=\"音频文件\" prop=\"voice_file\">\r\n        <div class=\"file-content\">\r\n          <div class=\"file-icon\">\r\n            <font-awesome-icon icon=\"music\" class=\"iconStyle\"/>\r\n          </div>\r\n          <!-- 右边的两行数据 -->\r\n          <div class=\"text-container\">\r\n            <p class=\"line1\"> {{ props.propdata.industry }}-{{  props.propdata.emotion }}-{{  props.propdata.name }}-{{ props.propdata.gender == 'male' ? '男' : '女'}}.wav</p>\r\n            <p class=\"line2\">{{voiceFile.time}} . {{voiceFile.size}}MB</p>\r\n          </div>\r\n        </div>\r\n      </el-form-item>  \r\n      <el-form-item label=\"字幕文件\" prop=\"srt_file\">\r\n        <div class=\"file-content\">\r\n          <div class=\"file-icon\">\r\n            <font-awesome-icon icon=\"closed-captioning\" class=\"iconStyle\"/>\r\n          </div>\r\n          <div class=\"text-container\">\r\n            <p class=\"line1\">{{ props.propdata.industry }}-{{  props.propdata.emotion }}-{{  props.propdata.name }}-{{ props.propdata.gender == 'male' ? '男' : '女'}}.srt</p>\r\n            <p class=\"line2\">{{SRTfile.size}}KB . {{SRTfile.line}}行</p>\r\n          </div>\r\n        </div>\r\n      </el-form-item>       \r\n    </el-form>\r\n  </div>\r\n\r\n    <template #footer>\r\n      <div class=\"dialog-footer\">\r\n        <el-button @click=\"handleClose()\" :disabled=\"loading\">取消设置</el-button>\r\n        <el-button type=\"primary\" @click=\"handleSubmit()\" :disabled=\"loading\">确认导入</el-button>\r\n      </div>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, watch, nextTick, onMounted, toRefs, computed  } from 'vue'\r\nimport { ElMessageBox, ElMessage } from 'element-plus'\r\nimport { useBatchNovelStoreStore } from '@/store/batchNovelsStore'\r\nconst baseUrl = import.meta.env.VITE_API_BASE_URL\r\nimport {\r\n  exportToNovel,\r\n} from '@/service/speech'\r\nimport { addMaterialTag } from '@/service/novel'\r\nconst batchNovelStore = useBatchNovelStoreStore()\r\nconst dialogVisible = ref(false)\r\n\r\nconst otherForm = ref()\r\nconst loading = ref(false)\r\nconst emit = defineEmits(['submitForm','createNewTag','closeDialog'])\r\nconst props = defineProps({\r\n  propdata: {\r\n    type: Object,\r\n    required: true,\r\n  },\r\n})\r\n\r\n// 关闭弹窗\r\nconst handleClose = () => {\r\n  dialogVisible.value = false\r\n  // 刷新\r\n  refreshList()\r\n  emit('closeDialog')\r\n\r\n}\r\nonMounted(() => {\r\n  dialogVisible.value = true\r\n  init()\r\n})\r\nconst voiceFile = ref({\r\n  time: '-',\r\n  size: '-'\r\n})\r\nconst SRTfile = ref({\r\n  size: '-',\r\n  line: '-'\r\n})\r\nconst init = async () => {\r\n  await batchNovelStore.treeTagsList({ category: '小说' })\r\n  tagsList.value = batchNovelStore.tagListData\r\n  const resultVoice = await handleFile(props.propdata.audition_file_url, 'voice');\r\n  if (resultVoice) {\r\n    voiceFile.value.time = resultVoice.voiceTime;\r\n    voiceFile.value.size = resultVoice.voiceSize;\r\n  }\r\n  const resultSRT = await handleFile(props.propdata.srt_file_path);\r\n  if (resultSRT) {\r\n    SRTfile.value.size = resultSRT.srtSize;\r\n    SRTfile.value.line = resultSRT.srtLine;\r\n  }\r\n}\r\n// 处理文件地址,获取文件时长,大小,行数\r\nconst handleFile = async(fileUrl,type) => {\r\n  try {\r\n    const response = await fetch(baseUrl + fileUrl);\r\n    if (!response.ok) {\r\n        throw new Error(`HTTP error! Status: ${response.status}`);\r\n    }\r\n    // 将响应内容读取为文本\r\n    const text = await response.text();\r\n    // 获取文件大小（以字节为单位）\r\n    const srtSize = new Blob([text]).size;\r\n    const voiceSize = (srtSize / (1024 * 1024)).toFixed(2);\r\n    // 获取文件行数\r\n    const srtLine = text.split('\\n').length;\r\n    let voiceTime = null;\r\n    if (type == 'voice') {\r\n      const audio = new Audio(fileUrl);\r\n      await new Promise((resolve) => {\r\n        audio.onloadedmetadata = () => {\r\n          const seconds = Math.floor(audio.duration);\r\n          const minutes = Math.floor(seconds / 60);\r\n          const remainingSeconds = seconds % 60;\r\n          voiceTime = `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`\r\n          resolve()\r\n        }\r\n      })\r\n    }\r\n    return {\r\n      voiceTime,\r\n      voiceSize,\r\n      srtSize,\r\n      srtLine,\r\n    }\r\n  } catch (error) {\r\n      return null;\r\n  }\r\n}\r\n\r\n// 刷新数据\r\nconst refreshList = () => {\r\n  if (otherForm.value) {\r\n    otherForm.value.resetFields()\r\n  }\r\n}\r\nconst tagsList = ref([])\r\nconst otherFormData = reactive({\r\n  novel_name: '',\r\n  tags: '',\r\n  is_public: true,\r\n})\r\n\r\nconst formRules = {\r\n  is_public: [{ required: true, message: '请选择公开状态', trigger: 'change' }],\r\n  tags: [{ required: true, message: '请选择标签', trigger: 'change' }],\r\n  novel_name: [{ required: true, message: '请输入小数名称', trigger: 'change' }],\r\n}\r\n// 计算缩进样式\r\nconst getPaddingStyle = (type) => {\r\n  const basePadding = 10 // 基础缩进 10\r\n  return `padding-left: ${(type-1) * basePadding}px;`\r\n}\r\n//标签修改\r\nconst handleTagChange = (newTags) => {\r\n  otherForm.value.validateField(['tags'])\r\n  otherFormData.tags = newTags\r\n  const labels = newTags.map(value => getLabelByValue(value))\r\n  labels.forEach(tag => {\r\n    const exists = tagsList.value.some(option => option.label === tag)\r\n    if (!exists) {\r\n      handleCreateNewTagRes(tag)\r\n    }\r\n  })\r\n}\r\n// 方法：根据 value 获取 label\r\nconst getLabelByValue = (value) => {\r\n  const item = tagsList.value.find(option => option.value === value);\r\n  return item ? item.label : value;\r\n}\r\n// 素材新增标签\r\nconst handleCreateNewTagRes = async (data) => {\r\n  let params = {\r\n    name: data,\r\n    is_public: otherFormData.is_public,\r\n    category: '小说'\r\n  }\r\n  await addMaterialTag(params)\r\n    .then(async (res) => {\r\n      if (res.code === 0) {\r\n        ElMessage.success('新增标签成功!')\r\n        await batchNovelStore.treeTagsList({ category: '小说' })\r\n        tagsList.value = batchNovelStore.tagListData\r\n      } else {\r\n        ElMessage.error('新增标签失败!')\r\n        throw new Error(res.message)\r\n      }\r\n    })\r\n    .catch(() => {\r\n      ElMessage.error('新增标签接口报错!')\r\n    })\r\n}\r\n//提交\r\nconst handleSubmit = async () => {\r\n  otherForm.value.validate( async(valid, fields) => {\r\n    if (valid) {\r\n      // 调接口\r\n      const params = {\r\n        task_id: props.propdata.id,\r\n        title: otherFormData.novel_name,\r\n        tag_ids: getIdByName(otherFormData.tags,tagsList.value),\r\n        is_public: otherFormData.is_public,\r\n      }\r\n      try {\r\n        loading.value = true\r\n        const response = await exportToNovel(params)\r\n        if (response.code === 0) {\r\n          ElMessage.success('导入成功!')\r\n          emit('closeDialog')\r\n          loading.value = false\r\n          dialogVisible.value = false\r\n          // 刷新\r\n          refreshList()\r\n        } else {\r\n          loading.value = false\r\n          throw new Error(response.message)\r\n        }\r\n      } catch (error) {\r\n        ElMessage.error('导入失败!')\r\n        loading.value = false\r\n      }\r\n    }\r\n  })\r\n}\r\n// 校验tag list2为标签列表,新增标签后表单存的可能是name,需要取到id\r\nconst getIdByName = (list1,list2) => {\r\n  const idSet = new Set(list2.map(item => item.id))\r\n  const nameToIdMap = {}\r\n  list2.forEach(item => {\r\n      nameToIdMap[item.label] = item.value\r\n  });\r\n  const updatedList1 = list1.map(item => {\r\n      const numericItem = Number(item)\r\n      if (idSet.has(numericItem)) {\r\n          // 如果 id 存在，保持不变（转换为数字类型）\r\n          return numericItem\r\n      } else {\r\n          // 如果 id 不存在，查找 name 是否存在\r\n          if (nameToIdMap[item] !== undefined) {\r\n              return nameToIdMap[item]\r\n          } else {\r\n              // 如果 name 也不存在，保持原值\r\n              return item\r\n          }\r\n      }\r\n  })\r\n  return updatedList1;\r\n}\r\ndefineExpose({\r\n  init\r\n})\r\n</script>\r\n<style scoped>\r\n.dialog-header-divider{\r\n  border: none;\r\n  height: 1px;\r\n  background-color: #ccc;\r\n  margin: 10px 0; \r\n}\r\n.dialog-content{\r\n  margin: 0 20px;\r\n  /* font-size: 22px; */\r\n}\r\n.avatar-uploader .avatar_class {\r\n  width: 150px;\r\n  height: 150px;\r\n  display: block;\r\n  border-radius: 3px; \r\n}\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed var(--el-border-color);\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n  transition: var(--el-transition-duration-fast);\r\n}\r\n\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: var(--el-color-primary);\r\n}\r\n.remind_style{\r\n  font-size: 10px;\r\n}\r\n\r\n/* 自定义图标位置 */\r\n.move-icon {\r\n  margin-left: 20px;\r\n}\r\n.el-icon.avatar-uploader-icon {\r\n  font-size: 20px;\r\n  color: #8c939d;\r\n  width: 90px;\r\n  height: 90px;\r\n  text-align: center;\r\n  border: 2px solid #d9dbde; \r\n  border-radius: 3px; \r\n}\r\n.custom-select-height {\r\n  height: 40px !important;\r\n  line-height: 40px !important;\r\n}\r\n:deep(.custom-select-height .el-select__wrapper) {\r\n  height: 40px !important;\r\n  line-height: 40px !important;\r\n}\r\n.file-content{\r\n  background-color: #f5f7fc;\r\n  width: 100%;\r\n  height: 60px;\r\n  padding: 40px 20px;\r\n  border-radius: 5px;\r\n  /* 使用 Flexbox 布局 */\r\n  display: flex;\r\n  /* 垂直居中对齐 */\r\n  align-items: center;\r\n  /* 左右间距 */\r\n  gap: 10px;\r\n}\r\n.file-icon{\r\n  width: 45px !important;\r\n  height: 45px !important;\r\n  background-color: #7755ff;\r\n  display: flex;\r\n  /* 水平居中 */\r\n  justify-content: center;\r\n  /* 垂直居中 */\r\n  align-items: center;\r\n  border-radius: 5px;\r\n}\r\n.iconStyle{\r\n  color: white;\r\n  font-size: 24px;\r\n}\r\n.line1,\r\n.line2 {\r\n  /* 去除段落默认的外边距 */\r\n  margin: 0;\r\n}\r\n.line2{\r\n  color:#aeaeae;\r\n  font-size: 12px;\r\n\r\n}\r\n\r\n</style>","<template>\r\n  <el-dialog\r\n    v-model=\"dialogVisible\"\r\n    title=\"字幕文件预览\"\r\n    width=\"600px\"\r\n    :before-close=\"handleClose\"\r\n  >\r\n  <template #header>\r\n      <div class=\"el-dialog__header\">\r\n        <span class=\"el-dialog__title\">字幕文件预览</span>\r\n        <hr class=\"dialog-header-divider\">\r\n      </div>\r\n    </template>\r\n  <div class=\"dialog-content\">\r\n    <pre v-if=\"srtContent\">{{ srtContent }}</pre>\r\n  </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted} from 'vue'\r\nconst baseUrl = import.meta.env.VITE_API_BASE_URL\r\n\r\nconst dialogVisible = ref(false)\r\nconst props = defineProps({\r\n  propdata: {\r\n    type: Object,\r\n    required: true,\r\n  },\r\n})\r\nconst emit = defineEmits(['closeDialog'])\r\n// 关闭弹窗\r\nconst handleClose = () => {\r\n  dialogVisible.value = false\r\n  // 刷新\r\n  emit('closeDialog')\r\n}\r\nconst srtContent = ref('');\r\nonMounted(() => {\r\n  dialogVisible.value = true\r\n  fetchSrtContent()\r\n})\r\nconst fetchSrtContent = async () => {\r\n  try {\r\n    const response = await fetch(baseUrl + props.propdata.srt_file_path)\r\n    if (response.ok) {\r\n      // 将响应内容转换为文本\r\n      const text = await response.text();\r\n      // 将获取到的内容赋值给 srtContent\r\n      srtContent.value = text;\r\n    } else {\r\n      console.error('获取 SRT 文件失败，状态码:', response.status);\r\n    }\r\n  } catch (error) {\r\n    console.error('发生错误:', error);\r\n  }\r\n}\r\n\r\n</script>\r\n<style scoped>\r\npre {\r\n  white-space: pre-wrap;\r\n  word-wrap: break-word;\r\n  font-family: monospace;\r\n}\r\n.dialog-content{\r\n  margin: 5px 20px;\r\n  height: 600px;\r\n  background-color: #f5f7fc;\r\n  padding: 20px;\r\n  overflow-y: auto;\r\n}\r\n.dialog-header-divider{\r\n  border: none;\r\n  height: 1px;\r\n  background-color: #ccc;\r\n  margin: 10px 0; \r\n}\r\n/* Custom scrollbar */\r\n::-webkit-scrollbar {\r\n  width: 6px;\r\n  height: 6px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n  background: transparent;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n  background: #d1d1e0;\r\n  border-radius: 10px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n  background: #b3b3cc;\r\n}\r\n</style>","export default \"data:image/png;base64,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\"","export default \"__VITE_ASSET__DhYP6cDU__\"","<template>\r\n  <div class=\"speech-reproduction\">\r\n    <div class=\"cancel-repro\">\r\n      <el-button \r\n      class=\"cancel-repro-button\"\r\n      type=\"danger\" \r\n      @click=\"handleCancelRepro()\" \r\n      >清空语音复刻信息</el-button>\r\n    </div>\r\n    <div v-loading=\"clearLoading\">\r\n      <div class=\"add-model\">\r\n        <div class=\"add-title\">新建音色</div>\r\n        <el-form\r\n          ref=\"toneForm\"\r\n          :model=\"toneFormData\"\r\n          :rules=\"formRules\"\r\n          v-loading=\"addLoading\"\r\n        >\r\n          <el-row :gutter=\"24\">\r\n            <el-col :span=\"5\" class=\"avatar-content\">   \r\n              <el-form-item prop=\"avatar_id\" >\r\n                <div>\r\n                  <el-upload\r\n                    class=\"avatar-uploader\"\r\n                    action=\"/api/file/upload\"\r\n                    ref=\"avatarUploadRef\"\r\n                    :show-file-list=\"false\"\r\n                    :http-request=\"handleAvatarUpload\"\r\n                    :before-upload=\"handleBeforeAvatarUpload\"\r\n                    :on-success=\"handleAvatarSuccess\"\r\n                    accept=\"image/*\"\r\n                    :disabled=\"addDisabled\"\r\n                    v-loading=\"addAvataLoading\"\r\n                  >\r\n                    <img v-if=\"toneFormData.avatar\" :src=\"toneFormData.avatar\" class=\"avatar_class\" />\r\n                    <el-icon v-else class=\"avatar-uploader-icon\"><UploadFilled /></el-icon>\r\n                  </el-upload>\r\n                  <div class=\"remind_photo\">上传图片(小于500kb)</div>\r\n                </div>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\"> \r\n              <el-form-item label=\"行业\" prop=\"industry\">\r\n                <el-select v-model=\"toneFormData.industry\" placeholder=\"下拉菜单\" style=\"width: 240px\" :disabled=\"addDisabled\">\r\n                  <el-option\r\n                    v-for=\"industry in props.categories.industries\"\r\n                    :key=\"industry\"\r\n                    :label=\"industry\"\r\n                    :value=\"industry\"\r\n                  />\r\n                </el-select>\r\n              </el-form-item> \r\n              <el-form-item label=\"性别\" prop=\"gender\">\r\n                <el-select v-model=\"toneFormData.gender\" placeholder=\"下拉菜单\" style=\"width: 240px\" :disabled=\"addDisabled\">\r\n                  <el-option label=\"男性\" value=\"male\">\r\n                  </el-option>\r\n                  <el-option label=\"女性\" value=\"female\">\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item> \r\n              <el-form-item label=\"参考音频\" prop=\"reference_voice_id\" class=\"refer-Audio\">\r\n                <el-upload\r\n                  :disabled=\"addDisabled\"\r\n                  action=\"/api/file/upload\"\r\n                  ref=\"referAudioUploadRef\"\r\n                  :file-list=\"toneFormData.referenceVoiceList\"\r\n                  :http-request=\"handlReferAudioUpload\"\r\n                  :before-upload=\"handleBeforeReferUpload\"\r\n                  :on-remove=\"handleReferAudioRemove\"\r\n                  accept=\".mp3,.wav\"\r\n                  :limit=\"1\"\r\n                  :on-exceed=\"handleReferAudioExceed\"\r\n                >\r\n                  <span class=\"remind_style\">\r\n                    （ 支持mp3/wav格式，文件小于1mb，时长3-10s ）\r\n                  </span>\r\n                  <el-button type='primary' link :disabled=\"addDisabled\">上传音频</el-button>\r\n                </el-upload>\r\n              </el-form-item>  \r\n        </el-col>\r\n            <el-col :span=\"8\"> \r\n              <el-form-item label=\"情绪\" prop=\"emotion\">\r\n                <el-select v-model=\"toneFormData.emotion\" placeholder=\"下拉菜单\" style=\"width: 240px\" :disabled=\"addDisabled\">\r\n                  <el-option\r\n                    v-for=\"industry in props.categories.emotions\"\r\n                    :key=\"industry\"\r\n                    :label=\"industry\"\r\n                    :value=\"industry\"\r\n                  />\r\n                </el-select>\r\n              </el-form-item>  \r\n            </el-col>\r\n          </el-row>\r\n          <el-row :gutter=\"24\">\r\n            <el-col :span=\"5\" class=\"name-content\"> \r\n              <el-form-item label=\"音色名称\" prop=\"name\">\r\n                <el-input\r\n                  :disabled=\"addDisabled\"\r\n                  v-model=\"toneFormData.name\"\r\n                  placeholder=\"请输入\"\r\n                  maxlength=\"4\"\r\n                  show-word-limit\r\n                  clearable\r\n                  style=\"width: 150px;\"\r\n                />\r\n              </el-form-item>       \r\n            </el-col>\r\n            <el-col :span=\"18\"> \r\n              <el-form-item label=\"参考音频文本\" prop=\"referText\">\r\n                <el-input\r\n                  :disabled=\"addDisabled\"\r\n                  v-model=\"toneFormData.referText\"\r\n                  :rows=\"3\"\r\n                  type=\"textarea\"\r\n                  placeholder=\"请输入\"\r\n                  maxlength=\"100\"\r\n                  show-word-limit\r\n                />\r\n              </el-form-item>       \r\n            </el-col>\r\n          </el-row>\r\n          <el-row :gutter=\"24\">\r\n            <el-col :span=\"23\">\r\n              <div class=\"button-content\">\r\n                <el-button @click=\"handleCancel()\" :disabled=\"addLoading || addDisabled\">清空信息</el-button>\r\n                <el-button type=\"primary\" @click=\"handleSave()\" :disabled=\"addLoading || addDisabled\">保存</el-button>\r\n              </div>\r\n            </el-col>\r\n            </el-row>\r\n        </el-form>\r\n      </div>\r\n      <div class=\"first-line-content\">\r\n        <div>\r\n          1.上传复刻音频\r\n          <div class=\"first-item\">\r\n            <el-upload\r\n              class=\"first-uploader\"\r\n              action=\"/api/file/upload\"\r\n              ref=\"avatarUploadRef\"\r\n              :http-request=\"handleFirstUpload\"\r\n              :before-upload=\"handleBeforeFirstUpload\"\r\n              :on-success=\"handleFirstSuccess\"\r\n              :on-remove=\"handleFirstRemove\"\r\n              :file-list=\"firstList\"\r\n              accept=\".mp3\"\r\n              :limit=\"1\"\r\n              :disabled=\"firstDisabled\"\r\n            >\r\n            <template #file=\"{ file }\">\r\n              <div class=\"upload-file-item\" >\r\n                <img :src=\" musicIcon\" alt=\"filter\" class=\"upload-file-icon\" />\r\n                <span class=\"file-name\" :title=\"file.name\">{{ file.name }}</span>\r\n                <el-button type='primary' link @click=\"handleRemove(file)\" :disabled=\"firstDisabled\" class=\"remove-button\">X</el-button>\r\n              </div>\r\n            </template>\r\n            <div class=\"content-wrapper\" v-if=\"showFirstUpdate\">\r\n              <el-icon class=\"first-item-icon\"><UploadFilled /></el-icon>\r\n              <div class=\"remind-copy-update\">上传音频\r\n                <br><span class=\"remind-copy-update-span\">（大于1分钟，mp3格式，小于5mb）</span>\r\n              </div>\r\n            </div>\r\n            </el-upload>\r\n          </div>\r\n        </div>\r\n        <div class=\"second-content\">\r\n          2.语音处理\r\n          <div class=\"second-item\">\r\n            <el-button class=\"button-container\" @click=\"secondClick()\" type=\"primary\" :disabled=\"secondLoading || secondDisabled\">\r\n              一键处理\r\n            </el-button>\r\n            <div class=\"text-container\" v-loading=\"secondLoading\">\r\n              <div class=\"text-item\">\r\n                <span class=\"text-item-contant\">UVR-5去杂音</span>\r\n                <span>{{secondList.one}}</span>\r\n              </div>\r\n              <div class=\"text-item\">\r\n                <span class=\"text-item-contant\">语音切割</span>\r\n                <span>{{secondList.two}}</span>\r\n              </div>\r\n              <div class=\"text-item\">\r\n                <span class=\"text-item-contant\">ASR文本标注</span>\r\n                <span>{{secondList.three}}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"third-content\">\r\n        <el-collapse v-model=\"activeNames\" @change=\"handleChange\">\r\n          <el-collapse-item :disabled=\"thirdDisabled\" name=\"thirdPanel\" v-loading=\"thirdLoading\">\r\n            <template #title>\r\n              <div class=\"third-title\"> 3.语音标注（人工标注可更加精确；可跳过此步骤，直接训练！）</div>\r\n            </template>\r\n            <template #icon=\"{ isActive }\">\r\n              <span class=\"icon-ele\">\r\n                <img :src=\"dropDown\" :class=\"['icon-ele-img', { 'rotate': isActive }]\" />\r\n                {{ isActive ? \"收起菜单\": \"下拉菜单\"}}\r\n              </span>\r\n            </template>\r\n            <div>\r\n              <div class=\"third-content-button\">\r\n                <el-button type='primary' link :disabled=\"voiceLabelPage == Math.ceil(voiceLabelListRes.length / 10)\" @click=\"nextPageClick\">下一页</el-button>\r\n                <el-button type='primary' link :disabled=\"voiceLabelPage == 1\" @click=\"prePageClick\">上一页</el-button>\r\n                <el-button type='primary' link @click=\"saveLabelClick\">保存标注</el-button>\r\n              </div>\r\n              <el-row :gutter=\"24\" v-for=\"(item, index) in voiceLabelList\" :key=\"index\" class=\"third-content-row\">\r\n                <el-col :span=\"12\">\r\n                  <div class=\"voice-label-left\">\r\n                    {{ 'Text ' + index }}\r\n                    <el-input class=\"voice-label-left-text\" v-model=\"item.text\" :rows=\"3\" type=\"textarea\" placeholder=\"请输入\" />\r\n                  </div>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                  <div class=\"voice-label-right\">\r\n                    <audio \r\n                      :ref=\"el => { audioRefs[index] = el }\"\r\n                      :src=\"'/api' +item.file_url\" \r\n                      controlsList=\"nodownload\" \r\n                      controls \r\n                      class=\"voice-label-right-audio\"\r\n                      @play=\"handlePlay(index)\"\r\n                      @ended=\"handleEnded\"\r\n                      ></audio>\r\n                  </div>\r\n                </el-col>\r\n              </el-row>\r\n              <div class=\"no-more\" v-if=\"voiceLabelPage == Math.ceil(voiceLabelListRes.length / 10)\">没有更多了</div>\r\n            </div>\r\n          </el-collapse-item>\r\n        </el-collapse>\r\n      </div>\r\n      <div class=\"four-content\">\r\n        4.语音模型训练\r\n        <div class=\"four-item\">\r\n          <el-button class=\"button-container\" @click=\"fourClick()\" type=\"primary\" :disabled=\"fourDisabled || fourLoading\">开始训练</el-button>\r\n          <div class=\"text-container\" v-loading=\"fourLoading\">\r\n            <div class=\"text-item\">训练集格式化\r\n              <div><el-input v-model=\"fourList.one\" readonly/></div>\r\n            </div>\r\n            <div class=\"text-item\">SoVITS训练进程输出信息\r\n              <div><el-input v-model=\"fourList.two\" :rows=\"2\" type=\"textarea\" readonly /></div>\r\n            </div>\r\n            <div class=\"text-item\">GPT训练进程输出信息\r\n              <div><el-input v-model=\"fourList.three\" :rows=\"2\" type=\"textarea\" readonly/> </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport { ref, reactive, watch, onMounted, onUnmounted, computed, nextTick } from 'vue'\r\nimport { ElMessageBox, ElMessage } from 'element-plus'\r\nimport { UploadFilled } from '@element-plus/icons-vue'\r\nimport musicIcon from '@/assets/music-icon.png'\r\nimport dropDown from '@/assets/drop-down.png'\r\nimport {\r\n  postUploadFile,\r\n  getTaskDetail,\r\n  postTaskCreate,\r\n  postTaskExecute,\r\n  getTaskStart,\r\n  getAsrFileReview,\r\n  postAsrFileUpdate,\r\n  getTaskstop\r\n} from '@/service/speech'\r\nconst props = defineProps({\r\n  categories: {\r\n    type: Object,\r\n    required: true,\r\n  }\r\n})\r\nconst emit = defineEmits(['jumpToPerson'])\r\nconst intervalEcho = ref(3000) // 轮询间隔时间，单位为毫秒\r\nconst maxRetriesEcho = ref(3) // 最大重试次数，防止无限轮询\r\nlet attemptEcho = ref(0)\r\nconst timerId = ref(null) //用于保存定时器 ID\r\nonMounted(() => {\r\n  clearLoading.value = true\r\n  getEcho()\r\n})\r\nonUnmounted(() => {\r\n  pollStatusEcho.value = false\r\n  clearTimeout(timerId.value)\r\n})\r\n// 新增模块loading\r\nconst addLoading = ref(false)\r\nconst secondLoading = ref(false)\r\nconst thirdLoading = ref(false)\r\nconst fourLoading = ref(false)\r\nconst addAvataLoading = ref(false)\r\nconst clearLoading = ref(false)\r\nconst showFirstUpdate = ref(true)\r\nconst addDisabled = ref(false)\r\nconst firstDisabled = ref(true)\r\nconst secondDisabled = ref(true)\r\nconst thirdDisabled = ref(true)\r\nconst fourDisabled = ref(true)\r\nlet toneFormData = reactive({\r\n  avatar_id: '',\r\n  avatar: '',\r\n  industry: '',\r\n  audition_file_id: '',\r\n  auditionFileList: [],\r\n  reference_voice_id: '',\r\n  referenceVoiceList: [],\r\n  gender: '',\r\n  emotion: '',\r\n  name: '',\r\n  referText: '',\r\n})\r\nconst paramsForm = new FormData()\r\nconst toneForm = ref()\r\nconst listenAudioUploadRef = ref()\r\nconst firstList = ref([])\r\nconst secondList = reactive({\r\n  one: \"\",\r\n  two: \"\",\r\n  three: \"\",\r\n})\r\nconst fourList = reactive({\r\n  one: \"\",\r\n  two: \"\",\r\n  three: \"\",\r\n})\r\n\r\nconst formRules = {\r\n  avatar_id: [{ required: true, message: '请上传头像', trigger: 'change' }],\r\n  name: [{ required: true, message: '请输入名称', trigger: 'change' }],\r\n  gender: [{ required: true, message: '请选择性别', trigger: 'change' }],\r\n  industry: [{ required: true, message: '请选择行业', trigger: 'change' }],\r\n  emotion: [{ required: true, message: '请选择情绪', trigger: 'change' }],\r\n  // audition_file_id: [{ required: true, message: '请上传试听音频', trigger: 'change' }],\r\n  reference_voice_id: [{ required: true, message: '请上传参考音频', trigger: 'change' }],\r\n  referText: [{ required: true, message: '请输入参考文本', trigger: 'change' }],\r\n}\r\n\r\nconst handleBeforeAvatarUpload = async(file) => {\r\n    // 检查文件类型\r\n    const validTypes = ['image/jpeg', 'image/png', 'image/gif']\r\n  if (!validTypes.includes(file.type)) {\r\n    ElMessage.error('只能上传 JPG, JPEG, PNG 或 GIF 格式的图片')\r\n    return false\r\n  }\r\n  // 检查文件大小（500KB = 512000 bytes）\r\n  const maxSize = 500 *1024\r\n  if (file.size > maxSize) {\r\n    ElMessage.error('图片大小不能超过 500KB')\r\n    return false\r\n  }\r\n  return true;\r\n}\r\n\r\nconst handleBeforeListenUpload = async(file) => {\r\n  const validTypes = ['audio/wav','audio/mpeg']\r\n  // 检查文件类型\r\n    if (!validTypes.includes(file.type)) {\r\n    ElMessage.error('只能上传 mp3/wav格式的文件！')\r\n    return false\r\n  }\r\n  //检查文件大小\r\n  const maxSize = 1024 * 1024 * 2\r\n  if (file.size > maxSize) {\r\n    ElMessage.error('文件大小不能超过 2mb')\r\n    return false\r\n  }\r\n  return true;\r\n}\r\n\r\nconst handleBeforeReferUpload = async(file) => {\r\n  const validTypes = ['audio/wav','audio/mpeg']\r\n  // 检查文件类型\r\n    if (!validTypes.includes(file.type)) {\r\n    ElMessage.error('只能上传 mp3/wav格式的文件！')\r\n    return false\r\n  }\r\n  //检查文件大小\r\n  const maxSize = 1024 * 1024 \r\n  if (file.size > maxSize) {\r\n    ElMessage.error('文件大小不能超过 1mb')\r\n    return false\r\n  }\r\n  // 检查文件时间长度\r\n  try {\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const audioContext = new AudioContext();\r\n    const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);\r\n    const duration = audioBuffer.duration;\r\n    const maxDuration = 10;\r\n    const minDuration = 3;\r\n    if (duration > maxDuration) {\r\n      ElMessage.error(`音频持续时间不能超过 ${maxDuration} 秒`);\r\n      return false;\r\n    }else if(duration < minDuration){\r\n      ElMessage.error(`音频持续时间不能小于 ${minDuration} 秒`);\r\n      return false;\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('音频时长检测出错，请检查文件是否损坏');\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\nconst handleBeforeFirstUpload = async(file) => {\r\n  // firstList.value = []\r\n  showFirstUpdate.value = false\r\n  const validTypes = ['audio/mpeg']\r\n  // 检查文件类型\r\n    if (!validTypes.includes(file.type)) {\r\n    ElMessage.error('只能上传 mp3格式的文件！')\r\n    return false\r\n  }\r\n  //检查文件大小\r\n  const maxSize = 1024 * 1024 * 5\r\n  if (file.size > maxSize) {\r\n    ElMessage.error('文件大小不能超过 5mb')\r\n    return false\r\n  }\r\n  //检查文件时间长度\r\n  const arrayBuffer = await file.arrayBuffer();\r\n  const audioContext = new AudioContext(); // 使用标准的 AudioContext\r\n  const audioBuffer = await audioContext.decodeAudioData(arrayBuffer)\r\n  const duration = audioBuffer.duration;\r\n  const maxDuration = 60\r\n  if (duration < maxDuration) {\r\n    ElMessage.error(`音频持续时间不能小于 ${maxDuration} 秒`)\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\nconst handleAvatarUpload = async (options) => {\r\n  addAvataLoading.value = true\r\n  const { file, onSuccess, onError } = options\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  try {\r\n    const response = await postUploadFile(form)\r\n    if (response.code === 0) {\r\n      toneFormData.avatar_id = response.data.file_id\r\n      ElMessage.success('头像上传成功!')\r\n      toneForm.value.validateField(['avatar_id'])\r\n      paramsForm.set('avatar', file)\r\n      addAvataLoading.value = false\r\n    } else {\r\n      addAvataLoading.value = false\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('头像上传失败!')\r\n    addAvataLoading.value = false\r\n  }\r\n}\r\nconst handlReferAudioUpload = async (options) => {\r\n  const { file, onSuccess, onError } = options\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  try {\r\n    const response = await postUploadFile(form)\r\n    if (response.code === 0) {\r\n      toneFormData.reference_voice_id = response.data.file_id\r\n      onSuccess(response.data, file)\r\n      ElMessage.success('参考音频上传成功!')\r\n      toneForm.value.validateField(['reference_voice_id'])\r\n      paramsForm.set('reference_voice', file)\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('参考音频上传失败!')\r\n  }\r\n}\r\nconst handlListenAudioUpload = async (options) => {\r\n  const { file, onSuccess, onError } = options\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  try {\r\n    const response = await postUploadFile(form)\r\n    if (response.code === 0) {\r\n      toneFormData.audition_file_id = response.data.file_id\r\n      onSuccess(response.data, file)\r\n      ElMessage.success('试听音频上传成功!')\r\n      toneForm.value.validateField(['audition_file_id'])\r\n      paramsForm.set('audition_file', file)\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('试听音频上传失败!')\r\n  }\r\n}\r\nconst audiosFile = new FormData()\r\nconst handleFirstUpload = async (options) => {\r\n  const { file, onSuccess, onError } = options\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  try {\r\n    const response = await postUploadFile(form)\r\n    if (response.code === 0) {\r\n      onSuccess(response.data, file)\r\n      ElMessage.success('复刻音频上传成功!')\r\n      addDisabled.value = true\r\n      secondDisabled.value = false\r\n      audiosFile.set('audios',file)\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    onError(error)\r\n    ElMessage.error('复刻音频上传失败!')\r\n  }\r\n}\r\n\r\nconst handleListenAudioExceed = async (files, fileList) => {\r\n  const newFile = files[0];\r\n  try {\r\n    const check =  await handleBeforeListenUpload(newFile)\r\n    if(check){\r\n      await handlListenAudioUpload({\r\n        file: newFile,\r\n        onSuccess: (response) => {\r\n          toneFormData.auditionFileList = [newFile]\r\n        },\r\n        onError: (error) => {\r\n          ElMessage.error('上传失败')\r\n        },\r\n      })\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('处理文件时出错');\r\n  }\r\n}\r\n\r\nconst handleReferAudioExceed = async(files, fileList) => {\r\n  const newFile = files[0];\r\n  try {\r\n    // 先执行预处理\r\n    const check = await handleBeforeReferUpload(newFile);\r\n    if(check){\r\n      await handlReferAudioUpload({\r\n        file: newFile,\r\n        onSuccess: (response) => {\r\n          toneFormData.referenceVoiceList = [newFile];\r\n        },\r\n        onError: (error) => {\r\n          // console.error('上传失败', error);\r\n          ElMessage.error('上传失败');\r\n        },\r\n      })\r\n    }\r\n  } catch (error) {\r\n    // console.error('处理文件时出错:', error);\r\n    ElMessage.error('处理文件时出错');\r\n  }\r\n}\r\n\r\nconst handleAvatarSuccess = (response, file) => {\r\n  toneFormData.avatar = URL.createObjectURL(file.raw)\r\n}\r\n\r\nconst handleFirstSuccess = (response, file, fileList) => {\r\n  firstList.value = fileList\r\n}\r\nconst handleReferAudioRemove = (uploadFile, uploadFiles) => {\r\n  toneForm.value.validateField(['reference_voice_id'])\r\n}\r\n\r\nconst handleRemove = (file) => {\r\n  firstList.value = []\r\n  showFirstUpdate.value = true\r\n  secondDisabled.value = true\r\n}\r\nconst handleFirstRemove = (file,fileList) => {\r\n  firstList.value = fileList\r\n  showFirstUpdate.value = true\r\n  secondDisabled.value = true\r\n}\r\n\r\nconst handleListenAudioRemove = (uploadFile, uploadFiles) => {\r\n  toneFormData.audition_file_id = ''\r\n  toneForm.value.validateField(['audition_file_id'])\r\n}\r\nconst pollStatusEcho = ref(true)\r\nconst getEcho = async() => {\r\n  await getTaskDetail()\r\n  .then((res) => {\r\n    if (res.code === 0) {\r\n      clearLoading.value = false\r\n      const resData = res.data ?? ''\r\n      // 轮询结束\r\n      if(resData == ''){\r\n        pollStatusEcho.value = false\r\n        secondLoading.value = false\r\n        fourLoading.value = false\r\n      }\r\n      toneFormData.id = resData.id ? resData.id : null\r\n      toneFormData.avatar_id = resData.avatar_id ? resData.avatar_id : \"\"\r\n      toneFormData.avatar = resData.avatar_url ? \"/api\" + resData.avatar_url : \"\"\r\n      toneFormData.name = resData.name ? resData.name : \"\"\r\n      toneFormData.industry = resData.industry ? resData.industry : \"\"\r\n      toneFormData.audition_file_id = resData.audition_id ? resData.audition_id : \"\"\r\n      toneFormData.reference_voice_id = resData.reference_id ? resData.reference_id : \"\"\r\n      toneFormData.gender = resData.gender ? resData.gender : \"\"\r\n      toneFormData.emotion = resData.emotion ? resData.emotion : \"\"\r\n      toneFormData.referText = resData.reference_text ? resData.reference_text : \"\"\r\n      toneFormData.auditionFileList = resData.audition_id ? [{\r\n        uid: resData.audition_id ? resData.audition_id : '',\r\n        name: resData.audition_name ? resData.audition_name : '',\r\n        status: 'done',\r\n        url: resData.audition_url ? resData.audition_url : \"\"\r\n      }] : []\r\n      toneFormData.referenceVoiceList = resData.reference_id ? [{\r\n        uid: resData.reference_id ? resData.reference_id : '',\r\n        name: resData.reference_name ? resData.reference_name : '',\r\n        status: 'done',\r\n        url: resData.reference_url ? resData.reference_url : \"\"\r\n      }] : []\r\n      // 到1.上传复刻视频了\r\n      if(resData.upload_file_url && resData.upload_file_url !== \"\"){\r\n        addDisabled.value = true\r\n        showFirstUpdate.value = false\r\n        if(firstList.value.length == 0){\r\n          firstList.value = resData.upload_file_url ? [{\r\n            name: resData.upload_file_name ? resData.upload_file_name : '',\r\n            status: 'done',\r\n            url: resData.upload_file_url ? resData.upload_file_url : \"\"\r\n          }] : []\r\n        }\r\n      }else if( resData.id && !resData.upload_file_url ){\r\n        firstList.value = []\r\n        firstDisabled.value = false\r\n        showFirstUpdate.value = true\r\n      } else {\r\n        //清空操作,相关操作权限控制\r\n        firstList.value = []\r\n        addDisabled.value = false\r\n        secondLoading.value = false\r\n        fourLoading.value = false\r\n        firstDisabled.value = true\r\n        showFirstUpdate.value = true\r\n        secondDisabled.value = true\r\n        thirdDisabled.value = true\r\n        fourDisabled.value = true\r\n      }\r\n      // 到2.语音处理了,先清空脏数据\r\n      secondList.one = ''\r\n      secondList.two = ''\r\n      secondList.three = ''\r\n      fourList.one = ''\r\n      fourList.two = ''\r\n      fourList.three = ''\r\n      if(resData.step_list && Object.keys(resData.step_list).length > 0){\r\n        firstDisabled.value = true\r\n        stepListToShow(Object.keys(resData.step_list).length, resData.step_list)\r\n      }else{\r\n        secondLoading.value = false\r\n        fourLoading.value = false\r\n      }\r\n    } else {\r\n      // 接口返回报错\r\n      ElMessage.error(res.message)\r\n      clearLoading.value = false\r\n    }\r\n  })\r\n  .catch((error) => {\r\n    ElMessage.error(error)\r\n    clearLoading.value = false\r\n  })\r\n}\r\nconst stepListToShow = (lengths,stepList,) => {\r\n  secondList.one = stepListToText(stepList[0])\r\n  secondList.two = stepListToText(stepList[1])\r\n  secondList.three = stepListToText(stepList[2])\r\n  fourList.one = stepListToText(stepList[5])\r\n  fourList.two = stepListToText(stepList[9],\"one\")\r\n  fourList.three = stepListToText(stepList[10],\"two\")\r\n  if (lengths <= 3) {\r\n    if(Object.values(stepList).includes(\"progressing\")){\r\n      secondDisabled.value = true\r\n      secondLoading.value = true\r\n      // 开始轮询\r\n      attemptEcho.value ++\r\n      timerId.value = setTimeout(() => getEcho(), intervalEcho.value)\r\n    }else if ( stepList[2] == \"success\") {\r\n      ElMessage.success('一键处理成功!')\r\n      secondLoading.value = false\r\n      secondDisabled.value = true\r\n      thirdDisabled.value = false\r\n      fourDisabled.value = false\r\n    } else {\r\n      secondDisabled.value = false\r\n      secondLoading.value = false\r\n    }\r\n  }else if (lengths == 4  && \"3\" in stepList) {\r\n    secondDisabled.value = true\r\n    thirdDisabled.value = false\r\n    fourDisabled.value = false\r\n  }else if(lengths >= 4  && lengths <= 8 ){\r\n    // 将对象的值转换为数组\r\n    const values = Object.values(stepList);\r\n    // 检查索引为 3 的数据是否存在，如果存在则从数组中移除\r\n    if (stepList.hasOwnProperty(3)) {\r\n        const index = values.findIndex(value => value === stepList[3]);\r\n        if (index!== -1) {\r\n            values.splice(index, 1);\r\n        }\r\n    }\r\n    if (values.includes(\"progressing\")) {\r\n      // 开始轮询\r\n      fourLoading.value = true\r\n      fourDisabled.value = true\r\n      attemptEcho.value ++\r\n      timerId.value = setTimeout(() => getEcho(), intervalEcho.value)\r\n    } else if(stepList[20] == \"success\"){\r\n      fourLoading.value = false\r\n      // 弹出弹窗, 训练完成\r\n      ElMessageBox.confirm(\r\n        `<div style=\"font-size: 18px; margin: 20px 40px 0;\">训练完成！</div>\r\n          <div style=\"padding: 20px 40px;\">请在私有语音库中查看</div>`,\r\n      {\r\n        dangerouslyUseHTMLString: true,\r\n        confirmButtonText: '确认',\r\n        confirmButtonClass: 'red-button', // 应用自定义按钮类\r\n        showCancelButton: false, // 如果不需要取消按钮，可以隐藏\r\n        beforeClose: (action, instance, done) => {\r\n          if (action === 'close') {\r\n            // 当用户点击右上角的 x 时执行的操作\r\n            done()\r\n            emit('jumpToPerson')\r\n          } else {\r\n            // 其他关闭方式，如点击确认按钮\r\n            done()\r\n            emit('jumpToPerson')\r\n          }\r\n        },\r\n      })\r\n      .then (async () => {\r\n      // 跳转到私有语音库\r\n        emit('jumpToPerson')\r\n      })\r\n    }else {\r\n      // 4有失败返回,放开操作权限\r\n      fourDisabled.value = false\r\n      fourLoading.value = false\r\n    }\r\n  }\r\n}\r\n// 数据转换处理\r\nfunction stepListToText(item, type) {\r\n  if (type === \"one\" && item === 'success') {\r\n      return \"SoVITS训练完成\";\r\n  } else if (type === \"two\" && item === 'success') {\r\n      return \"GPT训练完成\";\r\n  }\r\n  return getBaseStatusText(item);\r\n}\r\n\r\n// 封装一个基础的状态文本映射函数\r\nfunction getBaseStatusText(item) {\r\n  switch (item) {\r\n      case 'waiting':\r\n          return \"等待中...\";\r\n      case 'progressing':\r\n          return \"处理中...\";\r\n      case 'success':\r\n          return \"已完成\";\r\n      case 'failed':\r\n          return \"处理失败\";\r\n      case 'stopped':\r\n          return \"已停止\";\r\n      default:\r\n          return '';\r\n  }\r\n}\r\n// 清空语音复刻信息\r\nconst handleCancelRepro = async() => {\r\n  if( clearLoading.value == true ){\r\n    ElMessage.warning('正在清空中...')\r\n    return false\r\n  }\r\n  ElMessageBox.confirm(\r\n    `<div style=\"font-size: 18px; margin: 20px 40px 0;\">确定要清空吗？</div>\r\n      <div style=\"padding: 20px 40px;\">该操作会中断正在复刻的语音</div>`,\r\n  {\r\n    dangerouslyUseHTMLString: true,\r\n    confirmButtonText: '确定',\r\n    cancelButtonText: '取消',\r\n    // type: 'warning',\r\n    confirmButtonClass: 'red-button-class',\r\n  })\r\n  .then(async () => {\r\n    try {\r\n      clearLoading.value = true\r\n      const response = await getTaskstop()\r\n      if (response.code === 0) {\r\n        clearLoading.value = false\r\n        ElMessage.success('清空成功!')\r\n        clearLoading.value = true\r\n        toneForm.value.resetFields()\r\n        getEcho()\r\n      } else {\r\n        clearLoading.value = false\r\n        throw new Error(response.message)\r\n      }\r\n    } catch (error) {\r\n      clearLoading.value = false\r\n      // 测试数据\r\n      ElMessage.error('清空失败!')\r\n    }\r\n  })\r\n  .catch(() => {\r\n    // 取消\r\n  })\r\n}\r\n// 清空新增信息\r\nconst handleCancel = async() => {\r\n  toneFormData.avatar = null\r\n  toneFormData.auditionFileList = []\r\n  toneFormData.referenceVoiceList = []\r\n  toneForm.value.resetFields()\r\n}\r\n// 确认保存按钮\r\nconst handleSave = async() => {\r\n  toneForm.value.validate( async(valid, fields) => {\r\n    if (valid) {\r\n      ElMessageBox.confirm(\r\n        `<div style=\"font-size: 18px; margin: 20px 40px 0;\">确定要保存该音色？</div>\r\n          <div style=\"padding: 20px 40px;\">保存后复刻期间音色不可更改！</div>`,\r\n      {\r\n        dangerouslyUseHTMLString: true,\r\n        confirmButtonText: '确定保存',\r\n        cancelButtonText: '取消',\r\n        confirmButtonClass: 'red-button', // 应用自定义按钮类\r\n      })\r\n      .then(async () => {\r\n        if(toneFormData.id !== null && toneFormData.id !== undefined ){\r\n          // 修改音色\r\n          paramsForm.set('id', toneFormData.id)\r\n        }\r\n        paramsForm.set('name', toneFormData.name)\r\n        paramsForm.set('industry', toneFormData.industry)\r\n        paramsForm.set('gender', toneFormData.gender)\r\n        paramsForm.set('emotion', toneFormData.emotion)\r\n        paramsForm.set('reference_voice_text', toneFormData.referText)\r\n        try {\r\n          addLoading.value = true\r\n          const response = await postTaskCreate(paramsForm)\r\n          if (response.code === 0) {\r\n            ElMessage.success('新增音色成功!')\r\n            addLoading.value = false\r\n            firstDisabled.value = false\r\n            // addDisabled.value = true\r\n          } else {\r\n            addLoading.value = false\r\n            ElMessage.error(response.message)\r\n          }\r\n        } catch (error) {\r\n          ElMessage.error('新增音色失败!')\r\n          addLoading.value = false\r\n        }\r\n      })\r\n      .catch(() => {\r\n        // 取消按钮\r\n      })\r\n    }\r\n  })\r\n}\r\nconst secondClick = async() => {\r\n  secondLoading.value = true\r\n  try {\r\n    const response = await postTaskExecute(audiosFile);\r\n    if (response.code === 0) {\r\n      // 接口返回成功,调用回显接口\r\n      setTimeout(() => getEcho(), 2000)\r\n    } else {\r\n      // 处理其他响应代码\r\n      ElMessage.error('发生错误，请稍后重试!');\r\n      secondLoading.value = false;\r\n      return;\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('发生错误，请稍后重试!');\r\n    secondLoading.value = false;\r\n    return;\r\n  }\r\n}\r\n// 语音标注\r\nconst activeNames = ref([])\r\nconst voiceLabelPage = ref(0)\r\nconst voiceLabelList = ref([])\r\nconst audioRefs = ref({})\r\nconst voiceLabelListRes = ref([])\r\nconst handleChange = async() => {\r\n  if(activeNames.value.length > 0 && voiceLabelList.value.length == 0){\r\n    // 调接口\r\n    try {\r\n      thirdLoading.value = true\r\n      const response = await getAsrFileReview()\r\n      if (response.code === 0) {\r\n        thirdLoading.value = false\r\n        voiceLabelListRes.value = response.data.data.list ?  response.data.data.list : []\r\n        voiceLabelList.value = voiceLabelListRes.value.slice(0, 10)\r\n        voiceLabelPage.value = 1\r\n      } else {\r\n        thirdLoading.value = false\r\n        throw new Error(response.message)\r\n      }\r\n    } catch (error) {\r\n      thirdLoading.value = false\r\n      voiceLabelPage.value = 1\r\n      // 测试数据\r\n      voiceLabelList.value = voiceLabelListRes.value.slice(0, 10)\r\n      ElMessage.error('语音标注获取数据失败!')\r\n    }\r\n  }\r\n}\r\n\r\n// 标注播放\r\nconst currentAudioIndex = ref(null)\r\nconst handlePlay = (playIndex) => {\r\n  if (currentAudioIndex.value !== null && currentAudioIndex.value !== playIndex) {\r\n    const previousAudio = audioRefs.value[currentAudioIndex.value];\r\n    if (previousAudio) {\r\n      previousAudio.pause();\r\n    }\r\n  }\r\n  // 更新当前播放的音频索引\r\n  currentAudioIndex.value = playIndex;\r\n}\r\nconst handleEnded = () => {\r\n  // 音频播放结束后，清除当前播放的索引\r\n  currentAudioIndex.value = null;\r\n}\r\nconst nextPageClick = () => {\r\n  voiceLabelPage.value ++\r\n  voiceLabelList.value = voiceLabelListRes.value.slice((voiceLabelPage.value -1 ) * 10, (voiceLabelPage.value) * 10)\r\n}\r\nconst prePageClick = () => {\r\n  voiceLabelPage.value --\r\n  voiceLabelList.value = voiceLabelListRes.value.slice((voiceLabelPage.value -1 ) * 10, (voiceLabelPage.value) * 10)\r\n}\r\nconst saveLabelClick = async() => {\r\n  try {\r\n    thirdLoading.value = true\r\n    const params = {\r\n      task_id: \"task_id\",\r\n      asr_data: {\r\n        data: {\r\n          list: voiceLabelListRes.value\r\n        }\r\n      }\r\n    }\r\n    const response = await postAsrFileUpdate(params)\r\n    if (response.code === 0) {\r\n      thirdLoading.value = false\r\n      ElMessage.success('保存标注成功!')\r\n    } else {\r\n      thirdLoading.value = false\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    thirdLoading.value = false\r\n    voiceLabelPage.value = 1\r\n    ElMessage.error('语音标注保存失败!')\r\n  }\r\n}\r\nconst fourClick = async() => {\r\n  // 收起语音标注\r\n  activeNames.value = []\r\n  try {\r\n    const response = await getTaskStart()\r\n    if (response.code === 0) {\r\n      getEcho()\r\n    } else {\r\n      // 处理其他响应代码\r\n      ElMessage.error(response.message)\r\n      fourLoading.value = false\r\n      return\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('发生错误，请稍后重试!')\r\n    fourLoading.value = false;\r\n    return\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n:deep(.el-form-item__content){\r\n  /* line-height: 20px !important; */\r\n}\r\n:deep(.el-form-item){\r\n  padding-bottom: 10px !important;\r\n  margin-bottom: 5px !important;\r\n}\r\n.speech-reproduction{\r\n  font-size: 22px;\r\n  box-sizing: border-box;\r\n  height: calc(100vh - 100px);\r\n  overflow-y: auto;\r\n  width: 60%;\r\n  scrollbar-width: thin; /* 设置滚动条宽度为“薄” */\r\n  scrollbar-color: #888 #f1f1f1; /* 设置滚动条滑块和轨道的颜色 */\r\n  padding:10px 20px; /* 预留空间给滚动条 */\r\n  border-radius: 5px;\r\n  background-color: #ffffff;\r\n  .cancel-repro{\r\n    display: flex;\r\n    .cancel-repro-button{\r\n      margin: 0 10px 10px auto;\r\n      width: 170px;\r\n    }\r\n  }\r\n  .add-title{\r\n    /* font-size: 20px; */\r\n    padding: 0 10px;\r\n  }\r\n  .add-model{\r\n    background-color: #ffffff;\r\n    padding: 10px 15px;\r\n    border-radius: 5px;\r\n    border: 2px solid #eceaea;\r\n    display: flex;\r\n    flex-direction: column;\r\n    .avatar-uploader .avatar_class {\r\n      width: 120px;\r\n      height: 120px;\r\n      display: block;\r\n      border-radius: 3px; \r\n    }\r\n    .avatar-uploader .el-upload {\r\n      border: 1px dashed var(--el-border-color);\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n      position: relative;\r\n      overflow: hidden;\r\n      transition: var(--el-transition-duration-fast);\r\n    }\r\n    :deep(.left-aligned-label .el-form-item__label) {\r\n      text-align: left !important; /* 左对齐标签 */\r\n      justify-content: flex-start !important;\r\n    }\r\n  }\r\n  .avatar-uploader{\r\n    margin: 10px 0 0 0;\r\n  }\r\n  .el-icon.avatar-uploader-icon {\r\n    font-size: 30px;\r\n    color: #8c939d;\r\n    width: 120px;\r\n    height: 120px;\r\n    text-align: center;\r\n    border: 2px solid #d9dbde; \r\n    border-radius: 3px; \r\n  }\r\n  .remind_photo{\r\n    font-size: 14px;\r\n    /* padding-top: 10px; */\r\n  }\r\n  .avatar-content{\r\n    display: flex;\r\n    justify-content: center;\r\n    min-width: 236px;\r\n  }\r\n  .remind_style{\r\n    font-size: 12px;\r\n  }\r\n  .listen-audio{\r\n    min-width: 400px;\r\n    padding-top: 15px;\r\n  }\r\n  .refer-Audio{\r\n    min-width: 500px;\r\n  }\r\n  .name-content{\r\n    min-width: 236px;\r\n    margin-top: 40px;\r\n  }\r\n  .button-content{\r\n    display: flex;\r\n    justify-content: flex-end; /* 将按钮容器对齐到右侧 */\r\n    gap: 10px; /* 按钮之间的间距 */\r\n    width: 100%;\r\n    padding: 5px;\r\n  }\r\n  .first-line-content{\r\n    display: flex;\r\n    margin-top: 10px;\r\n    .first-item{\r\n      width: 300px;\r\n      height: 200px;\r\n      margin-top: 10px;\r\n      border: 2px solid #eceaea; \r\n      border-radius: 10px; \r\n      margin-right: 100px;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      .first-item-icon{\r\n        font-size: 30px;\r\n        color: #8c939d;\r\n        text-align: center;\r\n        border-radius: 3px; \r\n      }\r\n      .content-wrapper {\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        gap: 10px; /* 子元素之间的间距 */\r\n      }\r\n      .remind-copy-update{\r\n        font-size: 16px;\r\n        text-align: center; /* 文本水平居中 */\r\n        .remind-copy-update-span{\r\n          font-size: 14px;\r\n        }\r\n      }\r\n    }\r\n    .second-content{\r\n      flex: 1;\r\n      .second-item {\r\n        margin-top: 10px;\r\n        display: flex;\r\n        align-items: stretch;\r\n        gap: 20px;\r\n        border-radius: 5px;\r\n        border: 2px solid #eceaea;\r\n        padding: 10px;\r\n        height: 200px;\r\n        background-color: #ffffff;\r\n      }\r\n      .text-container {\r\n        flex: 1;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        .text-item{\r\n          font-size: 18px;\r\n          border: 1px solid #ccc; \r\n          border-radius: 10px;\r\n          width: 100%;\r\n          padding: 10px;\r\n          display: flex;\r\n          justify-content: center;\r\n          height: 45px;\r\n          position: relative;\r\n          .text-item-contant{\r\n            position: absolute;\r\n            left: 10px;\r\n          }\r\n        }\r\n      }\r\n      .text-container div {\r\n        margin-bottom: 10px;\r\n      }\r\n      .text-container div:last-child {\r\n        margin-bottom: 0;\r\n      }\r\n    }\r\n  }\r\n  .third-content{\r\n    margin: 20px 0;\r\n    border-radius: 5px;\r\n    border: 2px solid #eceaea;\r\n    .third-title{\r\n      font-size: 24px;\r\n      font-weight: 540;\r\n    }\r\n    .third-content-button{\r\n      position: relative; /* 为伪元素提供定位上下文 */\r\n      padding-top: 10px; /* 可选：为容器上方添加内边距，避免内容与线重叠 */\r\n      margin: 10px;\r\n      .el-button{\r\n        font-size: 20px;\r\n      }\r\n    }\r\n    .third-content-button::before {\r\n      content: '';\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 1px;\r\n      background-color: #ccc;\r\n    }\r\n    .third-content-row{\r\n      \r\n    }\r\n    .no-more{\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n    .voice-label-left{\r\n      border: 2px solid #dbdbdb;\r\n      border-radius: 5px;\r\n      margin: 10px;\r\n      padding: 10px;\r\n      border: 1px solid #ccc;\r\n      padding: 10px;\r\n      height: 90%;\r\n      .voice-label-left-text{\r\n\r\n      }\r\n    }\r\n    .voice-label-right{\r\n      border: 2px solid #dbdbdb;\r\n      border-radius: 5px;\r\n      margin: 10px;\r\n      padding: 10px;\r\n      border: 1px solid #ccc;\r\n      padding: 10px;\r\n      height: 90%;\r\n      display: flex;\r\n      align-items: center;\r\n      .voice-label-right-audio {\r\n        width: 100%;\r\n      }\r\n    }\r\n  }\r\n  .four-content{\r\n    .four-item {\r\n      margin-top: 10px;\r\n      display: flex;\r\n      align-items: stretch;\r\n      gap: 20px;\r\n      border-radius: 5px;\r\n      border: 2px solid #eceaea;\r\n      padding: 10px;\r\n      height: 270px;\r\n      background-color: #ffffff;\r\n      .text-container{\r\n        flex: 1;\r\n      }\r\n    }\r\n  }\r\n  .first-uploader{\r\n    display: flex;\r\n  }\r\n  .upload-file-item{\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    .upload-file-icon{\r\n      width: 20px;\r\n      height: 20px;\r\n      margin-right: 5px;\r\n    }\r\n  }\r\n  .icon-ele{\r\n    margin: 0 8px 0 auto;\r\n    display: flex;\r\n    align-items: center;\r\n    .icon-ele-img{\r\n      width: 20px;\r\n      height: 20px;\r\n      display: block;\r\n      border-radius: 3px; \r\n      margin-right: 5px;\r\n    }\r\n    .rotate {\r\n      transform: rotate(180deg); /* 旋转180度 */\r\n    }\r\n  }\r\n  .file-name{\r\n    max-width: 200px;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    cursor: pointer;\r\n  }\r\n  .remove-button{\r\n    margin-left: 10px;\r\n    color: red;\r\n  }\r\n  .button-container {\r\n    display: flex;\r\n    align-items: center;\r\n    font-size: 18px;\r\n    padding: 0 20px;\r\n    border-radius: 10px;\r\n    height: 100%;\r\n  }\r\n}\r\n/* WebKit 浏览器滚动条样式 */\r\n.speech-reproduction::-webkit-scrollbar {\r\n  width: 8px; /* 设置滚动条的宽度 */\r\n}\r\n@media (max-width: 1680px) {\r\n  .speech-reproduction {\r\n    width: 80% !important;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    v-loading=\"isAudioLoading\"\r\n    :element-loading-text=\"isRemind\"\r\n    class=\"voice-synthesis-container h-full w-full\"\r\n  >\r\n    <el-tabs v-model=\"activeName\" class=\"demo-tabs\" @tab-click=\"handleClick\">\r\n      <el-tab-pane label=\"语音合成\" name=\"speechHC\"></el-tab-pane>\r\n      <el-tab-pane label=\"语音复刻\" name=\"speechFK\"></el-tab-pane>\r\n    </el-tabs>\r\n    <div v-if=\"activeName == 'speechHC'\" class=\"speech_synthesis_content\">\r\n      <div class=\"main-container\">\r\n        <!-- 左侧音色列表 -->\r\n        <div class=\"voice-list\">\r\n          <div class=\"voice-list-header\">\r\n            <h1 class=\"voice-list-title\">选择音色</h1>\r\n            <div class=\"language-select\">\r\n              <el-select v-model=\"filterConditions.isShare\" @change=\"handleshare\">\r\n                <el-option label=\"公共语音库\" :value=\"true\">公共语音库</el-option>\r\n                <el-option label=\"私有语音库\" :value=\"false\">私有语音库</el-option>\r\n              </el-select>\r\n            </div>\r\n          </div>\r\n          <div class=\"filter-bar\">\r\n            <span class=\"filter-buttons-title\"> 性别:</span>\r\n            <div class=\"filter-buttons\">\r\n              <el-button\r\n                size=\"small\"\r\n                class=\"filter-button\"\r\n                :class=\"{ active: selectedGender === null }\"\r\n                @click=\"handleGenderChange(null)\"\r\n                >全部</el-button\r\n              >\r\n              <el-button\r\n                size=\"small\"\r\n                class=\"filter-button\"\r\n                :class=\"{ active: selectedGender === 'male' }\"\r\n                @click=\"handleGenderChange('male')\"\r\n                >男性</el-button\r\n              >\r\n              <el-button\r\n                size=\"small\"\r\n                class=\"filter-button\"\r\n                :class=\"{ active: selectedGender === 'female' }\"\r\n                @click=\"handleGenderChange('female')\"\r\n                >女性</el-button\r\n              >\r\n            </div>\r\n          </div>\r\n          <div class=\"filter-bar\">\r\n            <span class=\"filter-buttons-title\"> 行业:</span>\r\n            <div class=\"filter-buttons\">\r\n              <el-button\r\n                size=\"small\"\r\n                class=\"filter-button\"\r\n                :class=\"{ active: filterConditions.industry_condition === null }\"\r\n                @click=\"handleIndustryClick(null)\"\r\n                >全部</el-button\r\n              >\r\n              <el-button\r\n                size=\"small\"\r\n                class=\"filter-button\"\r\n                v-for=\"industry in categories.industries\"\r\n                :key=\"industry\"\r\n                :class=\"{ active: filterConditions.industry_condition === industry }\"\r\n                @click=\"handleIndustryClick(industry)\"\r\n                >{{ industry }}</el-button\r\n              >\r\n            </div>\r\n          </div>\r\n          <div class=\"filter-bar\">\r\n            <span class=\"filter-buttons-title\"> 情绪:</span>\r\n            <div class=\"filter-buttons\">\r\n              <el-button\r\n                size=\"small\"\r\n                class=\"filter-button\"\r\n                :class=\"{ active: filterConditions.emotion_condition === null }\"\r\n                @click=\"handleEmotionClick(null)\"\r\n                >全部</el-button\r\n              >\r\n              <el-button\r\n                size=\"small\"\r\n                class=\"filter-button\"\r\n                v-for=\"emotion in categories.emotions\"\r\n                :key=\"emotion\"\r\n                :class=\"{ active: filterConditions.emotion_condition === emotion }\"\r\n                @click=\"handleEmotionClick(emotion)\"\r\n                >{{ emotion }}</el-button\r\n              >\r\n            </div>\r\n          </div>\r\n          <div class=\"voice-list-content\">\r\n            <div class=\"voice-grid\">\r\n              <div\r\n                class=\"voice-item\"\r\n                v-for=\"item in visibleCards\"\r\n                :key=\"item.id\"\r\n                @click=\"selectVoice(item)\"\r\n                :class=\"{ active: selectedVoice && selectedVoice.id === item.id }\"\r\n              >\r\n                <div class=\"corner-label hot-label\" v-if=\"item.status == 'hot' && filterConditions.isShare == true\">HOT</div>\r\n                <div class=\"corner-label new-label\" v-else-if=\"item.status == 'new' && filterConditions.isShare == true\">NEW</div>\r\n                <div\r\n                  class=\"edit-button\"\r\n                  @click.stop=\"editVoice(item)\"\r\n                  v-if=\"filterConditions.isShare == false\"\r\n                >\r\n                  编辑\r\n                </div>\r\n                <img :src=\"item.avatar\" :alt=\"item.name\" class=\"voice-avatar\" />\r\n                <div class=\"voice-name\">{{ item.emotion }}-{{ item.name }}</div>\r\n                <div\r\n                  class=\"play-buttons\"\r\n                  v-if=\"selectedVoice && selectedVoice.id === item.id\"\r\n                  @click.stop=\"togglePlayPause(item.id)\"\r\n                >\r\n                  <template v-if=\"isPlaying(item.id)\">\r\n                    <img :src=\"pauseImg\" alt=\"pause\" />\r\n                  </template>\r\n                  <template v-else>\r\n                    <img :src=\"playImg\" alt=\"play\" />\r\n                  </template>\r\n                </div>\r\n                <audio\r\n                  :ref=\"(el) => (audioElements[item.id] = el)\"\r\n                  :src=\"item.audition_file_url\"\r\n                  preload=\"none\"\r\n                  @ended=\"handleEnded(item.id)\"\r\n                ></audio>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 中间文本框 -->\r\n        <div class=\"text-editor\">\r\n          <div class=\"editor-header\">\r\n            <h1 class=\"editor-title\">语音合成</h1>\r\n            <div class=\"language-select\">\r\n              <el-select v-model=\"settings.language\" placeholder=\"请选择语种\">\r\n                <el-option label=\"中文\" value=\"中文\"></el-option>\r\n                <el-option label=\"英文\" value=\"英文\"></el-option>\r\n                <el-option label=\"日文\" value=\"日文\"></el-option>\r\n                <el-option label=\"粤语\" value=\"粤语\"></el-option>\r\n                <el-option label=\"中英混合\" value=\"中英混合\"></el-option>\r\n                <el-option label=\"日英混合\" value=\"日英混合\"></el-option>\r\n                <el-option label=\"粤英混合\" value=\"粤英混合\"></el-option>\r\n                <el-option label=\"韩英混合\" value=\"韩英混合\"></el-option>\r\n                <el-option label=\"多语种混合\" value=\"多语种混合\"></el-option>\r\n              </el-select>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"speed-control\">\r\n            <div class=\"speed-label\">语速调整</div>\r\n            <div class=\"speed-slider-container\">\r\n              <el-slider v-model=\"settings.speed\" :min=\"0.6\" :max=\"1.65\" :step=\"0.05\" />\r\n              <div class=\"speed-value\">{{ settings.speed }}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"textarea-container\">\r\n            <div class=\"textarea-label\">\r\n              <div class=\"label-text\">\r\n                <font-awesome-icon icon=\"comment-dots\" />\r\n                输入要合成的语音文字\r\n              </div>\r\n              <div class=\"char-count\">{{ currentCount }} / 6000</div>\r\n            </div>\r\n            <textarea\r\n              placeholder=\"请输入文本进行语音合成...\"\r\n              v-model=\"inputText\"\r\n              @input=\"updateCount\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div class=\"action-buttons\">\r\n            <button class=\"action-button primary-button\" @click=\"synthesizeVoice\">\r\n              <font-awesome-icon icon=\"music\" />\r\n              生成音频\r\n            </button>\r\n            <button class=\"action-button secondary-button\" @click=\"synthesizeVoiceAndSRT\">\r\n              <font-awesome-icon icon=\"closed-captioning\" />\r\n              生成音频和SRT\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 右侧任务列表 -->\r\n        <div class=\"task-list\">\r\n          <div class=\"task-list-header\">\r\n            <h2 class=\"task-list-title\">\r\n              <i class=\"fas fa-tasks\"></i>\r\n              合成语音列表\r\n            </h2>\r\n          </div>\r\n\r\n          <div class=\"task-list-content\">\r\n            <div v-if=\"synthesizedVoices.length\">\r\n              <div class=\"task-group\" v-for=\"(voice, index) in synthesizedVoices\" :key=\"index\">\r\n                <div class=\"task-header\">\r\n                  <div class=\"task-info\">\r\n                    <div class=\"task-name\">\r\n                      {{ voice.industry }}-{{ voice.emotion }}-{{ voice.name }}-{{\r\n                        voice.gender == 'male' ? '男' : '女'\r\n                      }}\r\n                    </div>\r\n                    <div class=\"task-date\">{{ voice.create_time }}</div>\r\n                  </div>\r\n                  <div class=\"task-voice\">\r\n                    <span>{{ voice.emotion }}-{{ voice.name }}</span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"task-content\">\r\n                  <div v-if=\"voice.status === 'pending'\" class=\"task-preview\">\r\n                    <el-icon class=\"is-loading\">\r\n                      <Loading />\r\n                    </el-icon>\r\n                    语音生成中......\r\n                  </div>\r\n                  <audio\r\n                    v-else-if=\"voice.status === 'success'\"\r\n                    :ref=\"(el) => (audioElements[voice.id] = el)\"\r\n                    class=\"task-preview\"\r\n                    :src=\"voice.audition_file_url\"\r\n                    controlsList=\"nodownload\"\r\n                    controls\r\n                    @play=\"handlePlay(voice.id)\"\r\n                    @ended=\"handleEnded(voice.id, 'voice')\"\r\n                  />\r\n                  <div class=\"task-actions\">\r\n                    <div class=\"dropdown\">\r\n                      <div\r\n                        class=\"dropdown-button\"\r\n                        @click=\"voice.status === 'success' ? toggleDropdown(voice) : null\"\r\n                        :style=\"{\r\n                          opacity: voice.status === 'success' ? 1 : 0.5,\r\n                          cursor: voice.status === 'success' ? 'pointer' : 'not-allowed'\r\n                        }\"\r\n                      >\r\n                        <font-awesome-icon icon=\"download\" />\r\n                        下载\r\n                      </div>\r\n                      <div class=\"dropdown-content\" :class=\"{ show: isDropdownVisible[voice.id] }\">\r\n                        <div class=\"dropdown-item\" @click=\"downloadFile(voice, 'voice')\">\r\n                          <font-awesome-icon icon=\"music\" /><span>下载音频</span>\r\n                        </div>\r\n                        <div\r\n                          v-if=\"voice.srt_file_path && voice.srt_file_path !== ''\"\r\n                          class=\"dropdown-item\"\r\n                          @click=\"downloadFile(voice, 'srt')\"\r\n                        >\r\n                          <font-awesome-icon icon=\"file-alt\" /><span>下载SRT</span>\r\n                        </div>\r\n                        <div\r\n                          v-if=\"voice.srt_file_path && voice.srt_file_path !== ''\"\r\n                          class=\"dropdown-item\"\r\n                          @click=\"downloadFile(voice, 'all')\"\r\n                        >\r\n                          <font-awesome-icon icon=\"archive\" /><span>下载全部</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div\r\n                      class=\"task-action srt\"\r\n                      v-if=\"voice.reCreate\"\r\n                      @click=\"createSRT(voice, index)\"\r\n                    >\r\n                      <font-awesome-icon icon=\"closed-captioning\" />\r\n                      <span>重新生成SRT</span>\r\n                    </div>\r\n                    <div\r\n                      v-else-if=\"!voice.srt_file_path || voice.srt_file_path == ''\"\r\n                      class=\"task-action srt\"\r\n                      :class=\"{ 'srt-progress': isGenerating[voice.id] }\"\r\n                      :style=\"{\r\n                        opacity: voice.status === 'success' ? 1 : 0.5,\r\n                        cursor: voice.status === 'success' ? 'pointer' : 'not-allowed'\r\n                      }\"\r\n                      @click=\"voice.status === 'success' ? createSRT(voice, index) : null\"\r\n                    >\r\n                      <!-- 当正在生成时，显示进度条和进度文本 -->\r\n                      <template v-if=\"isGenerating[voice.id]\">\r\n                        <div\r\n                          class=\"srt-progress-bar\"\r\n                          :style=\"{ width: progress[voice.id] + '%' }\"\r\n                        ></div>\r\n                        <div\r\n                          class=\"srt-progress-text\"\r\n                          v-html=\"progressText[voice.id]\"\r\n                          @click.stop=\"\r\n                            ;(progressText[voice.id] || '').trim() == '生成失败'\r\n                              ? reCreateSRT(voice)\r\n                              : null\r\n                          \"\r\n                        ></div>\r\n                      </template>\r\n                      <!-- 未生成时，显示图标和按钮文本 -->\r\n                      <template v-else>\r\n                        <font-awesome-icon icon=\"closed-captioning\" />\r\n                        <span>生成SRT</span>\r\n                      </template>\r\n                    </div>\r\n                    <div v-else class=\"task-action srt\" @click=\"showSRT(voice)\">\r\n                      <font-awesome-icon icon=\"closed-captioning\" />\r\n                      查看SRT\r\n                    </div>\r\n                    <div\r\n                      class=\"task-action import\"\r\n                      @click=\"\r\n                        voice.srt_file_path && voice.srt_file_path !== ''\r\n                          ? toNovelClick(voice)\r\n                          : null\r\n                      \"\r\n                      :style=\"{\r\n                        opacity: voice.srt_file_path && voice.srt_file_path !== '' ? 1 : 0.5,\r\n                        cursor:\r\n                          voice.srt_file_path && voice.srt_file_path !== ''\r\n                            ? 'pointer'\r\n                            : 'not-allowed'\r\n                      }\"\r\n                    >\r\n                      <font-awesome-icon icon=\"file-import\" />\r\n                      导入\r\n                    </div>\r\n                    <div class=\"task-action delete\" @click=\"bantchDelete(voice)\">\r\n                      <font-awesome-icon icon=\"trash-alt\" />\r\n                      删除\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div v-else>\r\n              <p>暂无合成语音。</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- 语音复刻 -->\r\n    <div v-else class=\"repro-content\">\r\n      <SpeechReproduction :categories=\"categories\" @jumpToPerson=\"jumpToPersonClick\" />\r\n    </div>\r\n    <!-- 私有库编辑弹窗 -->\r\n    <PersonalEditDialog\r\n      ref=\"personEditRef\"\r\n      v-if=\"personEditShow\"\r\n      :propdata=\"propdata\"\r\n      :categories=\"categories\"\r\n      @closeDialog=\"closeDialogPersonEdit\"\r\n    />\r\n    <!-- 导入小说库弹窗 -->\r\n    <ToNovelDialog\r\n      ref=\"ToNovelRef\"\r\n      v-if=\"toNovelShow\"\r\n      :propdata=\"propdata\"\r\n      @closeDialog=\"closeDialogToNovel\"\r\n    />\r\n    <!-- 查看SRT弹窗 -->\r\n    <ShowSRTFileDialog\r\n      ref=\"SRTFileRef\"\r\n      v-if=\"SRTFileShow\"\r\n      :propdata=\"propdata\"\r\n      @closeDialog=\"closeDialogSRTFile\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ElIcon } from 'element-plus'\r\nimport { Loading } from '@element-plus/icons-vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport {\r\n  getSpeechList,\r\n  postGenerate,\r\n  getModel,\r\n  getCategories,\r\n  getGenerateSrt,\r\n  postDeleteGenerated\r\n} from '@/service/speech'\r\nimport { ref, reactive, onMounted, computed, nextTick, onUnmounted, watch } from 'vue'\r\nimport { onBeforeUnmount } from 'vue'\r\nconst baseUrl = import.meta.env.VITE_API_BASE_URL\r\nimport pauseImg from '@/assets/pause.png'\r\nimport playImg from '@/assets/play.png'\r\nimport axios from 'axios'\r\nimport PersonalEditDialog from './components/PersonalEditDialog/index.vue'\r\nimport ToNovelDialog from './components/ToNovelDialog/index.vue'\r\nimport ShowSRTFileDialog from './components/ShowSRTFileDialog/index.vue'\r\nimport SpeechReproduction from './SpeechReproduction/index.vue'\r\n\r\nconst visibleCards = ref([]) // 用于存储当前可见的卡片\r\nconst currentPage = ref(1) // 当前页码\r\nconst pageSize = ref(20) // 初始值，将被动态计算覆盖\r\n\r\nconst inputText = ref('')\r\nconst currentCount = ref(0)\r\n// 进度文本\r\n// 定义更新字符数的方法\r\nconst updateCount = () => {\r\n  // 获取输入文本的长度\r\n  const length = inputText.value.length\r\n  if (length <= 6000) {\r\n    // 如果长度未超过 6000，更新当前字符数\r\n    currentCount.value = length\r\n  } else {\r\n    // 如果超过 6000，截取前 6000 个字符\r\n    inputText.value = inputText.value.slice(0, 6000)\r\n    currentCount.value = 6000\r\n  }\r\n}\r\n// 用于控制下拉菜单是否显示的响应式变量\r\nconst isDropdownVisible = ref({})\r\n// 切换下拉菜单显示状态的方法\r\nconst toggleDropdown = (voice) => {\r\n  isDropdownVisible.value[voice.id] = !isDropdownVisible.value[voice.id]\r\n}\r\n// 当音频开始播放时触发\r\nconst handlePlay = (id) => {\r\n  // 如果有其他音频正在播放，暂停它\r\n  if (currentPlayingId.value && currentPlayingId.value !== id) {\r\n    const currentAudio = audioElements.value[currentPlayingId.value]\r\n    if (currentAudio) {\r\n      currentAudio.pause()\r\n      currentAudio.currentTime = 0 // 播放归0\r\n    }\r\n  }\r\n  // 更新当前正在播放的音频 ID\r\n  currentPlayingId.value = id\r\n}\r\nconst activeName = ref('speechHC')\r\nconst propdata = ref()\r\nconst cardLoading = ref(false)\r\nconst handleClick = () => {\r\n  // console.log(\"切换,\",activeName.value)\r\n}\r\n\r\nlet clickOutsideHandler\r\n\r\nonMounted(() => {\r\n  loadCategories()\r\n  getSpeechListFunc()\r\n  loadSynthesizedVoices()\r\n  // 下载按钮的监听事件,判断是否显示下载SRT按钮\r\n  clickOutsideHandler = (event) => {\r\n    const dropdown = document.querySelector(`.dropdown-content.show`)\r\n    if (dropdown && !dropdown.contains(event.target) && !event.target.matches('.dropdown-button')) {\r\n      synthesizedVoices.value.forEach((voice) => {\r\n        isDropdownVisible.value[voice.id] = false\r\n      })\r\n    }\r\n  }\r\n  document.addEventListener('click', clickOutsideHandler)\r\n})\r\nconst intervalInit = ref(null)\r\n\r\nonUnmounted(() => {\r\n  if (clickOutsideHandler) {\r\n    document.removeEventListener('click', clickOutsideHandler)\r\n  }\r\n  clearInterval(intervalInit.value)\r\n})\r\nonBeforeUnmount(() => {\r\n  audioUrls.value.clear()\r\n  clearInterval(intervalInit.value)\r\n})\r\n\r\n//获新数据\r\nconst fetchData = () => {\r\n  const startIndex = (currentPage.value - 1) * pageSize.value\r\n  const endIndex = startIndex + pageSize.value\r\n  const newCards = voiceList.value\r\n\r\n  // 只有当有新数据时才添加\r\n  if (newCards.length > 0) {\r\n    visibleCards.value = [...visibleCards.value, ...newCards]\r\n  }\r\n}\r\nconst handleEnded = (id, type) => {\r\n  if (type == 'voice') {\r\n    handlePlay(id)\r\n  } else {\r\n    togglePlayPause(id)\r\n  }\r\n}\r\nconst downloadFile = async (voice, type) => {\r\n  const formatDateTime = (timeStr) => {\r\n    return timeStr.replace(/[-:\\s]/g, '')\r\n  }\r\n  let checkedList = []\r\n  if (type == 'voice') {\r\n    checkedList = [voice.audition_file_url]\r\n  } else if (type == 'srt') {\r\n    // 确保SRT文件路径是完整的URL\r\n    const srtUrl = voice.srt_file_path.startsWith('http')\r\n      ? voice.srt_file_path\r\n      : `${baseUrl}${voice.srt_file_path}`\r\n    checkedList = [srtUrl]\r\n  } else if (type == 'all') {\r\n    const srtUrl = voice.srt_file_path.startsWith('http')\r\n      ? voice.srt_file_path\r\n      : `${baseUrl}${voice.srt_file_path}`\r\n    checkedList = [voice.audition_file_url, srtUrl]\r\n  }\r\n  const getFileName = (url) => {\r\n    if (url === voice.audition_file_url || url === `${baseUrl}${voice.audition_file_url}`) {\r\n      return `${voice.industry}${voice.emotion}${voice.name}${\r\n        voice.gender === 'male' ? '男' : '女'\r\n      }${formatDateTime(voice.create_time)}.wav`\r\n    } else if (url === voice.srt_file_path || url === `${baseUrl}${voice.srt_file_path}`) {\r\n      return `${voice.industry}${voice.emotion}${voice.name}${\r\n        voice.gender === 'male' ? '男' : '女'\r\n      }${formatDateTime(voice.create_time)}.srt`\r\n    }\r\n    return 'unknown_file'\r\n  }\r\n  if (!checkedList.length) return\r\n  for (const item of checkedList) {\r\n    ElMessage.success('请稍候...')\r\n    try {\r\n      // 发起 GET 请求获取文件\r\n      const response = await fetch(item)\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`)\r\n      }\r\n      const blob = await response.blob() // 将响应转为 Blob 对象\r\n      // 创建下载链接\r\n      const url = URL.createObjectURL(blob)\r\n      const link = document.createElement('a')\r\n      link.href = url\r\n      link.download = getFileName(item) // 自定义文件名\r\n      document.body.appendChild(link)\r\n      link.click()\r\n      document.body.removeChild(link)\r\n      // 释放 Blob 对象\r\n      URL.revokeObjectURL(url)\r\n    } catch (error) {\r\n      ElMessage.error('下载失败，请稍后重试')\r\n    }\r\n  }\r\n}\r\n\r\nconst resultList = ref([])\r\nconst voiceList = computed(() => {\r\n  return resultList.value.map((item) => {\r\n    // console.log(\"item\",item)\r\n    return {\r\n      id: item.id,\r\n      name: item.name,\r\n      emotion: item.emotion,\r\n      avatar: `${baseUrl}${item.avatar}`,\r\n      avatar_id: item.avatar_id,\r\n      gender: item.gender,\r\n      industry: item.industry,\r\n      is_public: item.is_public,\r\n      audition_file_id: item.audition_file_id,\r\n      audition_file_name: item.audition_file_name,\r\n      audition_file_url: `${baseUrl}${item.audition_file_url}`,\r\n      generate_count: item.generate_count,\r\n      reference_voice_id: item.reference_voice_id,\r\n      reference_voice_name: item.reference_voice_name,\r\n      reference_voice_url: `${baseUrl}${item.reference_voice_url}`,\r\n      reference_voice_text: item.reference_voice_text,\r\n      gpt_model_id: item.gpt_model_id,\r\n      sovits_model_id: item.sovits_model_id,\r\n      create_time_new: item.create_time ? isWithinSevenDays(item.create_time) : false,\r\n      status: item.status ? item.status : 'remain'\r\n    }\r\n  })\r\n})\r\n\r\n// 判断时间是不是7天以内,比如今天23号,判断是不是17号以及以后的2024-12-16T15:39:09\r\nconst isWithinSevenDays = (dateStr) => {\r\n  if (!dateStr) return false\r\n  const today = new Date()\r\n  const targetDate = new Date(dateStr)\r\n  // 设置两个日期的时间都为当天的 23:59:59\r\n  today.setHours(23, 59, 59, 999)\r\n  // 获取7天前的日期\r\n  const sevenDaysAgo = new Date(today)\r\n  sevenDaysAgo.setDate(today.getDate() - 7)\r\n  sevenDaysAgo.setHours(0, 0, 0, 0)\r\n  // 判断目标日期是否在7天前和今天之间\r\n  return targetDate >= sevenDaysAgo && targetDate <= today\r\n}\r\nconst selectedVoice = ref(null)\r\nconst selectedGender = ref(null)\r\n\r\nconst settings = reactive({\r\n  voiceModel: '',\r\n  language: '中文',\r\n  pauseOption: '按标点符号切',\r\n  adjustLast: false,\r\n  speed: 1.0,\r\n  text: '',\r\n  volume: 1.0\r\n})\r\n\r\n// 添加筛选条件变量\r\nconst filterConditions = reactive({\r\n  gender_condition: '',\r\n  industry_condition: null,\r\n  emotion_condition: null,\r\n  isShare: true\r\n})\r\n\r\n// 添加分类数据存储\r\nconst categories = reactive({\r\n  industries: [],\r\n  emotions: []\r\n})\r\n\r\n// 获取分类数据\r\nconst loadCategories = async () => {\r\n  try {\r\n    const response = await getCategories()\r\n    if (response.code === 0) {\r\n      categories.industries = response.data.industries\r\n      categories.emotions = response.data.emotions\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    // console.error('获取分类数据失败:', error)\r\n    ElMessage.error('获取分类数据失败')\r\n  }\r\n}\r\n\r\nconst handleGenderChange = (gender) => {\r\n  selectedGender.value = gender\r\n  filterConditions.gender_condition = gender\r\n  getSpeechListFunc()\r\n}\r\n// 公共/私有事件\r\nconst handleshare = (item) => {\r\n  visibleCards.value = []\r\n  filterConditions.isShare = item\r\n  cardLoading.value = true\r\n  getSpeechListFunc()\r\n}\r\n// 私有库编辑\r\nconst personEditShow = ref(false)\r\n// 私有库编辑\r\nconst toNovelShow = ref(false)\r\nconst SRTFileShow = ref(false)\r\n// 存储音频元素的引用\r\nconst audioElements = ref([])\r\nconst editVoice = (item) => {\r\n  personEditShow.value = true\r\n  propdata.value = item\r\n}\r\nconst closeDialogPersonEdit = () => {\r\n  personEditShow.value = false\r\n  getSpeechListFunc()\r\n}\r\nconst closeDialogToNovel = () => {\r\n  toNovelShow.value = false\r\n  getSpeechListFunc()\r\n}\r\nconst closeDialogSRTFile = () => {\r\n  SRTFileShow.value = false\r\n  // getSpeechListFunc()\r\n}\r\nconst jumpToPersonClick = () => {\r\n  activeName.value = 'speechHC'\r\n  filterConditions.gender_condition = ''\r\n  filterConditions.industry_condition = null\r\n  filterConditions.emotion_condition = null\r\n  handleshare(false)\r\n}\r\n// 添加用于跟踪当前播放音频的 ID\r\nconst currentPlayingId = ref(null)\r\n\r\n// 添加用于存储合成的语音的列表\r\nconst synthesizedVoices = ref([])\r\nconst isGenerating = ref({})\r\nconst isAudioLoading = ref(false)\r\nconst isRemind = ref('')\r\nconst progress = ref({})\r\nconst progressText = ref({})\r\nconst isPlaying = (id) => {\r\n  // 只有当音频正在播放时才返回 true\r\n  return currentPlayingId.value === id\r\n}\r\n// 切换播放/暂停状态\r\nconst togglePlayPause = (id) => {\r\n  const audio = audioElements.value[id]\r\n  if (!audio) return\r\n  if (currentPlayingId.value === id) {\r\n    // 当前正在播放，则暂停\r\n    audio.pause()\r\n    currentPlayingId.value = null\r\n  } else {\r\n    // 暂停所有其他音频\r\n    const audios = document.querySelectorAll('audio')\r\n    audios.forEach((a) => {\r\n      if (!a.paused) {\r\n        a.pause()\r\n        a.currentTime = 0\r\n      }\r\n    })\r\n    // 播放当前音频\r\n    audio\r\n      .play()\r\n      .then(() => {\r\n        currentPlayingId.value = id\r\n      })\r\n      .catch((error) => {\r\n        ElMessage.error('音频播放失败')\r\n        currentPlayingId.value = null\r\n      })\r\n  }\r\n}\r\n\r\nconst selectVoice = (voice) => {\r\n  selectedVoice.value = voice\r\n  settings.voiceModel = voice\r\n\r\n  // 只有在选中时才设置音频源\r\n  if (!audioUrls.value.has(voice.id)) {\r\n    audioUrls.value.set(voice.id, voice.audition_file_url)\r\n    // 确保DOM更新后再设置src\r\n    nextTick(() => {\r\n      const audio = document.querySelector(`.voice-card[data-id=\"${voice.id}\"] audio`)\r\n      if (audio) {\r\n        audio.src = voice.audition_file_url\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nconst synthesizeVoice = async () => {\r\n  if (inputText.value == '') {\r\n    ElMessage.warning('请输入文本进行语音合成')\r\n    return\r\n  }\r\n  if (!selectedVoice.value) {\r\n    ElMessage.warning('请选择音色模型进行语音合成')\r\n    return\r\n  }\r\n  ElMessage.success('生成音频中，请稍候...')\r\n  try {\r\n    const payload = {\r\n      sound_model_id: selectedVoice.value.id,\r\n      language: settings.language,\r\n      pause_option: settings.pauseOption,\r\n      adjust_last: settings.adjustLast,\r\n      speed: settings.speed,\r\n      text: inputText.value\r\n    }\r\n    const response = await postGenerate(payload) // 发送语音合成请求\r\n    if (response.code !== 0) {\r\n      throw new Error(response.message || '语音合成请求失败')\r\n    }\r\n    await pollGenerationStatus('voice') // 轮询任务状态\r\n  } catch (error) {\r\n    ElMessage.error(error.message || '语音合成失败')\r\n  }\r\n}\r\nconst savedIds = ref([])\r\nconst synthesizeVoiceAndSRT = async () => {\r\n  await synthesizeVoice()\r\n  const currentFirstVoice = synthesizedVoices.value[0]\r\n  if (currentFirstVoice) {\r\n    savedIds.value.push(currentFirstVoice.id)\r\n  }\r\n}\r\n\r\n// 添加轮询方法\r\nconst pollGenerationStatus = async (type, voice, index) => {\r\n  if (type === 'voice') {\r\n    const resList = await getModel(settings.voiceModel.id)\r\n    if (resList.code !== 0) {\r\n      throw new Error(resList.message || '获取状态失败')\r\n    }\r\n    const resDataList = resList.data.list\r\n    // 遍历 resDataList 数组\r\n    resDataList.forEach((newItem) => {\r\n      // 查找 synthesizedVoices.value 中是否存在相同 id 的元素\r\n      const existingIndex = synthesizedVoices.value.findIndex((voice) => voice.id === newItem.id)\r\n      if (existingIndex !== -1) {\r\n        // 如果存在相同 id 的元素\r\n        const existingItem = synthesizedVoices.value[existingIndex]\r\n        // 检查除 id 外的其他属性是否相同\r\n        const isDifferent = Object.keys(newItem).some((key) => {\r\n          if (key !== 'id') {\r\n            return newItem[key] !== existingItem[key]\r\n          }\r\n          return false\r\n        })\r\n        if (isDifferent) {\r\n          // 如果有不同的属性，更新 synthesizedVoices.value 中该元素\r\n          synthesizedVoices.value[existingIndex] = {\r\n            id: newItem.id,\r\n            audition_file_url: `${baseUrl}${newItem.file_url}`,\r\n            text: newItem.text,\r\n            status: newItem.status,\r\n            industry: newItem.industry,\r\n            emotion: newItem.emotion,\r\n            name: newItem.name,\r\n            gender: newItem.gender,\r\n            create_time: newItem.create_time,\r\n            srt_file_id: newItem.srt_file_id ?? null,\r\n            srt_file_path: newItem.srt_file_path ?? null\r\n          }\r\n          // 更新相关状态\r\n          nextTick(() => {\r\n            isGenerating.value[newItem.id] = false\r\n            progress.value[newItem.id] = 0\r\n            progressText.value[newItem.id] = ''\r\n          })\r\n        }\r\n      } else {\r\n        // 如果存在不相同 id 的元素，将该元素添加到 synthesizedVoices.value 中\r\n        synthesizedVoices.value.unshift({\r\n          id: newItem.id,\r\n          audition_file_url: `${baseUrl}${newItem.file_url}`,\r\n          text: newItem.text,\r\n          status: newItem.status,\r\n          industry: newItem.industry,\r\n          emotion: newItem.emotion,\r\n          name: newItem.name,\r\n          gender: newItem.gender,\r\n          create_time: newItem.create_time,\r\n          srt_file_id: newItem.srt_file_id ?? null,\r\n          srt_file_path: newItem.srt_file_path ?? null\r\n        })\r\n        // 更新相关状态\r\n        nextTick(() => {\r\n          isGenerating.value[newItem.id] = false\r\n          progress.value[newItem.id] = 0\r\n          progressText.value[newItem.id] = ''\r\n        })\r\n      }\r\n    })\r\n  } else if (type === 'srt') {\r\n    setTimeout(async () => {\r\n      try {\r\n        const statusResponse = await getModel(voice.id)\r\n        if (statusResponse.code !== 0) {\r\n          throw new Error(statusResponse.message || '获取状态失败')\r\n        }\r\n        const resList = statusResponse.data.list\r\n        if (resList[index].srt_status && resList[index].srt_status === 'success') {\r\n          progressText.value[voice.id] = ' 已完成'\r\n          progress.value[voice.id] = 100\r\n          nextTick(() => {\r\n            const targetIndex = synthesizedVoices.value.findIndex(\r\n              (item) => item.id === resList[index].id\r\n            )\r\n            if (targetIndex !== -1) {\r\n              synthesizedVoices.value[targetIndex] = {\r\n                ...synthesizedVoices.value[targetIndex],\r\n                srt_file_id: resList[index].srt_file_id ?? null,\r\n                srt_file_path: resList[index].srt_file_path ?? null\r\n              }\r\n            }\r\n          })\r\n        } else if (resList[index].srt_status && resList[index].srt_status === 'failed') {\r\n          progressText.value[voice.id] = ' 生成失败'\r\n        } else {\r\n          // 如果状态既不是成功也不是失败，继续调用\r\n          await pollGenerationStatus('srt', voice, index)\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    }, 2000)\r\n  }\r\n}\r\nconst getSpeechListFunc = async () => {\r\n  try {\r\n    // 构建请求参数，确保包含所有筛选条件\r\n    const params = {\r\n      gender_condition: filterConditions.gender_condition,\r\n      industry_condition: filterConditions.industry_condition,\r\n      emotion_condition: filterConditions.emotion_condition,\r\n      is_public: filterConditions.isShare\r\n    }\r\n    const response = await getSpeechList(params)\r\n    if (response.code === 0) {\r\n      cardLoading.value = false\r\n      resultList.value = response.data.list\r\n      // 重置分页和可见卡片\r\n      currentPage.value = 1\r\n      visibleCards.value = []\r\n      // 初始加载第一页数据\r\n      await fetchData()\r\n    } else {\r\n      throw new Error(response.data.message || '获取语音列表失败')\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error(error.message || '获取语音列表失败')\r\n    throw error // 重新抛出错误以便上层捕获\r\n  }\r\n}\r\n\r\nconst loadSynthesizedVoices = async () => {\r\n  try {\r\n    const response = await getModel(11)\r\n    if (response.code === 0) {\r\n      let responseData = response.data.list\r\n      synthesizedVoices.value = responseData.map((item) => ({\r\n        id: item.id, // 生成唯一ID\r\n        audition_file_url: `${baseUrl}${item.file_url}`,\r\n        text: item.text,\r\n        status: item.status,\r\n        industry: item.industry,\r\n        emotion: item.emotion,\r\n        name: item.name,\r\n        gender: item.gender,\r\n        create_time: item.create_time,\r\n        srt_file_id: item.srt_file_id ?? null,\r\n        srt_file_path: item.srt_file_path ?? null\r\n      }))\r\n      nextTick(() => {\r\n        synthesizedVoices.value.forEach((voice) => {\r\n          isGenerating.value[voice.id] = false\r\n          progress.value[voice.id] = 0\r\n          progressText.value[voice.id] = ''\r\n        })\r\n      })\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error(error)\r\n  }\r\n}\r\n// 监听 synthesizedVoices.value 的变化,是否有pending\r\nconst watchPromise = ref(null)\r\nwatch(\r\n  () => synthesizedVoices.value.some((voice) => voice.status === 'pending'),\r\n  (hasPending) => {\r\n    if (hasPending) {\r\n      watchPromise.value = new Promise((resolve, reject) => {\r\n        const intervalId = setInterval(async () => {\r\n          try {\r\n            const statusResponse = await getModel(11)\r\n            if (statusResponse.code !== 0) {\r\n              throw new Error(statusResponse.message || '获取状态失败')\r\n            }\r\n            const responseList = statusResponse.data.list\r\n            let allCompleted = true\r\n\r\n            const pendingIds = synthesizedVoices.value\r\n              .filter((voice) => voice.status === 'pending')\r\n              .map((voice) => voice.id)\r\n\r\n            pendingIds.forEach((pendingId) => {\r\n              const responseItem = responseList.find((item) => item.id === pendingId)\r\n              if (responseItem) {\r\n                if (responseItem.status === 'success') {\r\n                  const index = synthesizedVoices.value.findIndex((voice) => voice.id === pendingId)\r\n                  if (index !== -1) {\r\n                    synthesizedVoices.value[index] = {\r\n                      id: responseItem.id,\r\n                      audition_file_url: `${baseUrl}${responseItem.file_url}`,\r\n                      text: responseItem.text,\r\n                      status: responseItem.status,\r\n                      industry: responseItem.industry,\r\n                      emotion: responseItem.emotion,\r\n                      name: responseItem.name,\r\n                      gender: responseItem.gender,\r\n                      create_time: responseItem.create_time,\r\n                      srt_file_id: responseItem.srt_file_id ?? null,\r\n                      srt_file_path: responseItem.srt_file_path ?? null\r\n                    }\r\n\r\n                    nextTick(() => {\r\n                      isGenerating.value[pendingId] = false\r\n                      progress.value[pendingId] = 0\r\n                      progressText.value[pendingId] = ''\r\n                    })\r\n                  }\r\n                } else if (responseItem.status === 'pending') {\r\n                  allCompleted = false\r\n                } else if (responseItem.status === 'failed') {\r\n                  clearInterval(intervalId)\r\n                  console.log(`ID 为 ${pendingId} 的语音生成失败`)\r\n                  progressText.value[pendingId] = '生成失败'\r\n                }\r\n              }\r\n            })\r\n\r\n            if (allCompleted) {\r\n              clearInterval(intervalId)\r\n              resolve()\r\n            }\r\n          } catch (error) {\r\n            clearInterval(intervalId)\r\n            reject(error)\r\n          }\r\n        }, 6000)\r\n      })\r\n    }\r\n    if (savedIds.value.length > 0) {\r\n      for (let i = savedIds.value.length - 1; i >= 0; i--) {\r\n        const targetId = savedIds.value[i]\r\n        const index = synthesizedVoices.value.findIndex((item) => item.id === targetId)\r\n        const matchedItem = synthesizedVoices.value.find((item) => item.id === targetId)\r\n        if (matchedItem && matchedItem.status === 'success') {\r\n          createSRT(matchedItem, index)\r\n          savedIds.value.splice(i, 1)\r\n        }\r\n      }\r\n    }\r\n  },\r\n  { deep: true }\r\n)\r\nconst createSRT = async (voice, index) => {\r\n  if (voice.reCreate) {\r\n    voice.reCreate = false\r\n    progress.value[voice.id] = 0\r\n    progressText.value[voice.id] = '生成中...'\r\n  }\r\n  try {\r\n    let params = {\r\n      id: voice.id\r\n    }\r\n    const response = await getGenerateSrt(params)\r\n    if (response.code === 0) {\r\n      isGenerating.value[voice.id] = true\r\n      progressText.value[voice.id] = '生成中...'\r\n      setTimeout(() => {\r\n        progress.value[voice.id] = 40\r\n      }, 100)\r\n      setTimeout(() => {\r\n        progress.value[voice.id] = 75\r\n      }, 300)\r\n      setTimeout(async () => {\r\n        await pollGenerationStatus('srt', voice, index) // 轮询任务状态\r\n      }, 500)\r\n    } else {\r\n      throw new Error(response.message)\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('生成失败!', error)\r\n  }\r\n}\r\nconst reCreateSRT = (voice) => {\r\n  voice.reCreate = true\r\n}\r\n\r\nconst showSRT = async (item) => {\r\n  SRTFileShow.value = true\r\n  propdata.value = item\r\n}\r\nconst toNovelClick = async (item) => {\r\n  toNovelShow.value = true\r\n  propdata.value = item\r\n}\r\nconst bantchDelete = async (voice) => {\r\n  ElMessageBox.confirm('确定要删除吗？', '提示', {\r\n    confirmButtonText: '确定',\r\n    cancelButtonText: '取消',\r\n    type: 'warning'\r\n  }).then(async () => {\r\n    const res = await postDeleteGenerated(voice.id)\r\n    if (res.code === 0) {\r\n      const statusResponse = await getModel(voice.id)\r\n      let responseData = statusResponse.data.list\r\n      // 遍历 resDataList 数组 这种实现方式会刷新删除行后面的数据,相比直接赋值效果好一些\r\n      synthesizedVoices.value = synthesizedVoices.value.filter((voice) => {\r\n        return responseData.some((newItem) => newItem.id === voice.id)\r\n      })\r\n      responseData.forEach((newItem) => {\r\n        // 查找 synthesizedVoices.value 中是否存在相同 id 的元素\r\n        const existingIndex = synthesizedVoices.value.findIndex((voice) => voice.id === newItem.id)\r\n        if (existingIndex !== -1) {\r\n          // 如果存在相同 id 的元素\r\n          const existingItem = synthesizedVoices.value[existingIndex]\r\n          // 检查除 id 外的其他属性是否相同\r\n          const isDifferent = Object.keys(newItem).some((key) => {\r\n            if (key !== 'id') {\r\n              return newItem[key] !== existingItem[key]\r\n            }\r\n            return false\r\n          })\r\n          if (isDifferent) {\r\n            // 如果有不同的属性，更新 synthesizedVoices.value 中该元素\r\n            synthesizedVoices.value[existingIndex] = {\r\n              id: newItem.id,\r\n              audition_file_url: `${baseUrl}${newItem.file_url}`,\r\n              text: newItem.text,\r\n              status: newItem.status,\r\n              industry: newItem.industry,\r\n              emotion: newItem.emotion,\r\n              name: newItem.name,\r\n              gender: newItem.gender,\r\n              create_time: newItem.create_time,\r\n              srt_file_id: newItem.srt_file_id ?? null,\r\n              srt_file_path: newItem.srt_file_path ?? null\r\n            }\r\n            // 更新相关状态\r\n            nextTick(() => {\r\n              isGenerating.value[newItem.id] = false\r\n              progress.value[newItem.id] = 0\r\n              progressText.value[newItem.id] = ''\r\n            })\r\n          }\r\n        } else {\r\n          // 如果存在不相同 id 的元素，将该元素添加到 synthesizedVoices.value 中\r\n          synthesizedVoices.value.push({\r\n            id: newItem.id,\r\n            audition_file_url: `${baseUrl}${newItem.file_url}`,\r\n            text: newItem.text,\r\n            status: newItem.status,\r\n            industry: newItem.industry,\r\n            emotion: newItem.emotion,\r\n            name: newItem.name,\r\n            gender: newItem.gender,\r\n            create_time: newItem.create_time,\r\n            srt_file_id: newItem.srt_file_id ?? null,\r\n            srt_file_path: newItem.srt_file_path ?? null\r\n          })\r\n          // 更新相关状态\r\n          nextTick(() => {\r\n            isGenerating.value[newItem.id] = false\r\n            progress.value[newItem.id] = 0\r\n            progressText.value[newItem.id] = ''\r\n          })\r\n        }\r\n      })\r\n      ElMessage({\r\n        type: 'success',\r\n        message: '删除成功!'\r\n      })\r\n    } else {\r\n      throw new Error(res.message)\r\n    }\r\n  })\r\n}\r\n\r\nconst audioUrls = ref(new Map()) // 用于存储已加载的音频URL\r\n\r\nconst handleIndustryClick = (industry) => {\r\n  filterConditions.industry_condition = industry\r\n  getSpeechListFunc()\r\n}\r\n\r\nconst handleEmotionClick = (emotion) => {\r\n  filterConditions.emotion_condition = emotion\r\n  getSpeechListFunc()\r\n}\r\n</script>\r\n<style scoped>\r\n@import './index.css';\r\n</style>\r\n"],"names":["pauseImg","playImg","dialogVisible","ref","otherForm","loading","emit","__emit","props","__props","referAudioList","computed","otherFormData","handleBeforeReferUpload","file","ElMessage","maxSize","arrayBuffer","duration","maxDuration","minDuration","handlReferAudioUpload","options","onSuccess","onError","form","response","postUploadFile","error","handleReferAudioExceed","files","fileList","newFile","handleClose","refreshList","handleDelete","ElMessageBox","PostDeleteModel","onMounted","init","item","visible","tabType","handleAvatarUpload","handleAvatarSuccess","handleAvatarRemove","uploadFile","uploadFiles","handleReferAudioRemove","reactive","formRules","handleSubmit","valid","fields","params","postUpdateModel","__expose","useBatchNovelStoreStore","defineStore","res","treeTagsList","transformData","nodes","level","parentId","result","node","transformedNode","childrenResult","baseUrl","batchNovelStore","voiceFile","SRTfile","tagsList","resultVoice","handleFile","resultSRT","fileUrl","type","text","srtSize","voiceSize","srtLine","voiceTime","audio","resolve","seconds","minutes","remainingSeconds","getPaddingStyle","handleTagChange","newTags","value","getLabelByValue","tag","option","handleCreateNewTagRes","data","addMaterialTag","getIdByName","exportToNovel","list1","list2","idSet","nameToIdMap","numericItem","srtContent","fetchSrtContent","musicIcon","dropDown","intervalEcho","attemptEcho","timerId","clearLoading","getEcho","onUnmounted","pollStatusEcho","addLoading","secondLoading","thirdLoading","fourLoading","addAvataLoading","showFirstUpdate","addDisabled","firstDisabled","secondDisabled","thirdDisabled","fourDisabled","toneFormData","paramsForm","toneForm","firstList","secondList","fourList","handleBeforeAvatarUpload","handleBeforeFirstUpload","audiosFile","handleFirstUpload","handleFirstSuccess","handleRemove","handleFirstRemove","getTaskDetail","resData","stepListToShow","lengths","stepList","stepListToText","values","index","action","instance","done","getBaseStatusText","handleCancelRepro","getTaskstop","handleCancel","handleSave","postTaskCreate","secondClick","postTaskExecute","activeNames","voiceLabelPage","voiceLabelList","audioRefs","voiceLabelListRes","handleChange","getAsrFileReview","currentAudioIndex","handlePlay","playIndex","previousAudio","handleEnded","nextPageClick","prePageClick","saveLabelClick","postAsrFileUpdate","fourClick","getTaskStart","visibleCards","currentPage","pageSize","inputText","currentCount","updateCount","length","isDropdownVisible","toggleDropdown","voice","id","currentPlayingId","currentAudio","audioElements","activeName","propdata","cardLoading","handleClick","clickOutsideHandler","loadCategories","getSpeechListFunc","loadSynthesizedVoices","event","dropdown","synthesizedVoices","intervalInit","onBeforeUnmount","audioUrls","fetchData","newCards","voiceList","togglePlayPause","downloadFile","formatDateTime","timeStr","checkedList","srtUrl","getFileName","url","blob","link","resultList","isWithinSevenDays","dateStr","today","targetDate","sevenDaysAgo","selectedVoice","selectedGender","settings","filterConditions","categories","getCategories","handleGenderChange","gender","handleshare","personEditShow","toNovelShow","SRTFileShow","editVoice","closeDialogPersonEdit","closeDialogToNovel","closeDialogSRTFile","jumpToPersonClick","isGenerating","isAudioLoading","isRemind","progress","progressText","isPlaying","a","selectVoice","nextTick","synthesizeVoice","payload","postGenerate","pollGenerationStatus","savedIds","synthesizeVoiceAndSRT","currentFirstVoice","resList","getModel","newItem","existingIndex","existingItem","key","statusResponse","targetIndex","getSpeechList","responseData","watchPromise","watch","hasPending","reject","intervalId","responseList","allCompleted","pendingId","responseItem","i","targetId","matchedItem","createSRT","getGenerateSrt","reCreateSRT","showSRT","toNovelClick","bantchDelete","postDeleteGenerated","voice2","handleIndustryClick","industry","handleEmotionClick","emotion","_ctx","_cache"],"mappings":"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"}