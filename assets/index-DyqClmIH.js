import{k as ut,x as bt,_ as ct,o as qe,r as i,z as Ve,q as c,s,t as dt,u as F,O as Ie,p as ht,n as yt,i as kt,g as Ct,N as l,P as le,Q as d,R as St,X as j,aj as It,w as Rt,c as ke,A as me,S as e,L as Z,M as se,aM as oe,bJ as He,ah as ue,aE as Ot,aG as Tt,ap as Et,b6 as Vt,bK as rt,a4 as Re,a1 as Je,at as Ee,bL as Qe,ai as Te,F as Xe,bM as xt,C as Dt,aH as je,aK as it,bH as $t}from"./vue-vendor-BgjGt3mC.js";import{V as Nt,W as mt,k as Ce,_ as Se,a5 as at,a8 as st,a7 as Ye,a as $e,r as Ne,i as Pe,j as we,f as Ae,d as nt,E as te,h as Pt,c as wt,e as At,F as Bt,aj as Ut,b as Lt}from"./index-DenF-4mp.js";/* empty css                          */import{E as Ft}from"./el-switch-D5b6lWYu.js";import{v as Ze}from"./el-loading-BopW0Ho2.js";import{E as Gt}from"./el-pagination-BgYiuaI2.js";import{a as Mt,E as zt}from"./el-tab-pane-C6HyQSos.js";import"./lodash-BmZg10rb.js";import"./jszip-C7-yN4-L.js";import"./remark-CBsncvHK.js";import"./quill-BeGMbSWh.js";import"./axios-xsH4HHeE.js";const vt=Symbol("breadcrumbKey"),Kt=ut({separator:{type:String,default:"/"},separatorIcon:{type:bt}}),Wt=qe({name:"ElBreadcrumb"}),jt=qe({...Wt,props:Kt,setup(K){const N=K,{t:a}=Nt(),v=mt("breadcrumb"),y=i();return ht(vt,N),Ve(()=>{const n=y.value.querySelectorAll(`.${v.e("item")}`);n.length&&n[n.length-1].setAttribute("aria-current","page")}),(n,o)=>(s(),c("div",{ref_key:"breadcrumb",ref:y,class:Ie(F(v).b()),"aria-label":F(a)("el.breadcrumb.label"),role:"navigation"},[dt(n.$slots,"default")],10,["aria-label"]))}});var qt=ct(jt,[["__file","breadcrumb.vue"]]);const Ht=ut({to:{type:yt([String,Object]),default:""},replace:Boolean}),Jt=qe({name:"ElBreadcrumbItem"}),Qt=qe({...Jt,props:Ht,setup(K){const N=K,a=Ct(),v=kt(vt,void 0),y=mt("breadcrumb"),n=a.appContext.config.globalProperties.$router,o=i(),D=()=>{!N.to||!n||(N.replace?n.replace(N.to):n.push(N.to))};return(w,T)=>{var x,A;return s(),c("span",{class:Ie(F(y).e("item"))},[l("span",{ref_key:"link",ref:o,class:Ie([F(y).e("inner"),F(y).is("link",!!w.to)]),role:"link",onClick:D},[dt(w.$slots,"default")],2),(x=F(v))!=null&&x.separatorIcon?(s(),le(F(Ce),{key:0,class:Ie(F(y).e("separator"))},{default:d(()=>[(s(),le(St(F(v).separatorIcon)))]),_:1},8,["class"])):(s(),c("span",{key:1,class:Ie(F(y).e("separator")),role:"presentation"},j((A=F(v))==null?void 0:A.separator),3))],2)}}});var _t=ct(Qt,[["__file","breadcrumb-item.vue"]]);const Xt=Rt(qt,{BreadcrumbItem:_t}),Yt=It(_t),Zt=i([{label:"创建任务",value:"createTask"},{label:"原料库",value:"templateLibrary"}]),el={class:"template-library-container"},tl={class:"resource-layout"},ll={class:"right-panel"},al=["onClick"],sl=["title"],nl={key:1,class:"template-content"},ol=["src"],il=["title"],ul={key:0,class:"empty-state"},cl={__name:"LibraryVideoList",props:{visible:{type:Boolean,default:!1},dataList:{type:Array,default:()=>[]},selectedData:{type:Array,default:()=>[]},maxCount:{type:Number,default:20}},emits:["selection-change","folder-click","scroll"],setup(K,{expose:N,emit:a}){const v=K,y=a,n=i([]),o=i([]),D=ke(()=>v.dataList||[]),w=g=>n.value.length>=v.maxCount&&!n.value.some(f=>f.element_id===g.element_id),T=()=>{n.value=[],o.value=[]},x=()=>{n.value=o.value.map(g=>{const f=v.dataList.find(E=>E.element_id===g);return f||n.value.find(E=>E.element_id===g)}).filter(g=>g&&g.element_id)},A=i(null),_=g=>{const f=g.target;A.value&&A.value!==f&&A.value.pause(),A.value=f},B=g=>{g!=null&&g.length?(n.value=g,o.value=g.map(f=>f.element_id)):(n.value=[],o.value=[])},q=g=>{const f=g.map(E=>E.element_id);o.value=Array.from(new Set([...o.value,...f])).filter(E=>v.dataList.some(k=>k.element_id===E)?f.includes(E):!0),x(),y("selection-change",n.value)},R=(g,f)=>{let E=null;return function(...k){E&&clearTimeout(E),E=setTimeout(()=>{g.apply(this,k)},f)}},W=i(!1),P=R(g=>{const{scrollTop:f,scrollHeight:E,clientHeight:k}=g.target;Math.abs(E-f-k)<=1&&!W.value&&(W.value=!0,y("scroll"),setTimeout(()=>{W.value=!1},1e3))},200),G=g=>{y("folder-click",g)};return me(()=>v.selectedData,g=>{g!=null&&g.length&&(o.value=g.map(f=>f.element_id),x())},{immediate:!0}),me(()=>v.dataList,()=>{x()}),N({setSelectedTemplates:B,clearSelection:T}),(g,f)=>{const E=Ce,k=at,r=st,m=Ye;return s(),c("div",el,[l("div",tl,[l("div",ll,[l("div",{class:"materials-display",onScroll:f[1]||(f[1]=(...b)=>F(P)&&F(P)(...b))},[e(r,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=b=>n.value=b),onChange:q,class:"template-grid"},{default:d(()=>[(s(!0),c(se,null,oe(D.value,(b,J)=>(s(),c("div",{key:J,class:"template-item"},[b.element_type==="FOLDER"?(s(),c("div",{key:0,class:"template-content folder-content",onClick:M=>G(b)},[e(E,{size:60},{default:d(()=>[e(F(He))]),_:1}),l("div",{class:"template-name",title:b.element_name||"未命名文件夹"},j(b.element_name||"未命名文件夹"),9,sl)],8,al)):(s(),c("div",nl,[(s(),c("video",{src:b.element_url,key:b.element_id,class:"preview",controls:"",preload:"metadata",onPlay:_},null,40,ol)),l("div",{class:"template-name",title:b.element_name||"未命名视频"},j(b.element_name||"未命名视频"),9,il),e(k,{label:b,class:"template-checkbox",disabled:w(b),title:w(b)?`已达到最大选择数量 ${v.maxCount}`:""},null,8,["label","disabled","title"])]))]))),128))]),_:1},8,["modelValue"]),D.value.length===0?(s(),c("div",ul,[e(m,{description:"暂无视频"})])):Z("",!0)],32)])])])}}},dl=Se(cl,[["__scopeId","data-v-9a0e12db"]]),rl={class:"selected-area"},ml={class:"selected-title"},vl={class:"selected-list"},_l=["onClick"],pl={key:0},fl={key:0,class:"empty-category"},gl=["title"],bl={class:"clear-btn-wrapper"},hl={__name:"SelectedItemsList",props:{title:{type:String,default:"已选原料"},selectedList:{type:Object,default:()=>({RAW:[],PRE_VIDEO:[],POST_VIDEO:[],FOREGROUND:[],BACKGROUND:[],BGM:[]})},emptyText:{type:String,default:"暂无选中内容"},clearButtonText:{type:String,default:"清空选中"},maxItemsByType:{type:Object,default:()=>({RAW:20,PRE_VIDEO:1,POST_VIDEO:1,FOREGROUND:1,BACKGROUND:1,BGM:1})}},emits:["remove","clear"],setup(K,{expose:N,emit:a}){const v=a,y=(x,A)=>{v("remove",x,A)},n=()=>{v("clear")},o=x=>({RAW:"剪辑素材",PRE_VIDEO:"前贴",POST_VIDEO:"后贴",FOREGROUND:"前景",BACKGROUND:"背景",BGM:"背景音乐"})[x]||"未知类别",D=i({}),w=x=>{D.value[x]=!D.value[x]},T=x=>D.value[x]||!1;return N({isCategoryCollapsed:T,toggleCategory:w}),(x,A)=>{const _=Ce,B=$e;return s(),c("div",rl,[l("div",ml,j(K.title),1),l("div",vl,[(s(!0),c(se,null,oe(K.selectedList,(q,R)=>(s(),c("div",{key:R,class:"selected-category"},[l("h3",{class:"category-title",onClick:W=>w(R)},[ue(j(o(R))+" ("+j(q.length)+"/"+j(K.maxItemsByType[R])+") ",1),e(_,{class:"toggle-icon"},{default:d(()=>[T(R)?(s(),le(F(Ot),{key:0})):(s(),le(F(Tt),{key:1}))]),_:2},1024)],8,_l),T(R)?Z("",!0):(s(),c("div",pl,[q.length===0?(s(),c("div",fl,A[0]||(A[0]=[l("span",null,"暂无选中内容",-1)]))):(s(!0),c(se,{key:1},oe(q,(W,P)=>(s(),c("div",{key:P,class:"selected-item"},[l("span",{class:"item-name",title:W.element_name},j(W.element_name),9,gl),e(_,{class:"remove-icon",onClick:G=>y(W,R)},{default:d(()=>[e(F(Et))]),_:2},1032,["onClick"])]))),128))]))]))),128))]),l("div",bl,[e(B,{onClick:n,type:"info",plain:""},{default:d(()=>[ue(j(K.clearButtonText),1)]),_:1})])])}}},ot=Se(hl,[["__scopeId","data-v-218f294e"]]),yl={class:"path-display"},kl={class:"path-wrapper"},Cl={__name:"BreadcrumbPath",props:{path:{type:String,default:"/"}},emits:["path-click"],setup(K,{emit:N}){const a=K,v=N,y=ke(()=>a.path.startsWith("/")?a.path.substring(1).split("/").filter(Boolean):a.path.split("/").filter(Boolean)),n=w=>"/"+y.value.slice(0,w+1).join("/"),o=()=>{const w=a.path;if(w==="/")return;const T=w.lastIndexOf("/"),x=T===0?"/":w.substring(0,T);v("path-click",x)},D=w=>{v("path-click",w)};return(w,T)=>{const x=Ce,A=Yt,_=Xt;return s(),c("div",yl,[e(_,{separator:"/"},{default:d(()=>[l("div",kl,[K.path!=="/"?(s(),le(x,{key:0,class:"back-icon",title:"返回上一级",onClick:o},{default:d(()=>[e(F(Vt))]),_:1})):Z("",!0),T[3]||(T[3]=l("div",{class:"path-label"},"当前路径:",-1)),e(A,{class:"clickable",onClick:T[0]||(T[0]=B=>D("/"))},{default:d(()=>T[2]||(T[2]=[ue("根目录")])),_:1,__:[2]}),(s(!0),c(se,null,oe(y.value,(B,q)=>(s(),c(se,{key:q},[q<y.value.length-1?(s(),le(A,{key:0,class:"clickable",onClick:R=>D(n(q))},{default:d(()=>[ue(j(B),1)]),_:2},1032,["onClick"])):(s(),le(A,{key:1,class:"clickable"},{default:d(()=>[ue(j(B),1)]),_:2},1024))],64))),128))])]),_:1}),e(x,{class:"refresh-icon",title:"刷新列表",onClick:T[1]||(T[1]=B=>D(K.path))},{default:d(()=>[e(F(rt))]),_:1})])}}},et=Se(Cl,[["__scopeId","data-v-2a16554f"]]),fe=async K=>Ne({url:"/jd_aic/element/list",method:"get",params:K}),Sl=async K=>Ne({url:"/jd_aic/mix_cut",method:"post",data:K}),lt=async K=>Ne({url:"/jd_aic/task/list",method:"get",params:K}),Il=async K=>Ne({url:"/jd_aic/task/save",method:"post",data:K}),Rl=async K=>Ne({url:"/jd_aic/product/info",method:"get",params:K}),Ol={class:"dialog-content"},Tl={class:"video-list-area"},El={class:"search-box"},Vl={class:"search-btn"},xl={class:"loading-container","element-loading-text":"加载中..."},Dl={key:0,class:"bottom-loading"},$l={key:1,class:"no-more"},Nl={class:"dialog-footer"},Pl={__name:"SelectVideoDialog",props:{visible:{type:Boolean,default:!1},selectedData:{type:Array,default:()=>[]},maxCount:{type:Number,default:1},disabledVideoTypes:{type:Array,default:()=>[]}},emits:["update:visible","confirm"],setup(K,{emit:N}){const a=N,v=K,y=i(null),n=i(null),o=i({RAW:[],PRE_VIDEO:[],POST_VIDEO:[],FOREGROUND:[],BACKGROUND:[]}),D=ke(()=>({RAW:20,PRE_VIDEO:v.maxCount,POST_VIDEO:v.maxCount,FOREGROUND:1,BACKGROUND:1}));Ve(()=>{});const w=i("本页全选"),T=[{label:"剪辑素材",value:"RAW"},{label:"前贴",value:"PRE_VIDEO"},{label:"后贴",value:"POST_VIDEO"},{label:"前景",value:"FOREGROUND"},{label:"背景",value:"BACKGROUND"}],x=i(!1),A=i(""),_=i("RAW"),B=i(!1),q=i(0),R=ke({get:()=>v.visible,set:p=>a("update:visible",p)}),W=p=>{o.value[_.value]=p,y.value&&y.value.isCategoryCollapsed(_.value)&&y.value.toggleCategory(_.value)},P=p=>v.disabledVideoTypes.includes(p)?`已有图片类型的${p==="FOREGROUND"?"前景":"背景"}`:"",G=(p,u)=>{o.value[u]=o.value[u].filter(I=>I.element_id!==p.element_id),u==_.value&&n.value&&n.value.setSelectedTemplates(o.value[u])},g=async p=>{const u=m.path_name==="/"?"/"+p.element_name:`${m.path_name}/${p.element_name}`;m.path_name=u,ne.value=u,O.value=1,H.value=1,await M(),z()},f=()=>{a("confirm",o.value),R.value=!1},E=()=>{o.value={RAW:[],PRE_VIDEO:[],POST_VIDEO:[],FOREGROUND:[],BACKGROUND:[]},n.value&&n.value.clearSelection()},k=()=>{},r=i([]),m=Re({page:1,page_size:20,element_type:"VIDEO",path_name:"/"}),b=i(0),J=i(0),M=async(p=!1,u,I)=>{var L,X;try{if(p){if(u==="folder"){const ee=await fe({...m,page:I,element_type:"FOLDER"});if(ee.code===0){const ce=(ee.data.elements||[]).map(U=>({...U,isFolder:!0}));r.value=[...r.value,...ce]}else te.error(ee.message||"获取数据失败")}else if(u==="video"){const ee=await fe({...m,page:I,element_type:"VIDEO"});if(ee.code===0){const ce=ee.data.elements||[];r.value=[...r.value,...ce]}else te.error(ee.message||"获取数据失败")}x.value=!1;return}B.value=!0;const $=await fe({...m,element_type:"FOLDER"}),ae=await fe({...m,element_type:"VIDEO"});if($.code===0&&ae.code===0){const ee=($.data.elements||[]).map(U=>({...U,isFolder:!0})),ce=ae.data.elements||[];r.value=[...ee,...ce],b.value=((L=$.data.page_info)==null?void 0:L.total_number)||0,J.value=((X=ae.data.page_info)==null?void 0:X.total_number)||0}else te.error($.message||ae.message||"获取数据失败")}catch($){te.error($||"获取数据失败")}finally{B.value=!1}},pe=async p=>{p?m.use_as=p:delete m.use_as,O.value=1,H.value=1,await M()},ve=i(""),ge=async()=>{if(O.value=1,H.value=1,ve.value==""&&m.element_name){delete m.element_name,await M();return}m.element_name=ve.value,await M()},ne=i("/"),de=async p=>{O.value=1,H.value=1,ne.value=p,m.path_name=p,await M(),z()},z=()=>{const p=r.value.filter(I=>!I.isFolder).map(I=>I.element_id);if(p.length===0){w.value="本页全选";return}const u=p.every(I=>o.value[_.value].some(L=>L.element_id===I));w.value=u?"取消本页选中":"本页全选"},Q=()=>{var u;if(r.value.filter(I=>!I.isFolder).map(I=>I.element_id).length!==0)if(w.value==="本页全选"){const I=D.value[_.value],L=I-o.value[_.value].length;if(L<=0){te.warning(`${((u=T.find($=>$.value===_.value))==null?void 0:u.label)||"该类型"}最多可选${I}个`);return}const X=r.value.filter($=>!$.isFolder&&!o.value[_.value].some(ae=>ae.element_id===$.element_id));if(L<X.length){const $=[...X].sort(()=>Math.random()-.5);o.value[_.value]=[...o.value[_.value],...$.slice(0,L)]}else o.value[_.value]=[...o.value[_.value],...X];w.value="取消本页选中",n.value&&n.value.setSelectedTemplates(o.value[_.value])}else w.value==="取消本页选中"&&(o.value[_.value]=o.value[_.value].filter(I=>!r.value.some(L=>L.element_id===I.element_id)),w.value="本页全选",n.value&&n.value.setSelectedTemplates(o.value[_.value]))},O=i(1),H=i(1),be=async()=>{O.value*m.page_size<b.value&&(x.value=!0,O.value+=1,await M(!0,"folder",O.value)),H.value*m.page_size<J.value&&(x.value=!0,H.value+=1,await M(!0,"video",H.value))};return me(()=>v.visible,async p=>{if(p){_.value="RAW";const u=Date.now();(q.value===0||u-q.value>5*60*1e3)&&(O.value=1,H.value=1,await M(),q.value=u),v.selectedData&&typeof v.selectedData=="object"&&(o.value=JSON.parse(JSON.stringify(v.selectedData)),Xe(()=>{n.value&&n.value.setSelectedTemplates(o.value[_.value])}))}}),me(()=>_.value,p=>{n.value&&o.value[p]&&n.value.setSelectedTemplates(o.value[p]),z()}),(p,u)=>{const I=we,L=Pe,X=Ce,$=Ae,ae=$e,ee=nt,ce=Ze;return s(),le(ee,{modelValue:R.value,"onUpdate:modelValue":u[3]||(u[3]=U=>R.value=U),title:"选择视频",width:"85%",class:"template-library-dialog",top:"5vh",onClose:k},{footer:d(()=>[l("span",Nl,[u[8]||(u[8]=l("label",{class:"select-label"},"添加为:",-1)),e(L,{modelValue:_.value,"onUpdate:modelValue":u[2]||(u[2]=U=>_.value=U),placeholder:"选择原料用途",class:"select-box"},{default:d(()=>[(s(),c(se,null,oe(T,U=>e(I,{key:U.value,label:U.label,value:U.value,disabled:v.disabledVideoTypes.includes(U.value),title:P(U.value)},null,8,["label","value","disabled","title"])),64))]),_:1},8,["modelValue"]),e(ae,{onClick:Q},{default:d(()=>[ue(j(w.value),1)]),_:1}),e(ae,{class:"save-btn",type:"primary",onClick:f},{default:d(()=>u[7]||(u[7]=[ue("确定")])),_:1,__:[7]})])]),default:d(()=>[l("div",Ol,[e(ot,{ref_key:"selectedItemsRef",ref:y,title:"已选视频","selected-list":o.value,"empty-text":"暂无选中视频",maxItemsByType:D.value,onRemove:G,onClear:E},null,8,["selected-list","maxItemsByType"]),l("div",Tl,[l("div",El,[l("div",Vl,[u[4]||(u[4]=l("label",{class:"select-label"},"筛选原料用途:",-1)),e(L,{modelValue:A.value,"onUpdate:modelValue":u[0]||(u[0]=U=>A.value=U),placeholder:"选择原料用途",class:"select-box",onChange:pe,clearable:""},{default:d(()=>[(s(),c(se,null,oe(T,U=>e(I,{key:U.value,label:U.label,value:U.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),e($,{class:"custom-search-input",modelValue:ve.value,"onUpdate:modelValue":u[1]||(u[1]=U=>ve.value=U),placeholder:"搜索关键字...",clearable:"",size:"large",onClear:ge,onKeyup:Ee(ge,["enter"])},{prefix:d(()=>[e(X,null,{default:d(()=>[e(F(Qe))]),_:1})]),_:1},8,["modelValue"])]),e(et,{path:ne.value,onPathClick:de},null,8,["path"]),Je((s(),c("div",xl,[e(dl,{ref_key:"libraryRef",ref:n,visible:R.value,"selected-data":o.value,"data-list":r.value,maxCount:D.value[_.value],onSelectionChange:W,onFolderClick:g,onScroll:be},null,8,["visible","selected-data","data-list","maxCount"])])),[[ce,B.value]]),x.value?(s(),c("div",Dl,[e(X,{class:"loading-icon"},{default:d(()=>[e(F(Te))]),_:1}),u[5]||(u[5]=l("span",{class:"loading-text"},"加载更多...",-1))])):!B.value&&!x.value&&r.value.length>0&&r.value.length==J.value+b.value?(s(),c("div",$l,u[6]||(u[6]=[l("span",{class:"no-more-text"},"已加载全部数据",-1)]))):Z("",!0)])])]),_:1},8,["modelValue"])}}},wl=Se(Pl,[["__scopeId","data-v-b56627bb"]]),Al={class:"template-library-container"},Bl={class:"resource-layout"},Ul={class:"right-panel"},Ll=["onClick"],Fl=["title"],Gl={key:1,class:"template-content"},Ml=["src","alt"],zl=["title"],Kl={key:0,class:"empty-state"},Wl={__name:"LibraryImageList",props:{visible:{type:Boolean,default:!1},dataList:{type:Array,default:()=>[]},selectedData:{type:Array,default:()=>[]},maxCount:{type:Number,default:20}},emits:["selection-change","folder-click","scroll"],setup(K,{expose:N,emit:a}){const v=K,y=a,n=i([]),o=i([]),D=ke(()=>v.dataList||[]),w=P=>n.value.length>=v.maxCount&&!n.value.some(G=>G.element_id===P.element_id),T=()=>{n.value=[],o.value=[]},x=()=>{n.value=o.value.map(P=>{const G=v.dataList.find(g=>g.element_id===P);return G||n.value.find(g=>g.element_id===P)}).filter(P=>P&&P.element_id)},A=P=>{P!=null&&P.length?(n.value=P,o.value=P.map(G=>G.element_id)):(n.value=[],o.value=[])},_=P=>{const G=P.map(g=>g.element_id);o.value=Array.from(new Set([...o.value,...G])).filter(g=>v.dataList.some(f=>f.element_id===g)?G.includes(g):!0),x(),y("selection-change",n.value)},B=(P,G)=>{let g=null;return function(...f){g&&clearTimeout(g),g=setTimeout(()=>{P.apply(this,f)},G)}},q=i(!1),R=B(P=>{const{scrollTop:G,scrollHeight:g,clientHeight:f}=P.target;Math.abs(g-G-f)<=1&&!q.value&&(q.value=!0,y("scroll"),setTimeout(()=>{q.value=!1},1e3))},200),W=P=>{y("folder-click",P)};return me(()=>v.selectedData,P=>{P!=null&&P.length&&(o.value=P.map(G=>G.element_id),x())},{immediate:!0}),me(()=>v.dataList,()=>{x()}),N({setSelectedTemplates:A,clearSelection:T}),(P,G)=>{const g=Ce,f=at,E=st,k=Ye;return s(),c("div",Al,[l("div",Bl,[l("div",Ul,[l("div",{class:"materials-display",onScroll:G[1]||(G[1]=(...r)=>F(R)&&F(R)(...r))},[e(E,{modelValue:n.value,"onUpdate:modelValue":G[0]||(G[0]=r=>n.value=r),onChange:_,class:"template-grid"},{default:d(()=>[(s(!0),c(se,null,oe(D.value,(r,m)=>(s(),c("div",{key:m,class:"template-item"},[r.element_type==="FOLDER"?(s(),c("div",{key:0,class:"template-content folder-content",onClick:b=>W(r)},[e(g,{size:60},{default:d(()=>[e(F(He))]),_:1}),l("div",{class:"template-name",title:r.element_name||"未命名文件夹"},j(r.element_name||"未命名文件夹"),9,Fl)],8,Ll)):(s(),c("div",Gl,[(s(),c("img",{src:r.element_url,key:r.element_id,class:"preview",alt:r.element_name||"未命名图片"},null,8,Ml)),l("div",{class:"template-name",title:r.element_name||"未命名图片"},j(r.element_name||"未命名图片"),9,zl),e(f,{label:r,class:"template-checkbox",disabled:w(r),title:w(r)?`已达到最大选择数量 ${v.maxCount}`:""},null,8,["label","disabled","title"])]))]))),128))]),_:1},8,["modelValue"]),D.value.length===0?(s(),c("div",Kl,[e(k,{description:"暂无视频"})])):Z("",!0)],32)])])])}}},jl=Se(Wl,[["__scopeId","data-v-77343178"]]),ql={class:"dialog-content"},Hl={class:"image-list-area"},Jl={class:"search-box"},Ql={class:"search-btn"},Xl={class:"loading-container","element-loading-text":"加载中..."},Yl={key:0,class:"bottom-loading"},Zl={key:1,class:"no-more"},ea={class:"dialog-footer"},ta={__name:"SelectImageDialog",props:{visible:{type:Boolean,default:!1},selectedData:{type:Array,default:()=>[]},maxCount:{type:Number,default:1},disabledImageTypes:{type:Array,default:()=>[]}},emits:["update:visible","confirm"],setup(K,{emit:N}){const a=N,v=K,y=i(null),n=i(null),o=i({RAW:[],FOREGROUND:[],BACKGROUND:[]}),D=ke(()=>({RAW:20,FOREGROUND:1,BACKGROUND:1}));Ve(()=>{});const w=i("本页全选"),T=[{label:"剪辑素材",value:"RAW"},{label:"前景",value:"FOREGROUND"},{label:"背景",value:"BACKGROUND"}],x=i(!1),A=i(""),_=i("RAW"),B=i(!1),q=i(0),R=ke({get:()=>v.visible,set:p=>a("update:visible",p)}),W=p=>{o.value[_.value]=p,y.value&&y.value.isCategoryCollapsed(_.value)&&y.value.toggleCategory(_.value)},P=p=>v.disabledImageTypes.includes(p)?`已有视频类型的${p==="FOREGROUND"?"前景":"背景"}`:"",G=(p,u)=>{o.value[u]=o.value[u].filter(I=>I.element_id!==p.element_id),u==_.value&&n.value&&n.value.setSelectedTemplates(o.value[u])},g=async p=>{const u=m.path_name==="/"?"/"+p.element_name:`${m.path_name}/${p.element_name}`;m.path_name=u,ne.value=u,O.value=1,H.value=1,await M(),z()},f=()=>{a("confirm",o.value),R.value=!1},E=()=>{o.value={RAW:[],FOREGROUND:[],BACKGROUND:[]},n.value&&n.value.clearSelection()},k=()=>{},r=i([]),m=Re({page:1,page_size:20,element_type:"IMAGE",path_name:"/"}),b=i(0),J=i(0),M=async(p=!1,u,I)=>{var L,X;try{if(p){if(u==="folder"){const ee=await fe({...m,page:I,element_type:"FOLDER"});if(ee.code===0){const ce=(ee.data.elements||[]).map(U=>({...U,isFolder:!0}));r.value=[...r.value,...ce]}else te.error(ee.message||"获取数据失败")}else if(u==="image"){const ee=await fe({...m,page:I,element_type:"IMAGE"});if(ee.code===0){const ce=ee.data.elements||[];r.value=[...r.value,...ce]}else te.error(ee.message||"获取数据失败")}x.value=!1;return}B.value=!0;const $=await fe({...m,element_type:"FOLDER"}),ae=await fe({...m,element_type:"IMAGE"});if($.code===0&&ae.code===0){const ee=($.data.elements||[]).map(U=>({...U,isFolder:!0})),ce=ae.data.elements||[];r.value=[...ee,...ce],b.value=((L=$.data.page_info)==null?void 0:L.total_number)||0,J.value=((X=ae.data.page_info)==null?void 0:X.total_number)||0}else te.error($.message||ae.message||"获取数据失败")}catch($){te.error($||"获取数据失败")}finally{B.value=!1}},pe=async p=>{p?m.use_as=p:delete m.use_as,O.value=1,H.value=1,await M()},ve=i(""),ge=async()=>{if(O.value=1,H.value=1,ve.value==""&&m.element_name){delete m.element_name,await M();return}m.element_name=ve.value,await M()},ne=i("/"),de=async p=>{O.value=1,H.value=1,ne.value=p,m.path_name=p,await M(),z()},z=()=>{const p=r.value.filter(I=>!I.isFolder).map(I=>I.element_id);if(p.length===0){w.value="本页全选";return}const u=p.every(I=>o.value[_.value].some(L=>L.element_id===I));w.value=u?"取消本页选中":"本页全选"},Q=()=>{var u;if(r.value.filter(I=>!I.isFolder).map(I=>I.element_id).length!==0)if(w.value==="本页全选"){const I=D.value[_.value],L=I-o.value[_.value].length;if(L<=0){te.warning(`${((u=T.find($=>$.value===_.value))==null?void 0:u.label)||"该类型"}最多可选${I}个`);return}const X=r.value.filter($=>!$.isFolder&&!o.value[_.value].some(ae=>ae.element_id===$.element_id));if(L<X.length){const $=[...X].sort(()=>Math.random()-.5);o.value[_.value]=[...o.value[_.value],...$.slice(0,L)]}else o.value[_.value]=[...o.value[_.value],...X];w.value="取消本页选中",n.value&&n.value.setSelectedTemplates(o.value[_.value])}else w.value==="取消本页选中"&&(o.value[_.value]=o.value[_.value].filter(I=>!r.value.some(L=>L.element_id===I.element_id)),w.value="本页全选",n.value&&n.value.setSelectedTemplates(o.value[_.value]))},O=i(1),H=i(1),be=async()=>{O.value*m.page_size<b.value&&(x.value=!0,O.value+=1,await M(!0,"folder",O.value)),H.value*m.page_size<J.value&&(x.value=!0,H.value+=1,await M(!0,"image",H.value))};return me(()=>v.visible,async p=>{if(p){_.value="RAW";const u=Date.now();(q.value===0||u-q.value>5*60*1e3)&&(O.value=1,H.value=1,await M(),q.value=u),v.selectedData&&typeof v.selectedData=="object"&&(o.value=JSON.parse(JSON.stringify(v.selectedData)),Xe(()=>{n.value&&n.value.setSelectedTemplates(o.value[_.value])}))}}),me(()=>_.value,p=>{n.value&&o.value[p]&&n.value.setSelectedTemplates(o.value[p]),z()}),(p,u)=>{const I=we,L=Pe,X=Ce,$=Ae,ae=$e,ee=nt,ce=Ze;return s(),le(ee,{modelValue:R.value,"onUpdate:modelValue":u[3]||(u[3]=U=>R.value=U),title:"选择图片",width:"85%",class:"template-library-dialog",top:"5vh",onClose:k},{footer:d(()=>[l("span",ea,[u[8]||(u[8]=l("label",{class:"select-label"},"添加为:",-1)),e(L,{modelValue:_.value,"onUpdate:modelValue":u[2]||(u[2]=U=>_.value=U),placeholder:"选择原料用途",class:"select-box"},{default:d(()=>[(s(),c(se,null,oe(T,U=>e(I,{key:U.value,label:U.label,value:U.value,disabled:v.disabledImageTypes.includes(U.value),title:P(U.value)},null,8,["label","value","disabled","title"])),64))]),_:1},8,["modelValue"]),e(ae,{onClick:Q},{default:d(()=>[ue(j(w.value),1)]),_:1}),e(ae,{class:"save-btn",type:"primary",onClick:f},{default:d(()=>u[7]||(u[7]=[ue("确定")])),_:1,__:[7]})])]),default:d(()=>[l("div",ql,[e(ot,{ref_key:"selectedItemsRef",ref:y,title:"已选图片","selected-list":o.value,"empty-text":"暂无选中图片",maxItemsByType:D.value,onRemove:G,onClear:E},null,8,["selected-list","maxItemsByType"]),l("div",Hl,[l("div",Jl,[l("div",Ql,[u[4]||(u[4]=l("label",{class:"select-label"},"筛选原料用途:",-1)),e(L,{modelValue:A.value,"onUpdate:modelValue":u[0]||(u[0]=U=>A.value=U),placeholder:"选择原料用途",class:"select-box",onChange:pe,clearable:""},{default:d(()=>[(s(),c(se,null,oe(T,U=>e(I,{key:U.value,label:U.label,value:U.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),e($,{class:"custom-search-input",modelValue:ve.value,"onUpdate:modelValue":u[1]||(u[1]=U=>ve.value=U),placeholder:"搜索关键字...",clearable:"",size:"large",onClear:ge,onKeyup:Ee(ge,["enter"])},{prefix:d(()=>[e(X,null,{default:d(()=>[e(F(Qe))]),_:1})]),_:1},8,["modelValue"])]),e(et,{path:ne.value,onPathClick:de},null,8,["path"]),Je((s(),c("div",Xl,[e(jl,{ref_key:"libraryRef",ref:n,visible:R.value,"selected-data":o.value,"data-list":r.value,maxCount:D.value[_.value],onSelectionChange:W,onFolderClick:g,onScroll:be},null,8,["visible","selected-data","data-list","maxCount"])])),[[ce,B.value]]),x.value?(s(),c("div",Yl,[e(X,{class:"loading-icon"},{default:d(()=>[e(F(Te))]),_:1}),u[5]||(u[5]=l("span",{class:"loading-text"},"加载更多...",-1))])):!B.value&&!x.value&&r.value.length>0&&r.value.length==J.value+b.value?(s(),c("div",Zl,u[6]||(u[6]=[l("span",{class:"no-more-text"},"已加载全部数据",-1)]))):Z("",!0)])])]),_:1},8,["modelValue"])}}},la=Se(ta,[["__scopeId","data-v-a35e20e2"]]),aa={class:"template-library-container"},sa={class:"resource-layout"},na={class:"right-panel"},oa=["onClick"],ia=["src"],ua={__name:"LibraryMusicList",props:{visible:{type:Boolean,default:!1},dataList:{type:Array,default:()=>[]},selectedData:{type:Array,default:()=>[]},maxCount:{type:Number,default:20},showSelection:{type:Boolean,default:!0}},emits:["selection-change","folder-click","scroll"],setup(K,{expose:N,emit:a}){const v=K,y=a,n=i([]),o=i([]),D=i(null),w=ke(()=>v.dataList||[]),T=k=>k.element_type==="FOLDER"?!1:!x(k),x=k=>n.value.length>=v.maxCount&&!n.value.some(r=>r.element_id===k.element_id),A=()=>{n.value=[],o.value=[]},_=()=>{const k=[...o.value];n.value=k.map(r=>{const m=v.dataList.find(b=>b.element_id===r);return m||n.value.find(b=>b.element_id===r)}).filter(r=>r&&r.element_id),Xe(()=>{var m;(m=D.value)==null||m.clearSelection(),w.value.filter(b=>k.includes(b.element_id)&&b.element_type!=="FOLDER").forEach(b=>{var J;(J=D.value)==null||J.toggleRowSelection(b,!0)})})},B=i(null),q=k=>{const r=k.target;B.value&&B.value!==r&&B.value.pause(),B.value=r},R=k=>{k!=null&&k.length?(n.value=k,o.value=k.map(r=>r.element_id)):(n.value=[],o.value=[]),_()},W=k=>{var r;if(k.length>0&&n.value.length>v.maxCount){(r=D.value)==null||r.clearSelection(),te.warning(`超过最大选择数量限制(${v.maxCount})个，无法全选`);return}},P=k=>{const r=k.map(m=>m.element_id);o.value=Array.from(new Set([...o.value,...r])).filter(m=>v.dataList.some(b=>b.element_id===m)?r.includes(m):!0),n.value=o.value.map(m=>{const b=v.dataList.find(J=>J.element_id===m);return b||n.value.find(J=>J.element_id===m)}).filter(m=>m&&m.element_id),y("selection-change",n.value)},G=(k,r)=>{let m=null;return function(...b){m&&clearTimeout(m),m=setTimeout(()=>{k.apply(this,b)},r)}},g=i(!1),f=G(k=>{const{scrollTop:r,scrollHeight:m,clientHeight:b}=k.target;Math.abs(m-r-b)<=1&&!g.value&&(g.value=!0,y("scroll"),setTimeout(()=>{g.value=!1},1e3))},200),E=k=>{y("folder-click",k)};return me(()=>v.selectedData,k=>{k!=null&&k.length&&(n.value=k,o.value=k.map(r=>r.element_id),_())},{immediate:!0}),me(()=>v.dataList,()=>{_()}),N({setSelectedTemplates:R,clearSelection:A}),(k,r)=>{const m=Pt,b=Ce,J=wt;return s(),c("div",aa,[l("div",sa,[l("div",na,[l("div",{class:"materials-display",onScroll:r[0]||(r[0]=(...M)=>F(f)&&F(f)(...M))},[e(J,{ref_key:"tableRef",ref:D,data:w.value,style:{width:"100%"},onSelectionChange:P,onSelectAll:W},{default:d(()=>[v.showSelection?(s(),le(m,{key:0,type:"selection",width:"55",selectable:T})):Z("",!0),e(m,{width:"50"},{default:d(({row:M})=>[M.element_type==="FOLDER"?(s(),le(b,{key:0,size:20},{default:d(()=>[e(F(He))]),_:1})):(s(),le(b,{key:1,size:20},{default:d(()=>[e(F(xt))]),_:1}))]),_:1}),e(m,{prop:"element_name",label:"名称","min-width":"200"},{default:d(({row:M})=>[l("div",{class:Ie(["name-cell",{"folder-name":M.element_type==="FOLDER"}]),onClick:pe=>M.element_type==="FOLDER"?E(M):null},j(M.element_name||"未命名"),11,oa)]),_:1}),e(m,{prop:"element_type",label:"类型",width:"100"},{default:d(({row:M})=>[ue(j(M.element_type==="FOLDER"?"文件夹":"音频文件"),1)]),_:1}),e(m,{label:"预览","min-width":"300"},{default:d(({row:M})=>[M.element_type!=="FOLDER"?(s(),c("audio",{key:M.element_id,src:M.element_url,controls:"",preload:"metadata",class:"audio-player",onPlay:q},null,40,ia)):Z("",!0)]),_:1})]),_:1},8,["data"])],32)])])])}}},pt=Se(ua,[["__scopeId","data-v-4bb76be4"]]),ca={class:"dialog-content"},da={class:"music-list-area"},ra={class:"search-box"},ma={class:"loading-container","element-loading-text":"加载中..."},va={key:0,class:"bottom-loading"},_a={key:1,class:"no-more"},pa={class:"dialog-footer"},fa={__name:"SelectMusicDialog",props:{visible:{type:Boolean,default:!1},selectedData:{type:Array,default:()=>[]},maxCount:{type:Number,default:1}},emits:["update:visible","confirm"],setup(K,{emit:N}){const a=N,v=K;Ve(()=>{});const y=i(null),n=i(null),o=i([]),D=i({BGM:[]}),w=ke(()=>({BGM:v.maxCount})),T=Re({page:1,page_size:20,element_type:"MUSIC",path_name:"/"}),x=i("本页全选"),A=[{label:"背景音乐",value:"BGM"}],_=i(!1),B=i("BGM"),q=i(!1),R=i(0),W=ke({get:()=>v.visible,set:Q=>a("update:visible",Q)}),P=Q=>{D.value[B.value]=Q,y.value&&y.value.isCategoryCollapsed(B.value)&&y.value.toggleCategory(B.value)},G=(Q,O)=>{D.value[O]=D.value[O].filter(H=>H.element_id!==Q.element_id),O==B.value&&n.value&&n.value.setSelectedTemplates(D.value[O])},g=async Q=>{const O=T.path_name==="/"?"/"+Q.element_name:`${T.path_name}/${Q.element_name}`;T.path_name=O,pe.value=O,ne.value=1,de.value=1,await b(),ge()},f=()=>{a("confirm",D.value),W.value=!1},E=()=>{D.value={BGM:[]},n.value&&n.value.clearSelection()},k=()=>{},r=i(0),m=i(0),b=async(Q=!1,O,H)=>{var be,p;try{if(Q){if(O==="folder"){const L=await fe({...T,page:H,element_type:"FOLDER"});if(L.code===0){const X=(L.data.elements||[]).map($=>({...$,isFolder:!0}));o.value=[...o.value,...X]}else te.error(L.message||"获取数据失败")}else if(O==="music"){const L=await fe({...T,page:H,element_type:"MUSIC"});if(L.code===0){const X=L.data.elements||[];o.value=[...o.value,...X]}else te.error(L.message||"获取数据失败")}_.value=!1;return}q.value=!0;const u=await fe({...T,element_type:"FOLDER"}),I=await fe({...T,element_type:"MUSIC"});if(u.code===0&&I.code===0){const L=(u.data.elements||[]).map($=>({...$,isFolder:!0})),X=I.data.elements||[];o.value=[...L,...X],r.value=((be=u.data.page_info)==null?void 0:be.total_number)||0,m.value=((p=I.data.page_info)==null?void 0:p.total_number)||0}else te.error(u.message||I.message||"获取数据失败")}catch(u){te.error(u||"获取数据失败")}finally{q.value=!1}},J=i(""),M=async()=>{if(ne.value=1,de.value=1,J.value==""&&T.element_name){delete T.element_name,await b();return}T.element_name=J.value,await b()},pe=i("/"),ve=async Q=>{ne.value=1,de.value=1,pe.value=Q,T.path_name=Q,await b(),ge()},ge=()=>{const Q=o.value.filter(H=>!H.isFolder).map(H=>H.element_id);if(Q.length===0){x.value="本页全选";return}const O=Q.every(H=>D.value[B.value].some(be=>be.element_id===H));x.value=O?"取消本页选中":"本页全选"},ne=i(1),de=i(1),z=async()=>{ne.value*T.page_size<r.value&&(_.value=!0,ne.value+=1,await b(!0,"folder",ne.value)),de.value*T.page_size<m.value&&(_.value=!0,de.value+=1,await b(!0,"music",de.value))};return me(()=>v.visible,async Q=>{if(Q){const O=Date.now();(R.value===0||O-R.value>5*60*1e3)&&(ne.value=1,de.value=1,await b(),R.value=O),v.selectedData&&typeof v.selectedData=="object"&&(D.value=JSON.parse(JSON.stringify(v.selectedData)),Xe(()=>{n.value&&n.value.setSelectedTemplates(D.value[B.value])}))}}),me(()=>B.value,Q=>{n.value&&D.value[Q]&&n.value.setSelectedTemplates(D.value[Q]),ge()}),(Q,O)=>{const H=Ce,be=Ae,p=we,u=Pe,I=$e,L=nt,X=Ze;return s(),le(L,{modelValue:W.value,"onUpdate:modelValue":O[2]||(O[2]=$=>W.value=$),title:"选择音频",width:"85%",class:"template-library-dialog",top:"5vh",onClose:k},{footer:d(()=>[l("span",pa,[O[6]||(O[6]=l("label",{class:"select-label"},"添加为:",-1)),e(u,{modelValue:B.value,"onUpdate:modelValue":O[1]||(O[1]=$=>B.value=$),placeholder:"选择原料用途",class:"select-box"},{default:d(()=>[(s(),c(se,null,oe(A,$=>e(p,{key:$.value,label:$.label,value:$.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(I,{class:"save-btn",type:"primary",onClick:f},{default:d(()=>O[5]||(O[5]=[ue("确定")])),_:1,__:[5]})])]),default:d(()=>[l("div",ca,[e(ot,{ref_key:"selectedItemsRef",ref:y,title:"已选音频","selected-list":D.value,"empty-text":"暂无选中音频",maxItemsByType:w.value,onRemove:G,onClear:E},null,8,["selected-list","maxItemsByType"]),l("div",da,[l("div",ra,[e(be,{class:"custom-search-input",modelValue:J.value,"onUpdate:modelValue":O[0]||(O[0]=$=>J.value=$),placeholder:"搜索关键字...",clearable:"",size:"large",onClear:M,onKeyup:Ee(M,["enter"])},{prefix:d(()=>[e(H,null,{default:d(()=>[e(F(Qe))]),_:1})]),_:1},8,["modelValue"])]),e(et,{path:pe.value,onPathClick:ve},null,8,["path"]),Je((s(),c("div",ma,[e(pt,{ref_key:"libraryRef",ref:n,visible:W.value,"selected-data":D.value,"data-list":o.value,maxCount:w.value[B.value],onSelectionChange:P,onFolderClick:g,onScroll:z},null,8,["visible","selected-data","data-list","maxCount"])])),[[X,q.value]]),_.value?(s(),c("div",va,[e(H,{class:"loading-icon"},{default:d(()=>[e(F(Te))]),_:1}),O[3]||(O[3]=l("span",{class:"loading-text"},"加载更多...",-1))])):!q.value&&!_.value&&o.value.length>0&&o.value.length==m.value+r.value?(s(),c("div",_a,O[4]||(O[4]=[l("span",{class:"no-more-text"},"已加载全部数据",-1)]))):Z("",!0)])])]),_:1},8,["modelValue"])}}},ga=Se(fa,[["__scopeId","data-v-c5fdc043"]]),ba={class:"create-task-container"},ha={class:"two-column-layout"},ya={class:"left-config-area"},ka={class:"left-content-wrapper"},Ca={class:"cards-container"},Sa={class:"config-card"},Ia={class:"card-content"},Ra={key:0,style:{"margin-left":"8px","font-size":"12px",color:"#909399"}},Oa={class:"image-upload-wrapper"},Ta={class:"upload-box"},Ea={key:0,class:"selected-name"},Va={key:1,class:"upload-placeholder"},xa={key:0,style:{"margin-left":"8px","font-size":"12px",color:"#909399"}},Da={class:"image-upload-wrapper"},$a={class:"upload-box"},Na={key:0,class:"selected-name"},Pa={key:1,class:"upload-placeholder"},wa={key:0,style:{"margin-left":"8px","font-size":"12px",color:"#909399"}},Aa={class:"image-upload-wrapper"},Ba={class:"upload-box"},Ua={key:0,class:"selected-name"},La={key:1,class:"upload-placeholder"},Fa={key:0,style:{"margin-left":"8px","font-size":"12px",color:"#909399"}},Ga={class:"naming-rule-selector"},Ma={class:"naming-input-container"},za={class:"naming-variables"},Ka={class:"variables-container"},Wa={class:"naming-rule-hint"},ja={class:"card-actions"},qa=["disabled"],Ha={class:"btn-icon"},Ja={class:"btn-text"},Qa={class:"right-preview-area"},Xa={class:"preview-header"},Ya={class:"title-wrapper"},Za={class:"preview-title"},es={class:"search_container"},ts={class:"preview-status"},ls={class:"tag_label"},as={class:"search-box"},ss={key:0,class:"loading-container"},ns={key:1,class:"empty-state"},os={class:"task-header"},is={class:"task-info"},us={class:"task-name"},cs={class:"task-index"},ds={class:"task-content"},rs={class:"task-actions"},ms=["src"],vs={class:"info"},_s=["title"],ps={key:1,class:"padding-status"},fs={class:"padding-content"},gs={key:2,class:"padding-status"},bs={class:"padding-content"},hs={key:3,class:"failed-status"},ys={class:"failed-content"},ks={key:0,class:"save-btn-wrapper"},Cs={key:0,class:"bottom-loading"},Ss={key:1,class:"no-more"},Is={__name:"CreateTask",setup(K){Ve(()=>{b()});const N=i([]),a=Re({productName:"",productSellingPoints:[],productBenefit:[],selectedVideoIds:{},selectedVideoNames:[],selectedImageIds:{},selectedImageNames:[],selectedMusicIds:[],selectedMusicNames:[],customImageName:"{产品名}-{序号}",templateIds:[],taskName:"",count:1,autoSave:!1}),v=i([]),y=i([]),n=i({RAW:[],PRE_VIDEO:[],POST_VIDEO:[],FOREGROUND:[],BACKGROUND:[]}),o=i({RAW:[],FOREGROUND:[],BACKGROUND:[]}),D=i({BGM:[]}),w=i("all"),T=i(""),x={productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}],productSellingPoints:[{required:!0,message:"请输入产品卖点",trigger:"blur"}],customImageName:[{required:!0,message:"请设置命名规则",trigger:"blur"}]},A=i(!1),_=i(!1),B=i(0),q=i(null),R=i(!1),W=i(!1),P=i(!1),G=i(!1),g=i([]),f=[{label:"{产品名}",value:"{产品名}"},{label:"{序号}",value:"{序号}"},{label:"{日期}",value:"{日期}"},{label:"{时间}",value:"{时间}"}],E=[{label:"全部",value:"all"},{label:"等待中",value:"waiting"},{label:"已开始",value:"started"},{label:"已保存",value:"saved"},{label:"自动保存",value:"autosave"}],k=S=>{const t=S.target;t&&(t.value="",t.dispatchEvent(new Event("input")))},r=(S,t)=>{const V={};for(const[Y,re]of Object.entries(t))V[Y]=re.map(he=>he.element_id);const C=Object.values(t).flat();switch(S){case"video":W.value=!1,n.value=t,a.selectedVideoIds=V,a.selectedVideoNames=C.map(Y=>Y.element_name)||[];break;case"image":P.value=!1,o.value=t,a.selectedImageIds=V,a.selectedImageNames=C.map(Y=>Y.element_name)||[];break;case"music":G.value=!1,D.value=t,a.selectedMusicIds=V,a.selectedMusicNames=C.map(Y=>Y.element_name)||[];break}},m=Re({name:"",page:1,page_size:5}),b=async(S=!1)=>{S?_.value=!0:A.value=!0;try{const t=await lt(m);if(t.code===0)S?N.value=[...N.value,...t.data.list]:N.value=t.data.list,B.value=t.data.count,N.value.some(C=>C.status==="waiting"||C.result&&C.result.status==="PROCESSING")&&!J&&setTimeout(()=>{pe()},3e3);else throw new Error(t.message)}catch{te.error("获取产品列表失败")}finally{A.value=!1,_.value=!1}};let J=null;const M=Re({page:1,page_size:5}),pe=async()=>{try{const S=N.value.filter(V=>V.status==="waiting"||V.result&&V.result.status==="PROCESSING").map(V=>V.id);if(S.length===0)return;const t=await lt(M);t.code===0?(N.value=N.value.map(C=>{if(S.includes(C.id)){const Y=t.data.list.find(re=>re.id===C.id);if(Y){if(C.result&&C.result.video_infos&&Y.result&&Y.result.video_infos){const re=JSON.parse(JSON.stringify(Y.result.video_infos));for(let he=0;he<re.length;he++){const ie=C.result.video_infos[he];ie&&ie.video_url&&(re[he].video_url=ie.video_url)}Y.result.video_infos=re}return Y}return C}return C}),N.value.some(C=>C.status==="waiting"||C.result&&C.result.status==="PROCESSING")&&(J=setTimeout(pe,3e3))):te.error(t.message)}catch(S){console.error("轮询失败:",S)}},ve=()=>{m.page=1,b(!1)},ge=S=>{const{scrollTop:t,scrollHeight:V,clientHeight:C}=S.target;V-t<=C+50&&!A.value&&!_.value&&m.page*m.page_size<B.value&&(m.page+=1,b(!0))},ne=S=>{w.value=S,m.page=1,m.status=S,b()},de=()=>{m.page=1,m.name=T.value,b()},z=i([]),Q=()=>{$(),be(["FOREGROUND","BACKGROUND"],a.selectedImageIds,z),W.value=!0},O=i([]),H=()=>{$(),be(["FOREGROUND","BACKGROUND"],a.selectedVideoIds,O),P.value=!0},be=(S,t,V)=>{S.forEach(C=>{var Y;if(((Y=t==null?void 0:t[C])==null?void 0:Y.length)>0)V.value.includes(C)||V.value.push(C);else{const re=V.value.indexOf(C);re>-1&&V.value.splice(re,1)}})},p=()=>{$(),G.value=!0},u=()=>{if(!a.customImageName)return"自定义-{序号}";let S=a.customImageName;const t=a.productName||"产品名",V=new Date,C=`${V.getFullYear()}${(V.getMonth()+1).toString().padStart(2,"0")}${V.getDate().toString().padStart(2,"0")}`,Y=`${V.getHours().toString().padStart(2,"0")}${V.getMinutes().toString().padStart(2,"0")}`;return S=S.replace(/{产品名}/g,t).replace(/{序号}/g,"001").replace(/{日期}/g,C).replace(/{时间}/g,Y),S},I=S=>{a.customImageName+=S},L=i(null),X=S=>{const t=S.target;L.value&&L.value!==t&&L.value.pause(),L.value=t},$=()=>{document.querySelectorAll("video").forEach(t=>{t.paused||t.pause()})},ae=async()=>{R.value||q.value.validate(async S=>{var V,C,Y,re,he,ie,Be,Oe,Ue,Le,Fe,Ge,Me,ze,Ke,h,ye;if(!S){te.error("请完善表单信息");return}if((!((V=a.selectedVideoIds)!=null&&V.RAW)||a.selectedVideoIds.RAW.length===0)&&(!((C=a.selectedImageIds)!=null&&C.RAW)||a.selectedImageIds.RAW.length===0)){te.error("请至少选择一个视频剪辑素材或图片剪辑素材"),R.value=!1;return}R.value=!0;const t={product_info:{product_name:a.productName,product_selling_points:a.productSellingPoints,benefit_points:a.productBenefit},count:a.count,video_element_ids:((Y=a.selectedVideoIds)==null?void 0:Y.RAW)||[],image_element_ids:((re=a.selectedImageIds)==null?void 0:re.RAW)||[],optional_elements:{pre_video_element_ids:((he=a.selectedVideoIds)==null?void 0:he.PRE_VIDEO)||[],post_video_element_ids:((ie=a.selectedVideoIds)==null?void 0:ie.POST_VIDEO)||[],foreground_element_id:((Oe=(Be=a.selectedVideoIds)==null?void 0:Be.FOREGROUND)==null?void 0:Oe[0])||((Le=(Ue=a.selectedImageIds)==null?void 0:Ue.FOREGROUND)==null?void 0:Le[0])||null,background_element_id:((Ge=(Fe=a.selectedVideoIds)==null?void 0:Fe.BACKGROUND)==null?void 0:Ge[0])||((ze=(Me=a.selectedImageIds)==null?void 0:Me.BACKGROUND)==null?void 0:ze[0])||null},audio_option:{bgm_element_id:((Ke=a.selectedMusicIds)==null?void 0:Ke.BGM)||[]},auto_save:a.autoSave,task_name:a.customImageName};try{const _e=await Sl(t);if(_e.code===0)te.success("任务创建成功"),setTimeout(async()=>{try{const xe={...m,page:1,page_size:10},tt=await lt(xe);if(tt.code===0){const We=tt.data.list.filter(De=>!N.value.some(gt=>gt.id===De.id));We.length>0&&(N.value=[...We,...N.value],B.value=B.value+We.length),We.some(De=>De.status==="waiting"||De.result&&De.result.status==="PROCESSING")&&setTimeout(()=>{pe()},3e3)}else te.error(tt.message)}catch(xe){console.error("获取新任务失败:",xe)}},1e3);else throw new Error(_e.message)}catch(_e){console.error("创建任务失败:",_e),te.error("创建任务失败: "+(((ye=(h=_e.response)==null?void 0:h.data)==null?void 0:ye.error)||_e.message))}finally{R.value=!1}})},ee=S=>g.value.filter(V=>S.result.video_infos.some(C=>C.video_id===V.video_id)).length>0,ce=async S=>{const t=g.value.filter(V=>S.result.video_infos.some(C=>C.video_id===V.video_id)).map(V=>S.result.video_infos.find(C=>C.video_id===V.video_id));try{const V=await Il({task_id:S.task_id,video_ids:t.map(C=>C.video_id)});if(V.code===0)te.success("保存成功"),N.value=N.value.map(C=>C.task_id===S.task_id?{...C,status:"saved"}:C);else throw new Error(V.message)}catch(V){te.error("保存失败: "+V.message)}},U=()=>{q.value.resetFields(),n.value={RAW:[],PRE_VIDEO:[],POST_VIDEO:[],FOREGROUND:[],BACKGROUND:[]},o.value={RAW:[],FOREGROUND:[],BACKGROUND:[]},D.value={BGM:[]},a.selectedVideoIds={},a.selectedVideoNames=[],a.selectedImageIds={},a.selectedImageNames=[],a.selectedMusicIds=[],a.selectedMusicNames=[]};Dt(()=>{J&&(clearTimeout(J),J=null)});const ft=async()=>{if(a.productName)try{const S=await Rl({product_name:a.productName});if(S.code===0&&S.data){const t=S.data.product_selling_points||[],V=S.data.benefit_points||[];v.value=[...new Set([...a.productSellingPoints,...t])],y.value=[...new Set([...a.productBenefit,...V])]}}catch(S){console.error("获取产品信息失败:",S)}};return me(()=>a.productName,((S,t=300)=>{let V;return(...C)=>{clearTimeout(V),V=setTimeout(()=>S.apply(this,C),t)}})(S=>{S&&ft()},300)),me(()=>a.productSellingPoints,S=>{S.forEach(t=>{v.value.includes(t)||v.value.push(t)})}),me(()=>a.productBenefit,S=>{S.forEach(t=>{y.value.includes(t)||y.value.push(t)})}),me(()=>a.count,S=>{for(const[t,V]of Object.entries(a.selectedVideoIds))if((t=="PRE_VIDEO"||t=="POST_VIDEO")&&V.length>S){const C=[...V].sort(()=>Math.random()-.5);a.selectedVideoIds[t]=C.slice(0,S),n.value[t]&&(n.value[t]=n.value[t].filter(Y=>a.selectedVideoIds[t].includes(Y.element_id))),a.selectedVideoNames=Object.values(n.value).flat().map(Y=>Y.element_name)}}),(S,t)=>{const V=Ae,C=At,Y=we,re=Pe,he=Bt,ie=Ce,Be=Ft,Oe=Ut,Ue=Lt,Le=it("Search"),Fe=Ye,Ge=at,Me=st,ze=it("Warning"),Ke=$e;return s(),c("div",ba,[l("div",ha,[l("div",ya,[l("div",ka,[l("div",Ca,[l("div",Sa,[t[24]||(t[24]=l("div",{class:"card-header"},[l("span",{class:"card-title"},"参数配置")],-1)),l("div",Ia,[e(Ue,{model:a,rules:x,ref_key:"formRef",ref:q,"label-position":"top","require-asterisk-position":"right"},{default:d(()=>[e(C,{label:"产品名称",prop:"productName",required:""},{default:d(()=>[e(V,{modelValue:a.productName,"onUpdate:modelValue":t[0]||(t[0]=h=>a.productName=h),placeholder:"请输入产品名称",clearable:""},null,8,["modelValue"])]),_:1}),e(C,{label:"产品卖点",prop:"productSellingPoints",required:""},{default:d(()=>[e(re,{modelValue:a.productSellingPoints,"onUpdate:modelValue":t[1]||(t[1]=h=>a.productSellingPoints=h),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入产品卖点",onKeyup:Ee(k,["enter"])},{default:d(()=>[(s(!0),c(se,null,oe(v.value,(h,ye)=>(s(),le(Y,{key:ye,label:h,value:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"产品利益点",prop:"productBenefit"},{default:d(()=>[e(re,{modelValue:a.productBenefit,"onUpdate:modelValue":t[2]||(t[2]=h=>a.productBenefit=h),multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入产品利益点",onKeyup:Ee(k,["enter"])},{default:d(()=>[(s(!0),c(se,null,oe(y.value,(h,ye)=>(s(),le(Y,{key:ye,label:h,value:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"生成条数",prop:"count",required:""},{default:d(()=>[e(he,{modelValue:a.count,"onUpdate:modelValue":t[3]||(t[3]=h=>a.count=h),min:1,max:5},null,8,["modelValue"])]),_:1}),e(C,{label:"视频原料",prop:"selectedVideoIds"},{label:d(()=>[t[15]||(t[15]=l("span",null,"视频原料",-1)),a.selectedVideoNames.length?(s(),c("span",Ra," (已选择 "+j(a.selectedVideoNames.length)+" 个视频) ",1)):Z("",!0)]),default:d(()=>[l("div",Oa,[l("div",{class:"watermark-uploader",onClick:Q},[l("div",Ta,[a.selectedVideoNames.length?(s(),c("span",Ea,j(a.selectedVideoNames.join(", ")),1)):(s(),c("div",Va,[e(ie,{class:"upload-icon"},{default:d(()=>[e(F(je))]),_:1}),t[16]||(t[16]=l("span",null,"选择视频",-1))]))])])])]),_:1}),e(C,{label:"图片原料",prop:"selectedImageIds"},{label:d(()=>[t[17]||(t[17]=l("span",null,"图片原料",-1)),a.selectedImageNames.length?(s(),c("span",xa," (已选择 "+j(a.selectedImageNames.length)+" 个图片) ",1)):Z("",!0)]),default:d(()=>[l("div",Da,[l("div",{class:"watermark-uploader",onClick:H},[l("div",$a,[a.selectedImageNames.length?(s(),c("span",Na,j(a.selectedImageNames.join(", ")),1)):(s(),c("div",Pa,[e(ie,{class:"upload-icon"},{default:d(()=>[e(F(je))]),_:1}),t[18]||(t[18]=l("span",null,"选择图片",-1))]))])])])]),_:1}),e(C,{label:"音频原料",prop:"selectedMusicIds"},{label:d(()=>[t[19]||(t[19]=l("span",null,"音频原料",-1)),a.selectedMusicNames.length?(s(),c("span",wa," (已选择 "+j(a.selectedMusicNames.length)+" 个音频) ",1)):Z("",!0)]),default:d(()=>[l("div",Aa,[l("div",{class:"watermark-uploader",onClick:p},[l("div",Ba,[a.selectedMusicNames.length?(s(),c("span",Ua,j(a.selectedMusicNames.join(", ")),1)):(s(),c("div",La,[e(ie,{class:"upload-icon"},{default:d(()=>[e(F(je))]),_:1}),t[20]||(t[20]=l("span",null,"选择音频",-1))]))])])])]),_:1}),e(C,{label:"自动保存",prop:"autoSave"},{default:d(()=>[e(Be,{modelValue:a.autoSave,"onUpdate:modelValue":t[4]||(t[4]=h=>a.autoSave=h),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(C,{label:"命名规则",prop:"customImageName",required:""},{label:d(()=>[t[21]||(t[21]=l("span",null,"命名规则",-1)),a.autoSave?(s(),c("span",Fa," (自动保存时,命名规则需以{序号}结尾) ")):Z("",!0)]),default:d(()=>[l("div",Ga,[l("div",Ma,[e(V,{modelValue:a.customImageName,"onUpdate:modelValue":t[5]||(t[5]=h=>a.customImageName=h),placeholder:"请输入自定义命名规则",clearable:""},null,8,["modelValue"]),l("div",za,[t[22]||(t[22]=l("span",{class:"variables-title"},"可用变量：",-1)),l("div",Ka,[(s(),c(se,null,oe(f,h=>e(Oe,{key:h.value,size:"small",class:"variable-tag",onClick:ye=>I(h.value)},{default:d(()=>[ue(j(h.label),1)]),_:2},1032,["onClick"])),64))])]),l("div",Wa,[e(Oe,{size:"small",type:"info"},{default:d(()=>[ue("预览: "+j(u()),1)]),_:1})])])])]),_:1})]),_:1},8,["model"]),l("div",ja,[l("button",{class:"create-task-btn",onClick:ae,disabled:R.value},[l("span",Ha,[e(ie,null,{default:d(()=>[e(F(je))]),_:1})]),l("span",Ja,j(R.value?"创建中...":"创建任务"),1)],8,qa),l("button",{class:"reset-btn",onClick:U},t[23]||(t[23]=[l("span",{class:"btn-text"},"重置",-1)]))])])])])])]),l("div",Qa,[l("div",Xa,[l("div",Ya,[l("span",Za,[t[25]||(t[25]=ue("产品列表 ")),e(ie,{title:"点击刷新列表",class:"refresh-icon",onClick:t[6]||(t[6]=h=>ve())},{default:d(()=>[e(F(rt))]),_:1})])]),l("div",es,[l("div",ts,[t[26]||(t[26]=ue(" 状态筛选:")),(s(),c(se,null,oe(E,h=>e(Oe,{class:Ie(["tag_status",{"selected-tag":w.value===h.value}]),type:"info",key:h.value,onClick:ye=>ne(h.value)},{default:d(()=>[l("div",ls,j(h.label),1)]),_:2},1032,["class","onClick"])),64))]),l("div",as,[e(V,{class:"custom-search-input",modelValue:T.value,"onUpdate:modelValue":t[7]||(t[7]=h=>T.value=h),placeholder:"搜索关键字...",clearable:"",size:"large",onClear:de,onKeyup:Ee(de,["enter"])},{prefix:d(()=>[e(ie,null,{default:d(()=>[e(Le)]),_:1})]),_:1},8,["modelValue"])])]),l("div",{class:"task-list-content",onScroll:ge},[A.value&&!_.value?(s(),c("div",ss,[e(ie,{class:"loading-icon"},{default:d(()=>[e(F(Te))]),_:1}),t[27]||(t[27]=l("span",{class:"loading-text"},"数据加载中...",-1))])):N.value.length===0&&!A.value?(s(),c("div",ns,[e(Fe,{description:"暂无数据"})])):(s(),c(se,{key:2},[(s(!0),c(se,null,oe(N.value,(h,ye)=>(s(),c("div",{class:"task-group",key:ye},[l("div",os,[l("div",is,[l("div",us,[l("span",cs,j(ye+1),1),ue(j(h.task_name)+" ",1),h.status=="saved"||h.status=="autosave"?(s(),le(Oe,{key:0,type:"warning",class:"task_status"},{default:d(()=>[ue(j(h.status=="saved"?"已保存":"自动保存"),1)]),_:2},1024)):Z("",!0)])])]),l("div",ds,[l("div",rs,[h.result.status=="SUCCESS"&&h.result.video_infos.length>0?(s(),le(Me,{key:0,modelValue:g.value,"onUpdate:modelValue":t[8]||(t[8]=_e=>g.value=_e),class:"el-checkbox-group"},{default:d(()=>[(s(!0),c(se,null,oe(h.result.video_infos,(_e,xe)=>(s(),le(Ge,{key:xe,label:_e,value:_e.id,class:"image-item"},{default:d(()=>[l("video",{src:_e.video_url,class:"preview",controls:"",preload:"metadata",onPlay:X},null,40,ms),l("div",vs,[l("div",{class:"video-name",title:_e.video_name},j(_e.video_name),9,_s)])]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue"])):h.status=="waiting"?(s(),c("div",ps,[l("div",fs,[e(ie,{class:"padding-icon"},{default:d(()=>[e(F(Te))]),_:1}),t[28]||(t[28]=l("span",{class:"padding-text"},"等待中...",-1))])])):h.result.status=="PROCESSING"?(s(),c("div",gs,[l("div",bs,[e(ie,{class:"padding-icon"},{default:d(()=>[e(F(Te))]),_:1}),t[29]||(t[29]=l("span",{class:"padding-text"},"视频生成中...",-1))])])):h.result.status=="FAILED"||h.status=="failed"?(s(),c("div",hs,[l("div",ys,[e(ie,{class:"failed-icon"},{default:d(()=>[e(ze)]),_:1}),t[30]||(t[30]=l("span",{class:"failed-text"},"视频生成失败",-1))])])):Z("",!0)]),h.result.status=="SUCCESS"&&h.status!=="saved"&&h.status!=="autosave"?(s(),c("div",ks,[e(Ke,{type:"primary",size:"small",class:"save-btn",onClick:_e=>ce(h)},{default:d(()=>[ue(j(ee(h)?"保存选中":"保存全部"),1)]),_:2},1032,["onClick"])])):Z("",!0)])]))),128)),_.value?(s(),c("div",Cs,[e(ie,{class:"loading-icon"},{default:d(()=>[e(F(Te))]),_:1}),t[31]||(t[31]=l("span",{class:"loading-text"},"加载更多...",-1))])):Z("",!0),!_.value&&B.value>0&&N.value.length>=B.value?(s(),c("div",Ss,t[32]||(t[32]=[l("span",{class:"no-more-text"},"已加载全部数据",-1)]))):Z("",!0)],64))],32)])])]),e(wl,{visible:W.value,"onUpdate:visible":t[9]||(t[9]=h=>W.value=h),selectedData:n.value,maxCount:a.count,disabledVideoTypes:z.value,onConfirm:t[10]||(t[10]=h=>r("video",h))},null,8,["visible","selectedData","maxCount","disabledVideoTypes"]),e(la,{visible:P.value,"onUpdate:visible":t[11]||(t[11]=h=>P.value=h),selectedData:o.value,maxCount:a.count,disabledImageTypes:O.value,onConfirm:t[12]||(t[12]=h=>r("image",h))},null,8,["visible","selectedData","maxCount","disabledImageTypes"]),e(ga,{visible:G.value,"onUpdate:visible":t[13]||(t[13]=h=>G.value=h),selectedData:D.value,maxCount:a.count,onConfirm:t[14]||(t[14]=h=>r("music",h))},null,8,["visible","selectedData","maxCount"])])}}},Rs=Se(Is,[["__scopeId","data-v-025b624b"]]),Os={class:"template-library-container"},Ts={class:"resource-layout"},Es={class:"right-panel"},Vs={class:"tab-switch"},xs={class:"search-box"},Ds={key:0,class:"search-btn"},$s={class:"materials-display"},Ns={key:0,class:"template-grid"},Ps=["onClick"],ws=["title"],As={key:1,class:"template-image-container"},Bs=["src"],Us=["src","alt"],Ls={class:"info"},Fs=["title"],Gs={key:1},Ms={key:0,class:"empty-state"},zs={key:0,class:"pagination-container"},Ks={class:"pagination-inner"},Ws={__name:"TemplateLibrary",setup(K){Ve(()=>{W()});const N=i(!1),a=i(""),v=i(""),y=i("VIDEO"),n=i("/"),o=ke(()=>y.value==="VIDEO"?[{label:"剪辑素材",value:"RAW"},{label:"前贴",value:"PRE_VIDEO"},{label:"后贴",value:"POST_VIDEO"},{label:"前景",value:"FOREGROUND"},{label:"背景",value:"BACKGROUND"}]:y.value==="IMAGE"?[{label:"剪辑素材",value:"RAW"},{label:"前景",value:"FOREGROUND"},{label:"背景",value:"BACKGROUND"}]:[]),D=async f=>{n.value=f,R.path_name=f,await W()},w=f=>{A.currentPage=1,R.page=1,W()},T=async f=>{const E=R.path_name==="/"?"/"+f.element_name:`${R.path_name}/${f.element_name}`;R.path_name=E,n.value=E,await W()},x=i([]),A=Re({pageSize:10,currentPage:1,total:0}),_=async f=>{f?R.use_as=f:delete R.use_as,R.page=1,await W()},B=f=>{A.pageSize=f,A.currentPage=1,R.page_size=f,R.page=1,setTimeout(()=>{W()},50)},q=f=>{R.page=f,A.currentPage=f,W()},R=Re({page:1,page_size:10,element_type:"VIDEO",path_name:"/"}),W=async()=>{N.value=!0;try{const f=await fe({...R,element_type:"FOLDER"}),E=await fe({...R,element_type:y.value});if(f.code===0&&E.code===0){const k=(f.data.elements||[]).map(m=>({...m,isFolder:!0})),r=E.data.elements||[];x.value=[...k,...r],A.total=E.data.page_info.total_number}else throw new Error(res.message)}catch{te.error("获取模板列表失败")}finally{N.value=!1}},P=()=>{a.value==""?"element_name"in R&&(delete R.element_name,W()):(R.element_name=a.value,W())},G=i(null),g=f=>{const E=f.target;G.value&&G.value!==E&&G.value.pause(),G.value=E};return(f,E)=>{const k=Mt,r=zt,m=we,b=Pe,J=Ce,M=Ae,pe=et,ve=pt,ge=Ye,ne=Gt,de=Ze;return s(),c("div",Os,[l("div",Ts,[l("div",Es,[l("div",Vs,[e(r,{modelValue:y.value,"onUpdate:modelValue":E[0]||(E[0]=z=>y.value=z),onTabClick:w,type:"card"},{default:d(()=>[e(k,{label:"视频原料",name:"VIDEO"}),e(k,{label:"图片原料",name:"IMAGE"}),e(k,{label:"音频原料",name:"MUSIC"})]),_:1},8,["modelValue"])]),l("div",xs,[y.value!=="MUSIC"?(s(),c("div",Ds,[E[5]||(E[5]=l("label",{class:"select-label"},"筛选原料用途:",-1)),e(b,{modelValue:v.value,"onUpdate:modelValue":E[1]||(E[1]=z=>v.value=z),placeholder:"选择原料用途",class:"select-box",onChange:_,clearable:""},{default:d(()=>[(s(!0),c(se,null,oe(o.value,z=>(s(),le(m,{key:z.value,label:z.label,value:z.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):Z("",!0),e(M,{class:"custom-search-input",modelValue:a.value,"onUpdate:modelValue":E[2]||(E[2]=z=>a.value=z),placeholder:"搜索关键字...",clearable:"",size:"large",onClear:P,onKeyup:Ee(P,["enter"])},{prefix:d(()=>[e(J,null,{default:d(()=>[e(F(Qe))]),_:1})]),_:1},8,["modelValue"])]),e(pe,{path:n.value,onPathClick:D},null,8,["path"]),Je((s(),c("div",$s,[l("div",null,[y.value!=="MUSIC"?(s(),c("div",Ns,[(s(!0),c(se,null,oe(x.value,(z,Q)=>(s(),c("div",{key:Q,class:"template-item"},[z.element_type==="FOLDER"&&y.value!=="MUSIC"?(s(),c("div",{key:0,class:"template-content folder-content",onClick:O=>T(z)},[e(J,{size:60},{default:d(()=>[e(F(He))]),_:1}),l("div",{class:"template-name",title:z.element_name||"未命名文件夹"},j(z.element_name||"未命名文件夹"),9,ws)],8,Ps)):(s(),c("div",As,[z.element_type==="VIDEO"?(s(),c("video",{key:0,src:z.element_url,class:"preview",controls:"",preload:"metadata",onPlay:g},null,40,Bs)):Z("",!0),z.element_type==="IMAGE"?(s(),c("img",{key:1,src:z.element_url,class:"preview-image",alt:z.element_name||"未命名文件"},null,8,Us)):Z("",!0),l("div",Ls,[l("div",{class:"template-name",title:z.element_name},j(z.element_name||"未命名文件"),9,Fs)])]))]))),128))])):y.value==="MUSIC"?(s(),c("div",Gs,[e(ve,{ref:"libraryRef","data-list":x.value,showSelection:!1,onFolderClick:T},null,8,["data-list"])])):Z("",!0)]),x.value.length===0&&y.value!=="MUSIC"?(s(),c("div",Ms,[e(ge,{description:"暂无模板"})])):Z("",!0)])),[[de,N.value]]),x.value.length>0?(s(),c("div",zs,[l("div",Ks,[e(ne,{"current-page":A.currentPage,"onUpdate:currentPage":E[3]||(E[3]=z=>A.currentPage=z),"page-size":A.pageSize,"onUpdate:pageSize":E[4]||(E[4]=z=>A.pageSize=z),"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",total:A.total,onSizeChange:B,onCurrentChange:q},null,8,["current-page","page-size","total"])])])):Z("",!0)])])])}}},js=Se(Ws,[["__scopeId","data-v-abc3624f"]]),qs={class:"image-ai-generator-container"},Hs={class:"tabs-scroll-container"},Js={class:"custom-tabs"},Qs=["onClick"],Xs={__name:"index",setup(K){const N=i("createTask"),a=v=>{N.value=v};return Ve(()=>{}),(v,y)=>(s(),c("div",qs,[l("div",Hs,[l("div",Js,[(s(!0),c(se,null,oe(F(Zt),(n,o)=>(s(),c("div",{key:o,class:"tab-item-container"},[l("div",{class:Ie(["tab-item",{active:N.value===n.value}]),onClick:D=>a(n.value)},j(n.label),11,Qs)]))),128))])]),(s(),le($t,null,[N.value==="createTask"?(s(),le(Rs,{key:0})):Z("",!0)],1024)),N.value==="templateLibrary"?(s(),le(js,{key:0})):Z("",!0)]))}},vn=Se(Xs,[["__scopeId","data-v-449855db"]]);export{vn as default};
//# sourceMappingURL=index-DyqClmIH.js.map
